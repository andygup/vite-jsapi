import{t as y,r as i}from"./typedArrayUtil-2bcf3cee.js";import{j as o,C as c,A as f,G as w}from"./request-c2b0ab45.js";import{f as S}from"./persistableUrlUtils-7e525def.js";const p={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},v=Object.values(p),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${v.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),C=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function $(e){return!!d.test(e)}function m(e){if(y(e))return null;const r=o(e),t=r.path.match(d)||r.path.match(g);if(!t)return null;const[,s,n,l,u]=t,a=n.indexOf("/");return{title:h(a!==-1?n.slice(a+1):n),serverType:p[l.toLowerCase()],sublayer:u!=null&&u!==""?parseInt(u,10):null,url:{path:s}}}function I(e){const r=o(e).path.match(C);return r?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function h(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function x(e,r){const t=[];if(e){const s=m(e);i(s)&&s.title&&t.push(s.title)}if(r){const s=h(r);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function U(e){if(!e)return!1;const r=".arcgis.com/",t="//services",s="//tiles",n="//features",l=(e=e.toLowerCase()).includes(r),u=e.includes(t)||e.includes(s)||e.includes(n);return l&&u}function A(e,r){return e&&c(f(e,r))}function E(e){let{url:r}=e;if(!r)return{url:r};r=f(r,e.logger);const t=o(r),s=m(t.path);let n;if(i(s))s.sublayer!=null&&e.layer.layerId==null&&(n=s.sublayer),r=s.url.path;else if(e.nonStandardUrlAllowed){const l=I(t.path);i(l)&&(r=l.serviceUrl,n=l.sublayerId)}return{url:c(r),layerId:n}}function O(e,r,t,s,n){S(r,s,"url",n),s.url&&e.layerId!=null&&(s.url=w(s.url,t,e.layerId.toString()))}function R(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes("/services/"),s=r.includes("/mapserver/wmsserver"),n=r.includes("/imageserver/wmsserver"),l=r.includes("/wmsserver");return t&&(s||n||l)}export{R as I,E as L,A as S,O as b,$ as d,U as g,h,m,I as w,x as y};
