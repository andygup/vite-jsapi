import{ii as h,i$ as u,r as f}from"./index-cc043433.js";import{m as d}from"./query-9e3c025a.js";import{A as y}from"./AttachmentInfo-b71c9e2d.js";import"./normalizeUtils-0017e781.js";import"./normalizeUtilsCommon-f6f02a9c.js";import"./pbfQueryUtils-7123e2aa.js";import"./pbf-d1689fd2.js";import"./OptimizedGeometry-af84d2ad.js";import"./OptimizedFeatureSet-5c82fe5a.js";import"./queryZScale-7ff9b58f.js";function l(a){const t=a.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function w(a,t){const e={};for(const r of t){const{parentObjectId:o,parentGlobalId:n,attachmentInfos:c}=r;for(const s of c){const{id:m}=s,p=h(u(`${a.path}/${o}/attachments/${m}`)),i=y.fromJSON(s);i.set({url:p,parentObjectId:o,parentGlobalId:n}),e[o]?e[o].push(i):e[o]=[i]}}return e}function x(a,t,e){let o={query:d({...a.query,f:"json",...l(t)})};return e&&(o={...e,...o,query:{...e.query,...o.query}}),f(a.path+"/queryAttachments",o).then(n=>n.data.attachmentGroups)}async function z(a,t,e){const{objectIds:r}=t,o=[];for(const n of r)o.push(f(a.path+"/"+n+"/attachments",e));return Promise.all(o).then(n=>r.map((c,s)=>{const m=n[s].data.attachmentInfos;return{parentObjectId:c,attachmentInfos:m}}))}export{x as executeAttachmentQuery,z as fetchAttachments,w as processAttachmentQueryResult};
