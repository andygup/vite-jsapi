import{e as g,n as v}from"./cast-daef7652.js";import{n as w}from"./Evented-d8fc77f0.js";import{y as b}from"./string-3d0ebcd3.js";import"./Error-bd05b442.js";import"./ensureType-fa162cfc.js";const x=new w.EventEmitter,m="esri.layers.mixins.EditBusLayer",F=Symbol(m);function S(d){return d!=null&&typeof d=="object"&&F in d}const U=d=>{var r;let l=class extends d{constructor(...y){super(...y),this[r]=!0,this.when().then(()=>{this.own([x.on("edits",t=>{var n,u,h;const p="layer"in t?t.layer:null,j="layer"in t?(n=t.layer)==null?void 0:n.url:t.serviceUrl,a="layer"in t?(u=t.layer)==null?void 0:u.layerId:t.layerId,s=t.event;if(p===this||j!==this.url)return;if(a!=null&&this.layerId!=null&&a===this.layerId)return void this.emit("edits",b(s));const o=(h=s.editedFeatures)==null?void 0:h.find(({layerId:i})=>i===this.layerId);if(o){const{adds:i,updates:c,deletes:I}=o.editedFeatures,f={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:i?i.map(({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],deletedFeatures:I?I.map(({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],updatedFeatures:c?c.map(({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],editedFeatures:b(s.editedFeatures)};this.emit("edits",f)}})])},()=>{})}};return r=F,l=g([v(m)],l),l};export{U as a,x as d,S as o};
