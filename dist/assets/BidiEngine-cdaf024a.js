const W=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],m=["آ","أ","إ","ا"],cu=["ﻵ","ﻷ","ﻹ","ﻻ"],Au=["ﻶ","ﻸ","ﻺ","ﻼ"],z=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],au=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],Tu=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],Bu=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],hu=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],K=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],Lu=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],Q=["ء","ف"],gu=["غ","ي"],Cu=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Uu=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ru=0,k=1,S=2,d=3,g=4,X=5,nu=6,iu=7,Fu=8,Ru=9,_u=10,Eu=11,ou=12,Du=13,Su=14,wu=15,Nu=16,vu=17,pu=18,Vu=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],w=100,Ou=w+0,Mu=w+1,du=w+2,mu=w+3,Pu=w+4,ju=w+5,ku=w+6,Yu=w+7,e=ru,E=k,T=S,L=d,u=g,O=X,G=nu,t=iu,C=Fu,U=Ru,D=_u,A=Eu,r=ou,yu=Du,Iu=Su,Wu=wu,zu=Nu,Xu=vu,l=pu,Zu=[Ou,e,e,e,e,Mu,du,mu,E,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,Pu,u,u,u,e,u,e,u,e,u,u,u,e,e,u,u,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,u,u,e,e,u,u,e,e,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,e,e,e,ju,t,t,ku,Yu],$u=[[l,l,l,l,l,l,l,l,l,G,O,G,C,O,l,l,l,l,l,l,l,l,l,l,l,l,l,l,O,O,O,G,C,u,u,A,A,A,u,u,u,u,u,D,U,D,U,U,T,T,T,T,T,T,T,T,T,T,U,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,l,l,l,l,l,l,O,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,U,u,A,A,A,A,u,u,u,u,e,u,u,l,u,u,A,A,T,T,u,e,u,u,u,T,e,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,e,e,e,e,e,e,e,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,e,u,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,E,r,E,r,r,E,r,r,E,r,u,u,u,u,u,u,u,u,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,u,u,u,u,u,E,E,E,E,E,u,u,u,u,u,u,u,u,u,u,u],[L,L,L,L,u,u,u,u,t,A,A,t,U,t,u,u,r,r,r,r,r,r,r,r,r,r,r,t,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,L,L,L,L,L,L,L,L,L,L,A,L,L,t,t,t,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,L,u,r,r,r,r,r,r,t,t,r,r,u,r,r,r,r,t,t,T,T,T,T,T,T,T,T,T,T,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,t,t,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,t,u,u,u,u,u,u,u,u,u,u,u,u,u,u,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,r,r,r,r,r,r,r,r,r,E,E,u,u,u,u,E,u,u,u,u,u],[C,C,C,C,C,C,C,C,C,C,C,l,l,l,e,E,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,C,O,yu,Iu,Wu,zu,Xu,U,A,A,A,A,A,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,U,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,C,l,l,l,l,l,u,u,u,u,u,l,l,l,l,l,l,T,e,u,u,T,T,T,T,T,T,D,D,u,u,u,e,T,T,T,T,T,T,T,T,T,T,D,D,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u],[e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,u,e,e,e,e,e,u,u,u,u,u,E,r,E,E,E,E,E,E,E,E,E,E,D,E,E,E,E,E,E,E,E,E,E,E,E,E,u,E,E,E,E,E,u,E,u,E,E,u,E,E,u,E,E,E,E,E,E,E,E,E,E,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,U,u,U,u,u,U,u,u,u,u,u,u,u,u,u,A,u,u,D,D,u,u,u,u,u,A,A,u,u,u,u,u,t,t,t,t,t,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,u,l],[u,u,u,A,A,A,u,u,u,u,u,D,U,D,U,U,T,T,T,T,T,T,T,T,T,T,U,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,u,u,u,u,u,u,u,u,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,u,u,u,e,e,e,e,e,e,u,u,e,e,e,e,e,e,u,u,e,e,e,e,e,e,u,u,e,e,e,u,u,u,A,A,u,u,u,A,A,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u]];class At{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(n,F,o){if(this.sourceToTarget=[],this.targetToSource=[],!n)return"";if(Et(this.sourceToTarget,this.targetToSource,n.length),!this.checkParameters(F,o))return n;F=this.inputFormat,o=this.outputFormat;let s=n;const f=st,B=uu(F.charAt(1)),a=uu(o.charAt(1)),c=F.charAt(0)==="I"?"L":F.charAt(0),h=o.charAt(0)==="I"?"L":o.charAt(0),R=c+B,N=h+a,P=F.charAt(2)+o.charAt(2);f.defInFormat=R,f.defOutFormat=N,f.defSwap=P;const v=Y(n,R,N,P,f);let j=!1;return o.charAt(1)==="R"?j=!0:(o.charAt(1)==="C"||o.charAt(1)==="D")&&(j=this.checkContextual(v)==="rtl"),this.sourceToTarget=_,this.targetToSource=ot(this.sourceToTarget),$=this.targetToSource,F.charAt(3)===o.charAt(3)?s=v:o.charAt(3)==="S"?s=Gu(j,v,!0):s=Ku(v,j,!0),this.sourceToTarget=_,this.targetToSource=$,this.levels=q,s}_inputFormatSetter(n){if(!eu.test(n))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=n}_outputFormatSetter(n){if(!eu.test(n))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=n}checkParameters(n,F){return n?this._inputFormatSetter(n):n=this.inputFormat,F?this._outputFormatSetter(F):F=this.outputFormat,n!==F}checkContextual(n){let F=Z(n);if(F!=="ltr"&&F!=="rtl"){try{F=document.dir.toLowerCase()}catch{}F!=="ltr"&&F!=="rtl"&&(F="ltr")}return F}hasBidiChar(n){return ct.test(n)}}function Y(i,n,F,o,s){const f=qu(i,{inFormat:n,outFormat:F,swap:o},s);if(f.inFormat===f.outFormat)return i;n=f.inFormat,F=f.outFormat,o=f.swap;const B=n.substring(0,1),a=n.substring(1,4),c=F.substring(0,1),h=F.substring(1,4);if(s.inFormat=n,s.outFormat=F,s.swap=o,B==="L"&&F==="VLTR"){if(a==="LTR")return s.dir=M,p(i,s);if(a==="RTL")return s.dir=y,p(i,s)}if(B==="V"&&c==="V")return s.dir=a==="RTL"?y:M,H(i,s);if(B==="L"&&F==="VRTL")return a==="LTR"?(s.dir=M,i=p(i,s)):(s.dir=y,i=p(i,s)),H(i);if(n==="VLTR"&&F==="LLTR")return s.dir=M,p(i,s);if(B==="V"&&c==="L"&&a!==h)return i=H(i),a==="RTL"?Y(i,"LLTR","VLTR",o,s):Y(i,"LRTL","VRTL",o,s);if(n==="VRTL"&&F==="LRTL")return Y(i,"LRTL","VRTL",o,s);if(B==="L"&&c==="L"){const R=s.swap;return s.swap=R.substr(0,1)+"N",a==="RTL"?(s.dir=y,i=p(i,s),s.swap="N"+R.substr(1,2),s.dir=M,i=p(i,s)):(s.dir=M,i=p(i,s),s.swap="N"+R.substr(1,2),i=Y(i,"VLTR","LRTL",s.swap,s)),i}return i}function qu(i,n,F){if(n.inFormat===void 0&&(n.inFormat=F.defInFormat),n.outFormat===void 0&&(n.outFormat=F.defOutFormat),n.swap===void 0&&(n.swap=F.defSwap),n.inFormat===n.outFormat)return n;const o=n.inFormat.substring(0,1),s=n.outFormat.substring(0,1);let f,B=n.inFormat.substring(1,4),a=n.outFormat.substring(1,4);return B.charAt(0)==="C"&&(f=Z(i),f==="ltr"||f==="rtl"?B=f.toUpperCase():B=n.inFormat.charAt(2)==="L"?"LTR":"RTL",n.inFormat=o+B),a.charAt(0)==="C"&&(f=Z(i),f==="rtl"?a="RTL":f==="ltr"?(f=Ju(i),a=f.toUpperCase()):a=n.outFormat.charAt(2)==="L"?"LTR":"RTL",n.outFormat=s+a),n}function Gu(i,n,F){if(n.length===0)return"";i===void 0&&(i=!0),F===void 0&&(F=!0),n=String(n);const o=n.split("");let s=0,f=1,B=o.length;i||(s=o.length-1,f=-1,B=1);const a=Hu(o,s,f,B,F);let c="";for(let h=0;h<o.length;h++)F&&ut(a,a.length,h)>-1?(lu($,h,!i,-1),_.splice(h,1)):c+=o[h];return c}function Hu(i,n,F,o,s){let f=0;const B=[];let a=0;for(let c=n;c*F<o;c=c+F)if(fu(i[c])||I(i[c])){if(i[c]==="ل"&&tt(i,c+F,F,o)){i[c]=f===0?tu(i[c+F],cu):tu(i[c+F],Au),c+=F,Ft(i,c,F,o),s&&(B[a]=c,a++),f=0;continue}const h=i[c];f===1?i[c]=b(i,c+F,F,o)?it(i[c]):J(i[c],Tu):b(i,c+F,F,o)===!0?i[c]=J(i[c],hu):i[c]=J(i[c],au),I(h)||(f=1),nt(h)===!0&&(f=0)}else f=0;return B}function Z(i){const n=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(i);return n?n[0]<="z"?"ltr":"rtl":""}function Ju(i){const n=i.split("");return n.reverse(),Z(n.join(""))}function Ku(i,n,F){if(i.length===0)return"";F===void 0&&(F=!0),n===void 0&&(n=!0),i=String(i);let o="";const s=i.split("");for(let f=0;f<i.length;f++){let B=!1;if(s[f]>="ﹰ"&&s[f]<"\uFEFF"){const a=i.charCodeAt(f);s[f]>="ﻵ"&&s[f]<="ﻼ"?(n?(f>0&&F&&s[f-1]===" "?o=o.substring(0,o.length-1)+"ل":(o+="ل",B=!0),o+=m[(a-65269)/2]):(o+=m[(a-65269)/2],o+="ل",f+1<i.length&&F&&s[f+1]===" "?f++:B=!0),B&&(lu($,f,!0,1),_.splice(f,0,_[f]))):o+=Lu[a-65136]}else o+=s[f]}return o}function p(i,n){const F=i.split(""),o=[];return su(F,o,n),bu(F,o,n),x(2,F,o,n),x(1,F,o,n),q=o,F.join("")}function su(i,n,F){const o=i.length,s=F.dir?Uu:Cu;let f=0,B=-1;const a=[],c=[];F.hiLevel=F.dir,F.lastArabic=!1,F.hasUbatAl=!1,F.hasUbatB=!1,F.hasUbatS=!1;for(let h=0;h<o;h++)a[h]=xu(i[h]);for(let h=0;h<o;h++){const R=f,N=et(i,a,c,h,F);c[h]=N,f=s[R][N];const P=f&240;f&=15;const v=s[f][ft];if(n[h]=v,P>0)if(P===16){for(let V=B;V<h;V++)n[V]=1;B=-1}else B=-1;if(s[f][lt])B===-1&&(B=h);else if(B>-1){for(let V=B;V<h;V++)n[V]=v;B=-1}a[h]===X&&(n[h]=0),F.hiLevel|=v}F.hasUbatS&&Qu(a,n,o,F)}function Qu(i,n,F,o){for(let s=0;s<F;s++)if(i[s]===nu){n[s]=o.dir;for(let f=s-1;f>=0&&i[f]===Fu;f--)n[f]=o.dir}}function bu(i,n,F){if(!(F.hiLevel===0||F.swap.substr(0,1)===F.swap.substr(1,2)))for(let o=0;o<i.length;o++)n[o]===1&&(i[o]=rt(i[o]))}function xu(i){const n=i.charCodeAt(0),F=Zu[n>>8];return F<w?F:$u[F-w][n&255]}function H(i,n){const F=i.split("");if(n){const o=[];su(F,o,n),q=o}return F.reverse(),_.reverse(),F.join("")}function ut(i,n,F){for(let o=0;o<n;o++)if(i[o]===F)return o;return-1}function fu(i){for(let n=0;n<Q.length;n++)if(i>=Q[n]&&i<=gu[n])return!0;return!1}function b(i,n,F,o){for(;n*F<o&&I(i[n]);)n+=F;return!!(n*F<o&&fu(i[n]))}function tt(i,n,F,o){for(;n*F<o&&I(i[n]);)n+=F;let s=" ";if(n*F<o)s=i[n];else return!1;for(let f=0;f<m.length;f++)if(m[f]===s)return!0;return!1}function x(i,n,F,o){if(o.hiLevel<i)return;if(i===1&&o.dir===y&&!o.hasUbatB){n.reverse(),_.reverse();return}const s=n.length;let f=0,B,a,c,h,R;for(;f<s;){if(F[f]>=i){for(B=f+1;B<s&&F[B]>=i;)B++;for(a=f,c=B-1;a<c;a++,c--)h=n[a],n[a]=n[c],n[c]=h,R=_[a],_[a]=_[c],_[c]=R;f=B}f++}}function et(i,n,F,o,s){const f=n[o];return{UBAT_L:()=>(s.lastArabic=!1,ru),UBAT_R:()=>(s.lastArabic=!1,k),UBAT_ON:()=>g,UBAT_AN:()=>d,UBAT_EN:()=>s.lastArabic?d:S,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,k),UBAT_WS:()=>g,UBAT_CS:()=>{let a,c;return o<1||o+1>=n.length||(a=F[o-1])!==S&&a!==d||(c=n[o+1])!==S&&c!==d?g:(s.lastArabic&&(c=d),c===a?c:g)},UBAT_ES:()=>(o>0?F[o-1]:X)===S&&o+1<n.length&&n[o+1]===S?S:g,UBAT_ET:()=>{if(o>0&&F[o-1]===S)return S;if(s.lastArabic)return g;let a=o+1;const c=n.length;for(;a<c&&n[a]===Eu;)a++;return a<c&&n[a]===S?S:g},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const a=n.length;let c=o+1;for(;c<a&&n[c]===ou;)c++;if(c<a){const h=i[o].charCodeAt(0),R=h>=1425&&h<=2303||h===64286,N=n[c];if(R&&(N===k||N===iu))return k}}return o<1||n[o-1]===X?g:F[o-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,g),UBAT_LRE:()=>(s.lastArabic=!1,g),UBAT_RLE:()=>(s.lastArabic=!1,g),UBAT_LRO:()=>(s.lastArabic=!1,g),UBAT_RLO:()=>(s.lastArabic=!1,g),UBAT_PDF:()=>(s.lastArabic=!1,g),UBAT_BN:()=>g}[Vu[f]]()}function rt(i){let n,F=0,o=W.length-1;for(;F<=o;)if(n=Math.floor((F+o)/2),i<W[n][0])o=n-1;else if(i>W[n][0])F=n+1;else return W[n][1];return i}function nt(i){for(let n=0;n<K.length;n++)if(K[n]===i)return!0;return!1}function it(i){for(let n=0;n<z.length;n++)if(i===z[n])return Bu[n];return i}function J(i,n){for(let F=0;F<z.length;F++)if(i===z[F])return n[F];return i}function I(i){return i>="ً"&&i<="ٕ"}function uu(i){return i==="L"?"LTR":i==="R"?"RTL":i==="C"?"CLR":i==="D"?"CRL":""}function Ft(i,n,F,o){for(;n*F<o&&I(i[n]);)n+=F;return n*F<o?(i[n]=" ",!0):!1}function tu(i,n){for(let F=0;F<m.length;F++)if(i===m[F])return n[F];return i}function Et(i,n,F){_=[],q=[];for(let o=0;o<F;o++)i[o]=o,n[o]=o,_[o]=o}function ot(i){const n=new Array(i.length);for(let F=0;F<i.length;F++)n[i[F]]=F;return n}function lu(i,n,F,o){for(let s=0;s<i.length;s++)(i[s]>n||!F&&i[s]===n)&&(i[s]+=o)}let _=[],$=[],q=[];const st={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},ft=5,lt=6,M=0,y=1,eu=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ct=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{At as B};
