import{cL as M,gh as O,bF as v,cs as b,ci as N,cr as A,bd as G,fx as z,gi as E,gj as J,dk as B,ga as w,_ as Z}from"./index-65afe59f.js";import{b as q}from"./normalizeUtils-678d9dd1.js";import{d as j,h as p,b as k,P as y,$ as I,H as L,U as V}from"./featureConversionUtils-a232f677.js";import{t as R}from"./OptimizedGeometry-33b2eb0d.js";import{f as P,g as F}from"./projectionSupport-65ca4a6b.js";const C=new M({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),x=Object.freeze({}),$=new R,D=new R,g=new R,l={esriGeometryPoint:y,esriGeometryPolyline:I,esriGeometryPolygon:L,esriGeometryMultipoint:V};function et(t,r,a,e=t.hasZ,n=t.hasM){if(r==null)return null;const o=t.hasZ&&e,s=t.hasM&&n;if(a){const i=p(g,r,t.hasZ,t.hasM,"esriGeometryPoint",a,e,n);return y(i,o,s)}return y(r,o,s)}function rt(t,r,a,e,n,o,s=r,i=a){var S,d,h;const c=r&&s,f=a&&i,u=e!=null?"coords"in e?e:e.geometry:null;if(u==null)return null;if(n){let m=j(D,u,r,a,t,n,s,i);return o&&(m=p(g,m,c,f,t,o)),((S=l[t])==null?void 0:S.call(l,m,c,f))??null}if(o){const m=p(g,u,r,a,t,o,s,i);return((d=l[t])==null?void 0:d.call(l,m,c,f))??null}return k($,u,r,a,s,i),((h=l[t])==null?void 0:h.call(l,$,c,f))??null}async function at(t,r,a){const{outFields:e,orderByFields:n,groupByFieldsForStatistics:o,outStatistics:s}=t;if(e)for(let i=0;i<e.length;i++)e[i]=e[i].trim();if(n)for(let i=0;i<n.length;i++)n[i]=n[i].trim();if(o)for(let i=0;i<o.length;i++)o[i]=o[i].trim();if(s)for(let i=0;i<s.length;i++)s[i].onStatisticField&&(s[i].onStatisticField=s[i].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),H(t,r,a)}async function H(t,r,a){var o;if(!t)return null;let{where:e}=t;if(t.where=e=e&&e.trim(),(!e||/^1 *= *1$/.test(e)||r&&r===e)&&(t.where=null),!t.geometry)return t;let n=await T(t);if(t.distance=0,t.units=null,t.spatialRel==="esriSpatialRelEnvelopeIntersects"){const{spatialReference:s}=t.geometry;n=O(n),n.spatialReference=s}if(n){await P(n.spatialReference,a),n=K(n,a);const s=(await q(v(n)))[0];if(s==null)throw x;const i="quantizationParameters"in t&&((o=t.quantizationParameters)==null?void 0:o.tolerance)||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,c=i&&U(n,a)?{densificationStep:8*i}:void 0,f=s.toJSON(),u=await F(f,f.spatialReference,a,c);if(!u)throw x;u.spatialReference=a,t.geometry=u}return t}function U(t,r){if(!t)return!1;const a=t.spatialReference;return(b(t)||N(t)||A(t))&&!G(a,r)&&!z(a,r)}function K(t,r){const a=t.spatialReference;return U(t,r)&&b(t)?{spatialReference:a,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t}async function T(t){const{distance:r,units:a}=t,e=t.geometry;if(r==null||"vertexAttributes"in e)return e;const n=e.spatialReference,o=a?C.fromJSON(a):E(n),s=n&&(J(n)||B(n))?e:await P(n,w).then(()=>F(e,w));return(await Q())(s.spatialReference,s,r,o)}async function Q(){return(await Z(()=>import("./geometryEngineJSON-e6d6cac0.js"),["assets/geometryEngineJSON-e6d6cac0.js","assets/geometryEngineBase-efc0fa58.js","assets/index-65afe59f.js","assets/index-001d3307.css","assets/geometryEngineJSON-084884a7.js","assets/json-48e3ea08.js"])).geodesicBuffer}function st(t){return t&&_ in t?JSON.parse(JSON.stringify(t,W)):t}const _="_geVersion",W=(t,r)=>t!==_?r:void 0;export{et as G,x as M,rt as P,st as Z,at as v,H as z};
