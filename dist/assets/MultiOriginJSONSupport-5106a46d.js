import{eP as p,eQ as c,cE as _,eR as J,ae as g,ai as S,dB as O,eS as w,eT as x,eU as a,eV as A,aj as E,eW as I}from"./index-37fc1c1b.js";class M{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(p),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new M,t=this._originStores[c.DEFAULTS];t&&t.forEach((r,s)=>{i.set(s,_(r),c.DEFAULTS)});for(let r=c.SERVICE;r<p;r++){const s=this._originStores[r];s&&s.forEach((n,o)=>{(!e||!e.has(o))&&i.set(o,_(n),r)})}return i}get(e,i){const t=i===void 0?this._values:this._originStores[i];return t?t.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,t=c.USER){let r=this._originStores[t];if(r||(r=new Map,this._originStores[t]=r),r.set(e,i),!this._values.has(e)||J(this._propertyOriginMap.get(e))<=t){const s=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,t),s!==i}return!1}delete(e,i=c.USER){const t=this._originStores[i];if(!t)return;const r=t.get(e);if(t.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let s=i-1;s>=0;s--){const n=this._originStores[s];if(n&&n.has(e)){this._values.set(e,n.get(e)),this._propertyOriginMap.set(e,s);break}}}return r}has(e,i){const t=i===void 0?this._values:this._originStores[i];return t?t.has(e):!1}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const t=this._originStores[i],r=t&&t.get(e),s=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),s!==r}originOf(e){return this._propertyOriginMap.get(e)||c.DEFAULTS}forEach(e){this._values.forEach(e)}}const R=u=>{let e=class extends u{constructor(...t){super(...t);const r=J(O(this)),s=r.store,n=new M;r.store=n,w(r,s,n)}read(t,r){x(this,t,r)}getAtOrigin(t,r){const s=f(this),n=a(r);if(typeof t=="string")return s.get(t,n);const o={};return t.forEach(l=>{o[l]=s.get(l,n)}),o}originOf(t){return A(this.originIdOf(t))}originIdOf(t){return f(this).originOf(t)}revert(t,r){const s=f(this),n=a(r),o=O(this);let l;typeof t=="string"?t==="*"?l=s.keys(n):l=[t]:l=t,l.forEach(h=>{o.invalidate(h),s.revert(h,n),o.commit(h)})}};return e=g([S("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function f(u){return O(u).store}let y=class extends R(E){};y=g([S("esri.core.ReadOnlyMultiOriginJSONSupport")],y);const N=u=>{let e=class extends u{constructor(...t){super(...t)}clear(t,r="user"){return d(this).delete(t,a(r))}write(t,r){return t=t||{},I(this,t,r),t}setAtOrigin(t,r,s){O(this).setAtOrigin(t,r,a(s))}removeOrigin(t){const r=d(this),s=a(t),n=r.keys(s);for(const o of n)r.originOf(o)===s&&r.set(o,r.get(o,s),c.USER)}updateOrigin(t,r){const s=d(this),n=a(r),o=this.get(t);for(let l=n+1;l<p;++l)s.delete(t,l);s.set(t,o,n)}toJSON(t){return this.write({},t)}};return e=g([S("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function d(u){return O(u).store}const T=u=>{let e=class extends N(R(u)){constructor(...t){super(...t)}};return e=g([S("esri.core.MultiOriginJSONSupport")],e),e};let v=class extends T(E){};v=g([S("esri.core.MultiOriginJSONSupport")],v);export{T as M,v as a};
