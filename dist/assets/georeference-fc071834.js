import{e as u,y as g,a as G,bB as P,C as A,km as F,kw as D,kx as E,kq as H,ko as L,ky as T,iS as R,ct as h,e7 as M,fj as d,iF as j,cf as W,dW as $,kz as f,dX as J,kA as K,kB as S,dC as U,a3 as X,kC as Y,kD as Z,kE as k,kF as _,kG as N,kh as Q,kH as y,ki as V,kj as tt,kI as nt,ke as et,kf as ot,kg as it,W as at,d4 as rt,gZ as lt,et as st,kJ as ct,kK as ut}from"./index-d29f6b97.js";var x;let c=x=class extends P{constructor(t){super(t),this.origin=A(),this.translation=A(),this.rotation=F(),this.scale=D(1,1,1),this.geographic=!0}get localMatrix(){const t=h();return E(b,L(this.rotation),H(this.rotation)),T(t,b,this.translation,this.scale),t}get localMatrixInverse(){return R(h(),this.localMatrix)}applyLocal(t,n){return M(n,t,this.localMatrix)}applyLocalInverse(t,n){return M(n,t,this.localMatrixInverse)}project(t,n){if(this.geographic){const i=d(n),r=h();j(n,this.origin,r,i),W(r,r,this.localMatrix);const s=$(t.length);return f(s,t,r),J(s,i,0,s,n,0,s.length/3),s}const{localMatrix:e,origin:o}=this,a=K(e,S)?U(t):f($(t.length),t,e);for(let i=0;i<a.length;i+=3)a[i]+=o[0],a[i+1]+=o[1],a[i+2]+=o[2];return a}getOriginPoint(t){const[n,e,o]=this.origin;return new X({x:n,y:e,z:o,spatialReference:t})}equals(t){return t!=null&&this.geographic===t.geographic&&Y(this.origin,t.origin)&&Z(this.localMatrix,t.localMatrix)}clone(){const t={origin:k(this.origin),translation:k(this.translation),rotation:F(this.rotation),scale:k(this.scale),geographic:this.geographic};return new x(t)}};u([g({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"origin",void 0),u([g({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"translation",void 0),u([g({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"rotation",void 0),u([g({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"scale",void 0),u([g({type:Boolean,nonNullable:!0,json:{write:!0}})],c.prototype,"geographic",void 0),u([g()],c.prototype,"localMatrix",null),u([g()],c.prototype,"localMatrixInverse",null),c=x=u([G("esri.geometry.support.MeshTransform")],c);const b=_(),gt=c;function I(t,n){return t.isGeographic||t.isWebMercator&&((n==null?void 0:n.geographic)??!0)}function O(t,n,e){return I(n.spatialReference,e)?ft(t,n,e):ht(t,n,e)}function pt(t,n,e){const{position:o,normal:a,tangent:i}=t;if(n==null)return{position:o,normal:a,tangent:i};const r=n.localMatrix;return O({position:f(new Float64Array(o.length),o,r),normal:a!=null?ct(a,new Float32Array(a.length),r):null,tangent:i!=null?ut(i,new Float32Array(i.length),r):null},n.getOriginPoint(e),{geographic:n.geographic})}function bt(t,n,e){if(e!=null&&e.useTransform){const{position:o,normal:a,tangent:i}=t;return{vertexAttributes:{position:o,normal:a,tangent:i},transform:new gt({origin:[n.x,n.y,n.z??0],geographic:!0})}}return{vertexAttributes:O(t,n,e),transform:null}}function z(t,n,e){return I(n.spatialReference,e)?xt(t,n,e):q(t,n,e)}function zt(t,n,e,o){if(n==null)return z(t,e,o);const a=pt(t,n,e.spatialReference);return e.equals(n.getOriginPoint(e.spatialReference))?q(a,e,o):z(a,e,o)}function ht(t,n,e){const o=new Float64Array(t.position.length),a=t.position,i=n.x,r=n.y,s=n.z||0,{horizontal:p,vertical:m}=v(e?e.unit:null,n.spatialReference);for(let l=0;l<a.length;l+=3)o[l]=a[l]*p+i,o[l+1]=a[l+1]*p+r,o[l+2]=a[l+2]*m+s;return{position:o,normal:t.normal,tangent:t.tangent}}function ft(t,n,e){const o=n.spatialReference,a=B(n,e,w),i=new Float64Array(t.position.length),r=yt(t.position,a,o,i),s=N(C,a);return{position:r,normal:mt(r,i,t.normal,s,o),tangent:kt(r,i,t.tangent,s,o)}}function yt(t,n,e,o){f(o,t,n);const a=new Float64Array(t.length);return Q(o,a,e)}function mt(t,n,e,o,a){if(e==null)return null;const i=new Float32Array(e.length);return y(i,e,o),V(i,t,n,a,i),i}function kt(t,n,e,o,a){if(e==null)return null;const i=new Float32Array(e.length);y(i,e,o,4);for(let r=3;r<i.length;r+=4)i[r]=e[r];return tt(i,t,n,a,i),i}function q(t,n,e){const o=new Float64Array(t.position.length),a=t.position,i=n.x,r=n.y,s=n.z||0,{horizontal:p,vertical:m}=v(e?e.unit:null,n.spatialReference);for(let l=0;l<a.length;l+=3)o[l]=(a[l]-i)/p,o[l+1]=(a[l+1]-r)/p,o[l+2]=(a[l+2]-s)/m;return{position:o,normal:t.normal,tangent:t.tangent}}function xt(t,n,e){const o=n.spatialReference;B(n,e,w);const a=R(Ft,w),i=new Float64Array(t.position.length),r=wt(t.position,o,a,i),s=N(C,a);return{position:r,normal:vt(t.normal,t.position,i,o,s),tangent:At(t.tangent,t.position,i,o,s)}}function B(t,n,e){j(t.spatialReference,[t.x,t.y,t.z||0],e,d(t.spatialReference));const{horizontal:o,vertical:a}=v(n?n.unit:null,t.spatialReference);return nt(e,e,[o,o,a]),e}function wt(t,n,e,o){const a=et(t,n,o),i=new Float64Array(a.length);return f(i,a,e),i}function vt(t,n,e,o,a){if(t==null)return null;const i=ot(t,n,e,o,new Float32Array(t.length));return y(i,i,a),i}function At(t,n,e,o,a){if(t==null)return null;const i=it(t,n,e,o,new Float32Array(t.length));return y(i,i,a,4),i}function v(t,n){if(t==null)return Mt;const e=n.isGeographic?1:at(n),o=n.isGeographic?1:rt(n),a=lt(1,t,"meters");return{horizontal:a*e,vertical:a*o}}const w=h(),Ft=h(),C=st(),Mt={horizontal:1,vertical:1};export{gt as L,zt as b,z as k,I as r,pt as v,bt as x,O as z};
