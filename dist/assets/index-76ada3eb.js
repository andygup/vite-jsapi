import{e as a,l as Fi,n as I,m as S,y as l,u as yl,s as pe,t as Je,a as vl,b as wl,x as tr,A as ni,v as bl,o as Ml,c as Ro,d as xs,f as ir,g as sr}from"./cast-daef7652.js";import{s as nr,x as en}from"./Basemap-8691c5d8.js";import{_ as w}from"./preload-helper-101896b7.js";import{l as wt}from"./Color-2245b966.js";import{j as H}from"./Collection-e2259e32.js";import{n as Il}from"./collectionUtils-09289d8f.js";import{o as Cl}from"./compilerUtils-06ced1a6.js";import{s as R,a as x,b as rr}from"./Error-bd05b442.js";import{y as tn,n as ri,h as ve}from"./string-3d0ebcd3.js";import{m as sn}from"./Loadable-7c89bd10.js";import{n as Tl}from"./loadAll-6dec1444.js";import{f as _t,E as bt,i as Ft,g as Ti,U as An,j as So,b as El,L as xl,A as Lo,a as kl,v as or,p as Al,C as Pl,t as ps}from"./promiseUtils-29120e0a.js";import{T as ar,b as Do,a as gt,t as Oi,r as $l,n as ms}from"./ensureType-fa162cfc.js";import{r as Oo,w as K,o as Fl,R as Vo,E as gs,a as ai,k as Pn,I as No,p as Rl,b as Sl,c as zo,d as Ll,M as Dl}from"./Extent-7f29a1bb.js";import{t as $,r as M,s as le,u as Ol,o as yi,e as ye,f as Vl,h as Mt,p as nn,q as Nl}from"./typedArrayUtil-2bcf3cee.js";import{r as zl}from"./enumeration-e46f3fd4.js";import{r as Bl,n as ql}from"./opacityUtils-94fd2faa.js";import{l as is}from"./CollectionFlattener-c6dafa4a.js";import{n as fs}from"./Evented-d8fc77f0.js";import{U as Ul}from"./request-c2b0ab45.js";import{l as Hl,d as Gl,t as Wl}from"./TablesMixin-c836f156.js";import{g as Nt}from"./Graphic-cf98a91a.js";import{i as Bo}from"./Clonable-f249bc0f.js";import{s as jl}from"./Cyclical-1a93cb12.js";import{a as oi,b as Zl,g as Kl}from"./mathUtils-daf59e84.js";import{i as Yl}from"./geometry-4b789d90.js";import{v as lr}from"./jsonUtils-8bd548d9.js";import{l as v,h as O,a as xe,f as Xe,U as ki,j as $n,w as Tt}from"./reactiveUtils-3c1b281e.js";import{c as ue}from"./screenUtils-7afeb41c.js";import{l as Ql}from"./workers-125ce03d.js";import{e as Ai,A as _s,r as Ri,t as ys}from"./projection-33a6cba9.js";import{p as Xl,j as Jl}from"./TileInfo-2e5a94dc.js";import{i as rn,e as se,M as ne,n as m,v as ss,h as cr,f as Oe,p as ec,k as tc,a as qo,t as ic,w as sc,b as Uo,r as dr,c as Ho,o as hr}from"./widget-8a5f4608.js";import{c as Go,a as vs,d as Wo}from"./HandleOwner-78d35324.js";import{s as De}from"./intl-afc91037.js";import{s as ur}from"./byteSizeEstimations-90c5a50d.js";import{$ as nc}from"./unitUtils-43365914.js";import{m as Fn,L as ns,u as rc,S as jo}from"./number-53937715.js";import{a as oc,s as ks}from"./executeQueryJSON-1890fc00.js";import{c as pr,d as on}from"./RelationshipQuery-c22f6308.js";import{x as ac,h as lc,i as cc}from"./fieldUtils-021fea8a.js";import{u as dc,i as hc,c as Zo,a as uc,I as pc,b as Ko,d as mc,e as gc,f as Si,g as fc,h as _c}from"./PopupTemplate-343851b8.js";import{i as Yo}from"./arcadeOnDemand-87969052.js";import{a as yc}from"./assets-4cb15247.js";import"./LegendOptions-54bbb61a.js";import{j as Ut,x as As,M as vc,N as wc}from"./utils-95450d21.js";import{S as bc}from"./symbols-fce921a6.js";import{a as Mc}from"./jsonUtils-9c255ec7.js";import{m as Ic,x as Ps}from"./Query-e996b56b.js";import"./featureConversionUtils-7c9ea581.js";import{i as Cc,v as Tc}from"./Polyline-c56eca9b.js";import"./normalizeUtils-d322ac85.js";import"./pbf-c27e6a55.js";import"./FeatureSet-9ea00c01.js";import"./TopFeaturesQuery-da583ecc.js";import{l as Ec}from"./locale-30120714.js";import xc from"./FeatureLayer-029b8c63.js";import{s as Qo,i as Rn}from"./Identifiable-e3a09883.js";import{b as mr}from"./Layer-8a472a77.js";import{h as kc,c as Xo,f as Jo,e as Sn,i as rs,M as Ac,r as ea,n as Pc}from"./mat2d-80bd93af.js";import{e as gr}from"./Queue-e839cb6a.js";import{t as $c,I as Fc,y as Rc}from"./Scheduler-74975675.js";import{T as Sc}from"./TimeExtent-84882adb.js";import{j as ta,b as Lc}from"./asyncUtils-59234081.js";import{m as Dc,_ as Oc}from"./Promise-088a0e17.js";import{l as Vc,i as ia,a as fr}from"./GraphicsCollection-e2a7679b.js";import{v as Ln}from"./HeightModelInfo-15bb1adf.js";import{m as Nc}from"./arcgisLayerUrl-269cc7a9.js";import{l as _r}from"./ViewingMode-fb6259a5.js";import{t as an,r as zc}from"./unitBezier-881ac1eb.js";import{r as sa}from"./common-701a4199.js";import{o as ln,v as yr,y as Bc,j as qc,q as vr,C as na,l as ws,r as te,z as Ke,g as Uc,a as os,s as Hc,m as Gc}from"./vec2-f978aef8.js";import{r as Wc,n as Q}from"./vec2f64-e0301652.js";import{s as jc,r as Zc,M as wr,h as Kc,i as Yc}from"./mat3-45e3f2eb.js";import{e as $s}from"./mat3f32-d3d088e8.js";import{t as br}from"./vec2f32-461e65a9.js";import"./TileStrategy-a62d1e84.js";import{d as Qc,h as Xc}from"./TileStore-4c0c3140.js";import"./TileKey-ab325718.js";import{l as Jc}from"./capabilities-320386e9.js";import{r as ed}from"./context-util-cb6895d7.js";import"./nextTick-3ee5a785.js";import"./deprecate-99da8bee.js";import"./Portal-ac0dca24.js";import"./PortalGroup-f3dee6d8.js";import"./jsonMap-a9c94baf.js";import"./PortalUser-cdb4116b.js";import"./PortalItem-07c1e88d.js";import"./messages-03a939ad.js";import"./writeUtils-7d75cb47.js";import"./layerUtils-6996b9ea.js";import"./colorUtils-639f4d25.js";import"./SimpleObservable-7c382d01.js";import"./typeUtils-d7b057b5.js";import"./Connection-98b56925.js";import"./mat4-62d5e6a4.js";import"./zscale-a508c8e5.js";import"./aaBoundingRect-45a7fe45.js";import"./uuid-73213768.js";import"./query-e9f3f48f.js";import"./pbfQueryUtils-21bc0894.js";import"./OptimizedFeature-9345d11b.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-bb883c00.js";import"./parser-e6166e34.js";import"./ItemCache-9a7b0057.js";import"./MemCache-5bd66e9c.js";import"./CIMSymbol-d0e12b74.js";import"./Symbol-f45dc441.js";import"./aaBoundingBox-6fbd5972.js";import"./persistableUrlUtils-7e525def.js";import"./UniqueValueRenderer-83bbe8b7.js";import"./diffUtils-58fbd195.js";import"./colorRamps-3439e132.js";import"./sizeVariableUtils-d4870b0d.js";import"./lengthUtils-5215af35.js";import"./jsonUtils-f34afef9.js";import"./styleUtils-84c98663.js";import"./DictionaryLoader-d07ab55e.js";import"./LRUCache-36379339.js";import"./heatmapUtils-90a13d85.js";import"./vec4f64-018b3fa6.js";import"./Field-0ac3c9d2.js";import"./fieldType-4ec45634.js";import"./MultiOriginJSONSupport-03b5d89b.js";import"./LayerFloorInfo-689deffc.js";import"./FeatureLayerBase-eb47a35c.js";import"./OperationalLayer-7b681a2a.js";import"./ElevationInfo-4e7fad68.js";import"./editsZScale-b69b4057.js";import"./APIKeyMixin-abc940e1.js";import"./ArcGISService-a76daa10.js";import"./BlendLayer-1b58b599.js";import"./CustomParametersMixin-35ce1754.js";import"./EditBusLayer-0384e3a7.js";import"./FeatureReductionLayer-d7ad3b5e.js";import"./labelingInfo-f1d3ed98.js";import"./labelUtils-4072dca9.js";import"./defaultsJSON-b087dd4d.js";import"./OrderedLayer-f1fc272b.js";import"./PortalLayer-4d594091.js";import"./RefreshableLayer-b2e977af.js";import"./ScaleRangeLayer-d12362d4.js";import"./TemporalLayer-e6ec9fbe.js";import"./TimeInfo-cbe37d4e.js";import"./FeatureTemplate-a0acfd3d.js";import"./FeatureType-1ca0df1a.js";import"./fieldProperties-6efd2194.js";import"./FieldsIndex-394de0a1.js";import"./versionUtils-95cac3d6.js";import"./styleUtils-77b2285b.js";import"./popupUtils-aa41216c.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var cn;let Ui=cn=class extends Fi{constructor(i){super(i),this.type="none"}clone(){return new cn({type:this.type})}};a([zl({none:"none",stayAbove:"stay-above"})],Ui.prototype,"type",void 0),Ui=cn=a([I("esri.ground.NavigationConstraint")],Ui);let z=class extends S{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};a([l()],z.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),a([l()],z.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),a([l()],z.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),a([l()],z.prototype,"DECONFLICTOR_SHOW_GRID",void 0),a([l()],z.prototype,"LABELS_SHOW_BORDER",void 0),a([l()],z.prototype,"TEXT_SHOW_BASELINE",void 0),a([l()],z.prototype,"TEXT_SHOW_BORDER",void 0),a([l()],z.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),a([l()],z.prototype,"OVERLAY_SHOW_CENTER",void 0),a([l()],z.prototype,"SHOW_POI",void 0),a([l()],z.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),a([l()],z.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),a([l()],z.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),a([l()],z.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),a([l()],z.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),a([l()],z.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),a([l()],z.prototype,"I3S_TREE_SHOW_TILES",void 0),a([l()],z.prototype,"I3S_SHOW_MODIFICATIONS",void 0),a([l()],z.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),a([l()],z.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),a([l()],z.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),a([l()],z.prototype,"LINE_WIREFRAMES",void 0),a([l()],z.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),z=a([I("esri.views.3d.support.DebugFlags")],z);const td=new z;var dn;let Ae=dn=class extends yl(sn){constructor(i){super(i),this.opacity=1,this.shading=!td.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new H;const e=s=>{s.parent&&s.parent!==this&&"remove"in s.parent&&s.parent.remove(s),s.parent=this,s.type!=="elevation"&&s.type!=="base-elevation"&&R.getLogger(this.declaredClass).error(`Layer '${s.title}, id:${s.id}' of type '${s.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=s=>{s.parent=null};this.layers.on("after-add",s=>e(s.item)),this.layers.on("after-remove",s=>t(s.item))}initialize(){this.when().catch(i=>{R.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",Il(i,this._get("layers")))}writeLayers(i,e,t,s){const n=[];i&&(s={...s,layerContainerType:"ground"},i.forEach(r=>{if("write"in r){const o={};Cl(r)().write(o,s)&&n.push(o)}else s&&s.messages&&s.messages.push(new x("layer:unsupported",`Layers (${r.title}, ${r.id}) of type '${r.declaredClass}' cannot be persisted in the ground`,{layer:r}))})),e.layers=n}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return Tl(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await w(()=>import("./ElevationQuery-1560d197.js"),["assets/ElevationQuery-1560d197.js","assets/asyncUtils-59234081.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/unitUtils-43365914.js","assets/jsonMap-a9c94baf.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/projection-33a6cba9.js","assets/preload-helper-101896b7.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-7c382d01.js","assets/mat4-62d5e6a4.js","assets/assets-4cb15247.js","assets/request-c2b0ab45.js","assets/zscale-a508c8e5.js","assets/aaBoundingRect-45a7fe45.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/TileInfo-2e5a94dc.js"]);_t(e);const s=new t,n=this.layers.filter(Mr).toArray();return s.queryAll(n,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await w(()=>import("./ElevationQuery-1560d197.js"),["assets/ElevationQuery-1560d197.js","assets/asyncUtils-59234081.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/unitUtils-43365914.js","assets/jsonMap-a9c94baf.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/projection-33a6cba9.js","assets/preload-helper-101896b7.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-7c382d01.js","assets/mat4-62d5e6a4.js","assets/assets-4cb15247.js","assets/request-c2b0ab45.js","assets/zscale-a508c8e5.js","assets/aaBoundingRect-45a7fe45.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/TileInfo-2e5a94dc.js"]);_t(e);const s=new t,n=this.layers.filter(Mr).toArray();return s.createSamplerAll(n,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:tn(this.surfaceColor),navigationConstraint:tn(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new dn({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const s=e&&e.origin||"web-scene",n=e&&e.portal||null,r=e&&e.url||null;return w(()=>import("./layersCreator-a97e100e.js"),["assets/layersCreator-a97e100e.js","assets/Collection-e2259e32.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/lazyLayerLoader-2fd997ad.js","assets/preload-helper-101896b7.js","assets/PortalItem-07c1e88d.js","assets/assets-4cb15247.js","assets/request-c2b0ab45.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/Extent-7f29a1bb.js","assets/Portal-ac0dca24.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/jsonMap-a9c94baf.js","assets/PortalUser-cdb4116b.js","assets/portalLayers-98dd8a12.js","assets/layersLoader-9a31c663.js","assets/Layer-8a472a77.js","assets/geometry-4b789d90.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/Identifiable-e3a09883.js","assets/arcgisLayerUrl-269cc7a9.js","assets/persistableUrlUtils-7e525def.js","assets/jsonContext-67f0b88a.js","assets/portalItemUtils-a26f8af3.js","assets/projection-33a6cba9.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-43365914.js","assets/mat4-62d5e6a4.js","assets/zscale-a508c8e5.js","assets/styleUtils-77b2285b.js","assets/asyncUtils-59234081.js"]).then(({populateOperationalLayers:o})=>{_t(t);const c=[];if(i.layers&&Array.isArray(i.layers)){const d={context:{origin:s,url:r,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(o(this.layers,i.layers,d))}return bt(c)}).then(()=>{})}};function id(i){return i&&"createElevationSampler"in i}function Mr(i){return i.type==="elevation"||id(i)}a([l({json:{read:!1}})],Ae.prototype,"layers",null),a([Oo("layers")],Ae.prototype,"writeLayers",null),a([l({readOnly:!0})],Ae.prototype,"resourceInfo",void 0),a([l({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:ar,read:{reader:Bl,source:"transparency"},write:{writer:(i,e)=>{e.transparency=ql(i)},target:"transparency"}}})],Ae.prototype,"opacity",void 0),a([l({type:Boolean,nonNullable:!0,json:{read:!1}})],Ae.prototype,"shading",void 0),a([l({type:wt,json:{type:[ar],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],Ae.prototype,"surfaceColor",void 0),a([l({type:Ui,json:{write:!0}})],Ae.prototype,"navigationConstraint",void 0),Ae=dn=a([I("esri.Ground")],Ae);const as=Ae;function sd(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const Ir=R.getLogger("esri.support.basemapUtils");function nd(){return{}}function rd(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function od(i,e){let t;if(typeof i=="string"){if(!(i in nr)){const s=Object.entries(nr).filter(([n,r])=>rr.apiKey&&!r.classic||!rr.apiKey&&r.classic&&!r.deprecated).map(([n])=>`"${n}"`).join(", ");return Ir.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${s}`),null}e&&(t=e[i]),t||(t=en.fromId(i),e&&(e[i]=t))}else t=Do(en,i);return t!=null&&t.destroyed&&(Ir.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}const Cr={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function ad(i){let e=null;if(typeof i=="string")if(i in Cr){const t=Cr[i];e=new as({resourceInfo:{data:{layers:[t]}}})}else R.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=Do(as,i);return e}let Pe=class extends Hl(Gl(fs.EventedMixin(S))){constructor(e){super(e),this.allLayers=new is({getCollections:()=>{var t,s,n;return[(t=this.basemap)==null?void 0:t.baseLayers,(s=this.ground)==null?void 0:s.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=Wl(this),this.basemap=null,this.editableLayers=new is({getCollections:()=>[this.allLayers],itemFilterFunction:sd}),this.ground=new as,this._basemapCache=nd()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),rd(this._basemapCache),this._basemapCache=null}castBasemap(e){return od(e,this._basemapCache)}castGround(e){const t=ad(e);return $(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};a([l({readOnly:!0,dependsOn:[]})],Pe.prototype,"allLayers",void 0),a([l({readOnly:!0})],Pe.prototype,"allTables",void 0),a([l({type:en})],Pe.prototype,"basemap",void 0),a([pe("basemap")],Pe.prototype,"castBasemap",null),a([l({readOnly:!0})],Pe.prototype,"editableLayers",void 0),a([l({type:as,nonNullable:!0})],Pe.prototype,"ground",void 0),a([pe("ground")],Pe.prototype,"castGround",null),Pe=a([I("esri.Map")],Pe);const ra=Pe;let Ue=class extends Bo(Fi){constructor(...e){super(...e),this.position=new K([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,s,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const r={position:e};return t!=null&&(r.heading=t),s!=null&&(r.tilt=s),n!=null&&(r.fov=n),r}return e}writePosition(e,t,s,n){const r=e.clone();r.x=gt(e.x||0),r.y=gt(e.y||0),r.z=e.hasZ?gt(e.z||0):e.z,t[s]=r.write({},n)}readPosition(e,t){const s=new K;return s.read(e,t),s.x=gt(s.x||0),s.y=gt(s.y||0),s.z=s.hasZ?gt(s.z||0):s.z,s}equals(e){return!$(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};a([l({type:K,json:{write:{isRequired:!0}}})],Ue.prototype,"position",void 0),a([Oo("position")],Ue.prototype,"writePosition",null),a([Fl("position")],Ue.prototype,"readPosition",null),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),pe(i=>jl.normalize(gt(i)))],Ue.prototype,"heading",void 0),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),pe(i=>oi(gt(i),-180,180))],Ue.prototype,"tilt",void 0),a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Ue.prototype,"fov",void 0),Ue=a([I("esri.Camera")],Ue);const ld=Ue;var hn;let rt=hn=class extends Fi{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new hn({rotation:this.rotation,scale:this.scale,targetGeometry:M(this.targetGeometry)?this.targetGeometry.clone():null,camera:M(this.camera)?this.camera.clone():null})}};function Fs(){return{enabled:!this.camera}}a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Fs}}}}})],rt.prototype,"rotation",void 0),a([pe("rotation")],rt.prototype,"castRotation",null),a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Fs}}}}})],rt.prototype,"scale",void 0),a([l({types:Yl,json:{read:lr,write:!0,origins:{"web-scene":{read:lr,write:{overridePolicy:Fs}}}}})],rt.prototype,"targetGeometry",void 0),a([l({type:ld,json:{write:!0}})],rt.prototype,"camera",void 0),rt=hn=a([I("esri.Viewpoint")],rt);const Ve=rt,Hi={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],s=e[1],n=this.values;return s>=t?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Rs={xsmall:544,small:768,medium:992,large:1200};function cd(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Ss(i,e){return e?Hi[i].valueToClassName[e].split(" "):[]}const dd=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new Je,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Rs}initialize(){this._breakpointsHandles.add(v(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),O))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=le(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const s=cd(t);if(!s){const n=JSON.stringify(Rs,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}t=s?t:Rs,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=Oi.acquire(),s=Oi.acquire();let n,r=!1;for(n in Hi){const o=this[n],c=Hi[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==c&&(r=!0,this[n]=c,Ss(n,o).forEach(d=>s.push(d)),Ss(n,c).forEach(d=>t.push(d)))}r&&(this._applyClassNameChanges(t,s),Oi.release(t),Oi.release(s))}_applyClassNameChanges(t,s){const n=this.container;n&&(s.forEach(r=>n.classList.remove(r)),t.forEach(r=>n.classList.add(r)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let s;for(s in Hi)Ss(s,this[s]).forEach(n=>t.classList.remove(n))}};return a([l()],e.prototype,"breakpoints",null),a([l()],e.prototype,"orientation",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),a([l()],e.prototype,"heightBreakpoint",void 0),e=a([I("esri.views.BreakpointsOwner")],e),e};let ot=class extends S{constructor(){super(...arguments),this.items=new H,this._watchUpdatingTracking=new Go,this._callbacks=new Map,this._projector=rn(),this._hiddenProjector=rn()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const s of t.added){const n=()=>s.render();this._callbacks.set(s,n),this._projector.append(this.surface,n)}for(const s of t.removed){const n=this._projector.detach(this._callbacks.get(s));this.surface.removeChild(n.domNode),this._callbacks.delete(s)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,s=this._hiddenProjector;let n=null;const r=()=>(n=e.render(),n);s.append(t,r),s.renderNow();const o={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const c=n.domNode.getBoundingClientRect();o.left=c.left,o.top=c.top,o.right=c.right,o.bottom=c.bottom}for(s.detach(r);t.firstChild;)t.removeChild(t.firstChild);return o}overlaps(e,t){const s=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(s.left,n.left)<=Math.min(s.right,n.right)&&Math.max(s.top,n.top)<=Math.min(s.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(s=>s.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(s=>{t.save(),s.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([l({readOnly:!0})],ot.prototype,"surface",void 0),a([l({readOnly:!0})],ot.prototype,"items",void 0),a([l({readOnly:!0})],ot.prototype,"needsRender",null),a([l({readOnly:!0})],ot.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],ot.prototype,"updating",null),ot=a([I("esri.views.overlay.ViewOverlay")],ot);const Tr=ot;function si(i,e,t,s){let n=null,r=1e3;typeof e=="number"?(r=e,s=t):(n=e??null,r=t);let o,c=0;const d=()=>{c=0,i.apply(s,o)},h=(...u)=>{n&&n.apply(s,u),o=u,r?c||(c=setTimeout(d,r)):d()};return h.remove=()=>{c&&(clearTimeout(c),c=0)},h.forceUpdate=()=>{c&&(clearTimeout(c),d())},h.hasPendingUpdates=()=>!!c,h}const Er=["B","kB","MB","GB","TB"];function hd(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(ur.KILOBYTES));t=oi(t,0,Er.length-1);const s=Fn(e/ur.KILOBYTES**t,{maximumFractionDigits:2});return ri(i.units.bytes[Er[t]],{fileSize:s})}const ud="esri.widgets.Feature.support.featureUtils",xr=R.getLogger(ud),pd=/href=(""|'')/gi,md=/(\{([^\{\r\n]+)\})/g,gd=/\'/g,oa=/^\s*expression\//i,fd=/(\n)/gi,_d=/[\u00A0-\u9999<>\&]/gim,yd=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,vd=/^(?:mailto:|tel:)/,aa="relationships/",un=jo("short-date-short-time");function la(i){if(!$(i))return i.get("sourceLayer")||i.get("layer")}async function ls(i,e){return typeof i=="function"?i.call(null,e):i}function ca(i=""){if(i)return!vd.test(i.trim().toLowerCase())}function Dn(i){return!!i&&oa.test(i)}function wd(i,e){if(!Dn(e)||!i)return null;const t=e.replace(oa,"").toLowerCase();let s;return i.some(n=>n.name.toLowerCase()===t&&(s=n,!0)),s}function da(i,e){const t=wd(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function bd(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function Md(i){return i.replace(pd,"")}function Pi(i,e){const t=On(e,i);return t?t.name:i}function Id(i,e){return i&&i.map(t=>Pi(t,e))}function On(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function ha(i){return`${i}`.trim()}function Lt({attributes:i,globalAttributes:e,layer:t,text:s,expressionAttributes:n,fieldInfoMap:r}){return s?pn({formattedAttributes:e,template:xd(s,{...e,...n,...i},t),fieldInfoMap:r}):""}function pn({formattedAttributes:i,template:e,fieldInfoMap:t}){return ha(Md(ri(ri(e,s=>bd(s,t)),i)))}function Cd(i,e,t=!1){const s=e[i];if(typeof s=="string"){const n="%27",r=(t?encodeURIComponent(s):s).replace(gd,n);e[i]=r}}function Td(i,e=!1){const t={...i};return Object.keys(t).forEach(s=>Cd(s,t,e)),t}function Ed(i,e,t){const s=(e=ha(e))&&e[0]!=="{";return ri(i,Td(t,s))}function mn(i,e){return i.replace(md,(t,s,n)=>{const r=On(e,n);return r?`{${r.name}}`:s})}function xd(i,e,t){const s=mn(i,t);return s&&s.replace(yd,(n,r,o)=>Ed(n,r||o,e))}function kd(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function Ad(i){return(i==null?void 0:i.type)==="feature"}function kr(i){return!!(i!=null&&i.layer)}function Pd(i){return(i==null?void 0:i.type)==="map-image"}function $d(i,e){var h;const t=e.fieldInfos,s=e.fieldName,n=(h=ua(t,s))==null?void 0:h.clone(),r=e.preventPlacesFormatting,o=e.layer,c=On(o,s);if(n&&(c==null?void 0:c.type)==="date"){const u=n.format||new dc;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!kr(o)&&Ad(o)&&o.datesInUnknownTimezone||kr(o)&&Pd(o.layer)&&o.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=u}const d=n&&n.format;return typeof i=="string"&&lc(s)&&d?d.formatRasterPixelValue(i):typeof(i=kd(i,d))=="string"||i==null||d==null?Li(i):r?Fn(i,{...rc(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(i)}function ua(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let s;return i.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==t)&&(s=n,!0)),s}function Fd({fieldName:i,graphic:e,layer:t}){if(Qe(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:s}=t;if(!s||i!==s)return null;const n=t.getFeatureType(e);return n?n.name:null}function Rd({fieldName:i,value:e,graphic:t,layer:s}){if(Qe(i)||!s||typeof s.getFieldDomain!="function")return null;const n=s.getFieldDomain(i,{feature:t});return n&&n.type==="coded-value"?n.getName(e):null}function Sd(i,e){const{creatorField:t,creationDateField:s,editorField:n,editDateField:r}=i;if(!e)return;const o=e[r];if(typeof o=="number"){const d=e[n];return{type:"edit",date:ns(o,un),user:d}}const c=e[s];if(typeof c=="number"){const d=e[t];return{type:"create",date:ns(c,un),user:d}}return null}function Ld(i,e){const t=new Map;return i&&i.forEach(s=>{const n=Pi(s.fieldName,e);s.fieldName=n,t.set(n.toLowerCase(),s)}),t}function Ar(i){const e=[];if(!i)return e;const{fieldInfos:t,content:s}=i;return t&&e.push(...t),s&&Array.isArray(s)&&s.forEach(n=>{if(n.type==="fields"){const r=n&&n.fieldInfos;r&&e.push(...r)}}),e}function Vn(i){return i.replace(_d,e=>`&#${e.charCodeAt(0)};`)}function Li(i){return typeof i=="string"?i.replace(fd,'<br class="esri-text-new-line" />'):i}function pa(i){const{value:e,fieldName:t,fieldInfos:s,fieldInfoMap:n,layer:r,graphic:o}=i;if(e==null)return"";const c=Rd({fieldName:t,value:e,graphic:o,layer:r});if(c)return c;const d=Fd({fieldName:t,graphic:o,layer:r});if(d)return d;if(n.get(t.toLowerCase()))return $d(e,{fieldInfos:s||Array.from(n.values()),fieldName:t,layer:r});const h=r&&r.fieldsIndex;return h&&h.isDateField(t)?ns(e,un):Li(e)}function Ls({fieldInfos:i,attributes:e,layer:t,graphic:s,fieldInfoMap:n,relatedInfos:r}){const o={};return r==null||r.forEach(c=>zd({attributes:o,relatedInfo:c,fieldInfoMap:n,fieldInfos:i,layer:t})),Object.keys(e).forEach(c=>{const d=e[c];o[c]=pa({fieldName:c,fieldInfos:i,fieldInfoMap:n,layer:t,value:d,graphic:s})}),o}async function Dd(i,e){var u,p;const{layer:t,graphic:s,outFields:n,objectIds:r,returnGeometry:o,spatialReference:c}=i,d=r[0];if(typeof d!="number"&&typeof d!="string"){const g="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:s,objectId:d,requiredFields:n};return xr.warn(g,f),null}if(!((p=(u=t.capabilities)==null?void 0:u.operations)!=null&&p.supportsQuery)){const g="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:s,requiredFields:n,returnGeometry:o};return xr.warn(g,f),null}const h=t.createQuery();return h.objectIds=r,h.outFields=n!=null&&n.length?n:[t.objectIdField],h.returnGeometry=!!o,h.returnZ=!!o,h.returnM=!!o,h.outSpatialReference=c,(await t.queryFeatures(h,e)).features[0]}async function Od(i){var s;if(!((s=i.expressionInfos)!=null&&s.length))return!1;const e=await Yo(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function Vd({graphic:i,popupTemplate:e,layer:t,spatialReference:s},n){if(!t||!e||(typeof t.load=="function"&&await t.load(n),!i.attributes))return;const r=i.attributes[t.objectIdField];if(r==null)return;const o=[r],c=await e.getRequiredFields(t.fieldsIndex),d=ac(c,i),h=d?[]:c,u=e.returnGeometry||await Od(e);if(d&&!u)return;const p=await Dd({layer:t,graphic:i,outFields:h,objectIds:o,returnGeometry:u,spatialReference:s},n);p&&(p.geometry&&(i.geometry=p.geometry),p.attributes&&(i.attributes={...i.attributes,...p.attributes}))}function Qe(i=""){return!!i&&i.includes(aa)}function Nd(i){return i?`${aa}${i.layerId}/${i.fieldName}`:""}function Pr({attributes:i,graphic:e,relatedInfo:t,fieldInfos:s,fieldInfoMap:n,layer:r}){i&&e&&t&&Object.keys(e.attributes).forEach(o=>{const c=Nd({layerId:t.relation.id.toString(),fieldName:o}),d=e.attributes[o];i[c]=pa({fieldName:c,fieldInfos:s,fieldInfoMap:n,layer:r,value:d,graphic:e})})}function zd({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(r=>Pr({attributes:i,graphic:r,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(r=>Pr({attributes:i,graphic:r,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})))}const $r=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},ma=({layer:i,method:e,query:t,definitionExpression:s})=>{var o,c;if(!((c=(o=i.capabilities)==null?void 0:o.query)!=null&&c.supportsCacheHint)||e==="attachments")return;const n=M(t.where)&&t.where,r=M(t.geometry)&&t.geometry;$r(s)||$r(n)||(r==null?void 0:r.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},Bd=({query:i,layer:e,method:t})=>{ma({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},qd=({queryPayload:i,layer:e,method:t})=>{ma({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function Ud(i,e,t){return i&&e&&t?Fr(i.allLayers,e,t)||Fr(i.allTables,e,t):null}function Fr(i,e,t){return i.find(s=>s!==e&&s.type==="feature"&&s.url===e.url&&s.layerId===t.relatedTableId)}const Rr={editing:!1,operations:{add:!0,update:!0,delete:!0}},ga=H.ofType(oc);let ce=class extends S{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...Rr},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new ga,this.fileInfos=new H,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(v(()=>this.graphic,()=>this._graphicChanged(),O))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...Rr,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new x("invalid-layer","getAttachments(): A valid layer is required.");const s=this._getObjectId(),n=new pr({objectIds:[s],returnMetadata:!0}),r=[],o=e.queryAttachments(n).then(d=>d[s]||r).catch(()=>r);this._getAttachmentsPromise=o,this.notifyChange("state");const c=await o;return t.removeAll(),c.length&&t.addMany(c),this._getAttachmentsPromise=null,this.notifyChange("state"),c}async addAttachment(e,t=this.graphic){const{_attachmentLayer:s,attachmentInfos:n,abilities:r}=this;if(!t)throw new x("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new x("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!r.operations.add)throw new x("invalid-abilities","addAttachment(): add abilities are required.");if(!s||typeof s.addAttachment!="function")throw new x("invalid-layer","addAttachment(): A valid layer is required.");const o=s.addAttachment(t,e).then(d=>this._queryAttachment(d.objectId,t)),c=await o;return n.add(c),c}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:s,graphic:n,abilities:r}=this;if(!e)throw new x("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!r.operations.delete)throw new x("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new x("invalid-layer","deleteAttachment(): A valid layer is required.");const o=t.deleteAttachments(n,[e.id]).then(()=>e),c=await o;return s.remove(c),c}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:s,attachmentInfos:n,graphic:r,abilities:o}=this;if(!e)throw new x("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new x("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!o.operations.update)throw new x("invalid-abilities","updateAttachment(): Update abilities are required.");const c=n.findIndex(u=>u===t);if(!s||typeof s.updateAttachment!="function")throw new x("invalid-layer","updateAttachment(): A valid layer is required.");const d=s.updateAttachment(r,t.id,e).then(u=>this._queryAttachment(u.objectId)),h=await d;return n.splice(c,1,h),h}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const s={file:e,form:t};return this.fileInfos.add(s),s}updateFile(e,t,s=this.activeFileInfo){if(!e||!t||!s)return null;const n=this.fileInfos.findIndex(r=>s===r);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}deleteFile(e){const t=this.fileInfos.find(s=>s.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new x("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:s}=this,n=this._getObjectId(t),r=new pr({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return s.queryAttachments(r).then(o=>o[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=la(e);this._attachmentLayer=t?t.type==="scene"&&M(t.associatedLayer)?t.associatedLayer:t:null}};a([l()],ce.prototype,"abilities",void 0),a([pe("abilities")],ce.prototype,"castAbilities",null),a([l()],ce.prototype,"activeAttachmentInfo",void 0),a([l()],ce.prototype,"activeFileInfo",void 0),a([l({readOnly:!0,type:ga})],ce.prototype,"attachmentInfos",void 0),a([l()],ce.prototype,"fileInfos",void 0),a([l({type:Nt})],ce.prototype,"graphic",void 0),a([l()],ce.prototype,"mode",void 0),a([l({readOnly:!0})],ce.prototype,"state",null),a([l()],ce.prototype,"filesEnabled",void 0),a([l({readOnly:!0})],ce.prototype,"supportsResizeAttachments",null),ce=a([I("esri.widgets.Attachments.AttachmentsViewModel")],ce);const Nn=ce;function Sr(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function Hd(i){const e=yc("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const Lr={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},b={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},Ds=window.CSS;let ie=class extends ne{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new Nn,this.visibleElements={...Lr},this._supportsImageOrientation=Ds&&Ds.supports&&Ds.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),O)])}loadDependencies(){return Promise.all([w(()=>import("./calcite-icon-ac6b684b.js"),["assets/calcite-icon-ac6b684b.js","assets/icon-de53a9d7.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/observers-73b5e0ed.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...Lr,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new x("attachments:add-attachment",this.messages.addErrorMessage,s)),s})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new x("attachments:delete-attachment",this.messages.deleteErrorMessage,s)),s})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(s=>(this._set("submitting",!1),this._set("error",null),e.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new x("attachments:update-attachment",this.messages.updateErrorMessage,s)),s})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:s}=t;return m("div",{class:this.classes(b.base,b.esriWidget)},e?this.renderProgressBar():null,s==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?m("div",{key:"error-message",class:b.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:s}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(s||e):this.renderAttachmentContainer()}renderLoading(){return m("div",{class:b.loaderContainer,key:"loader"},m("div",{class:b.loader}))}renderProgressBar(){return this.visibleElements.progressBar?m("div",{class:b.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,s=e||!t,n=this.visibleElements.cancelAddButton?m("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(b.esriButton,b.esriButtonTertiary,b.esriButtonSmall,b.esriButtonHalf,e&&b.buttonDisabled)},this.messages.cancel):null,r=this.visibleElements.addSubmitButton?m("button",{type:"submit",disabled:s,class:this.classes(b.esriButton,b.esriButtonSecondary,b.esriButtonSmall,b.esriButtonHalf,{[b.buttonDisabled]:s})},this.messages.add):null,o=t?m("span",{key:"file-name",class:b.fileName},t.name):null,c=m("form",{bind:this,afterCreate:ss,afterRemoved:cr,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},m("fieldset",{class:b.fileFieldset},o,m("label",{class:this.classes(b.fileLabel,b.esriButton,b.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,m("input",{class:b.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),r,n);return m("div",{key:"add-form-container",class:b.formNode},c)}renderDetailsForm(e){const{visibleElements:t,viewModel:s,selectedFile:n,submitting:r}=this,{abilities:o}=s,c=r||!n;let d,h,u,p;n?(d=n.type,h=n.name,u=n.size):"file"in e?(d=e.file.type,h=e.file.name,u=e.file.size):(d=e.contentType,h=e.name,u=e.size,p=e.url);const g=o.editing&&o.operations.delete&&t.deleteButton?m("button",{key:"delete-button",type:"button",disabled:r,bind:this,onclick:B=>this._submitDeleteAttachment(B,e),class:this.classes(b.esriButton,b.esriButtonSmall,b.esriButtonTertiary,b.deleteButton,{[b.buttonDisabled]:r})},this.messages.delete):void 0,f=o.editing&&o.operations.update&&t.updateButton?m("button",{disabled:c,key:"update-button",type:"submit",class:this.classes(b.esriButton,b.esriButtonSmall,b.esriButtonThird,{[b.buttonDisabled]:c})},this.messages.update):void 0,y=this.visibleElements.cancelUpdateButton?m("button",{disabled:r,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(b.esriButton,b.esriButtonSmall,b.esriButtonTertiary,b.esriButtonThird,{[b.buttonDisabled]:r})},this.messages.cancel):void 0,T=o.editing&&o.operations.update?m("fieldset",{key:"file",class:b.fileFieldset},m("span",{key:"file-name",class:b.fileName},h),m("label",{class:this.classes(b.fileLabel,b.esriButton,b.esriButtonSecondary)},this.messages.changeFile,m("input",{class:b.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,C=m("fieldset",{key:"size",class:b.metadataFieldset},m("label",null,hd(this.messagesUnits,u))),P=m("fieldset",{key:"content-type",class:b.metadataFieldset},m("label",null,d)),D=M(p)?m("a",{class:b.itemLink,href:p,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),m("div",{class:b.itemLinkOverlay},m("span",{class:b.itemLinkOverlayIcon},m("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),L=m("form",{bind:this,afterCreate:ss,afterRemoved:cr,"data-node-ref":"_updateAttachmentForm",onsubmit:B=>this._submitUpdateAttachment(B,e)},m("div",{class:b.metadata},C,P),T,m("div",{class:b.actions},g,y,f));return m("div",{key:"edit-form-container",class:b.formNode},D,L)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:s}=this.viewModel,n=Hd(t),r={[b.itemImageResizable]:s};return m("div",{class:this.classes(b.itemMaskIcon,b.itemMask)},m("img",{title:e,alt:e,src:n,class:this.classes(r,b.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:s}=this.viewModel,{contentType:n,name:r,url:o}=e;if(!s||!Sr(n))return this.renderGenericImageMask(r,n);const c=this._getCSSTransform(e),d=c?{transform:c,"image-orientation":"none"}:{},h=`${o}${o.includes("?")?"&":"?"}w=${t}`,u={[b.itemImageResizable]:s};return m("div",{class:this.classes(b.itemMask)},m("img",{styles:d,alt:r,title:r,src:h,class:this.classes(u,b.itemImage)}))}renderFile(e){const{file:t}=e;return m("li",{class:b.item,key:t},m("button",{key:"details-button",bind:this,class:b.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),m("label",{class:b.itemLabel},m("span",{class:b.itemFilename},t.name||this.messages.noTitle),m("span",{"aria-hidden":"true",class:this.classes(b.itemChevronIcon,Oe(this.container)?b.iconLeft:b.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:s,effectiveDisplayType:n}=this,{abilities:r,supportsResizeAttachments:o}=s,{contentType:c,name:d,url:h}=e,u=this.renderImageMask(e,t==="list"?48:400),p=r.editing?m("span",{"aria-hidden":"true",class:this.classes(b.itemChevronIcon,Oe(this.container)?b.iconLeft:b.iconRight)}):null,g=[u,n==="preview"&&o&&Sr(c)?null:m("label",{class:b.itemLabel},m("span",{class:b.itemFilename},d||this.messages.noTitle),p)],f=r.editing?m("button",{key:"details-button",bind:this,class:b.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},g):m("a",{key:"details-link",class:b.itemButton,href:h,target:"_blank"},g);return m("li",{class:b.item,key:e},f)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:s}=this,{attachmentInfos:n,abilities:r,fileInfos:o}=t,c=!!(n!=null&&n.length),d=!!(o!=null&&o.length),h={[b.containerList]:e!=="preview",[b.containerPreview]:e==="preview"},u=r.editing&&r.operations.add&&s.addButton?m("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(b.esriButton,b.esriButtonTertiary,b.addAttachmentButton),type:"button"},m("span",{"aria-hidden":"true",class:this.classes(b.itemAddIcon,b.iconPlus)}),this.messages.add):void 0,p=c?m("ul",{key:"attachments-list",class:b.items},n.toArray().map(y=>this.renderAttachmentInfo({attachmentInfo:y,displayType:e}))):void 0,g=d?m("ul",{key:"file-list",class:b.items},o.toArray().map(y=>this.renderFile(y))):void 0,f=d||c?void 0:m("div",{class:b.empty},this.messages.noAttachments);return m("div",{key:"attachments-container",class:this.classes(b.container,h)},p,g,f,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,s=t&&t.files&&t.files.item(0);this._set("selectedFile",s)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};a([l()],ie.prototype,"abilities",null),a([l()],ie.prototype,"displayType",void 0),a([l({readOnly:!0})],ie.prototype,"effectiveDisplayType",null),a([l()],ie.prototype,"graphic",null),a([l()],ie.prototype,"label",null),a([l(),se("esri/widgets/Attachments/t9n/Attachments")],ie.prototype,"messages",void 0),a([l(),se("esri/core/t9n/Units")],ie.prototype,"messagesUnits",void 0),a([l({readOnly:!0})],ie.prototype,"selectedFile",void 0),a([l({readOnly:!0})],ie.prototype,"submitting",void 0),a([l({readOnly:!0})],ie.prototype,"error",void 0),a([l({type:Nn})],ie.prototype,"viewModel",void 0),a([l()],ie.prototype,"visibleElements",void 0),a([pe("visibleElements")],ie.prototype,"castVisibleElements",null),ie=a([I("esri.widgets.Attachments")],ie);const Gd=ie;let vi=class extends Nn{constructor(e){super(e),this.description=null,this.title=null}};a([l()],vi.prototype,"description",void 0),a([l()],vi.prototype,"title",void 0),vi=a([I("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],vi);const zn=vi,Wd={heading:"esri-widget__heading"};function Bn(i,e){const t=jd(i.level),s=`h${t}`;return delete i.level,m(s,{...i,class:ec(Wd.heading,i.class),role:"heading","aria-level":String(t)},e)}function jd(i){return oi(Math.ceil(i),1,6)}const Os={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let Wt=class extends ne{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return m("div",{class:Os.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?m(Bn,{level:this.headingLevel,class:Os.title},e):null}renderDescription(){const{description:e}=this;return e?m("div",{key:"description",class:Os.description},e):null}};a([l()],Wt.prototype,"description",void 0),a([l()],Wt.prototype,"headingLevel",void 0),a([l()],Wt.prototype,"title",void 0),Wt=a([I("esri.widgets.Feature.support.FeatureElementInfo")],Wt);const bs=Wt,Zd={base:"esri-feature-attachments"};let $e=class extends ne{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new Gd,this.headingLevel=2,this.viewModel=new zn}initialize(){this._featureElementInfo=new bs,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),O),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,O)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return m("div",{class:Zd.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:s}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:s})}};a([l({readOnly:!0})],$e.prototype,"attachmentsWidget",void 0),a([l()],$e.prototype,"description",null),a([l()],$e.prototype,"displayType",null),a([l()],$e.prototype,"graphic",null),a([l()],$e.prototype,"headingLevel",void 0),a([l()],$e.prototype,"title",null),a([l({type:zn})],$e.prototype,"viewModel",void 0),$e=a([I("esri.widgets.Feature.FeatureAttachments")],$e);const Kd=$e;let at=class extends vs(S){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(v(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},O))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:s}=this;e&&(ls(s,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,s=ls(e,{graphic:t}).catch(()=>null);this._loadingPromise=s,this.notifyChange("state");const n=await s;s===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};a([l({readOnly:!0})],at.prototype,"created",void 0),a([l()],at.prototype,"creator",void 0),a([l()],at.prototype,"destroyer",void 0),a([l({type:Nt})],at.prototype,"graphic",void 0),a([l({readOnly:!0})],at.prototype,"state",null),at=a([I("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],at);const cs=at;function Me(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:Qd(i[e])}}}function Yd(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Qd(i){return function(e,...t){Yd(e)?tc(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function Xd(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,s=Array.isArray(i)?i:Jd(i);t.push(...s)}}function Jd(i){return i.split(",").map(e=>e.trim())}const fa="calcite-theme-";function eh(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function ds(){return eh().startsWith("dark")}function th(){return`${fa}${ds()?"dark":"light"}`}function ih(i){sh(i),i.classList.add(th())}function sh(i){Array.from(i.classList).forEach(e=>{e.startsWith(fa)&&i.classList.remove(e)})}const Vs={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let jt=class extends ne{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=s=>{Array.from(s.querySelectorAll("a")).forEach(n=>{ca(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return m("div",{class:Vs.loaderContainer,key:"loader"},m("div",{class:Vs.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?m("div",{key:e,bind:e,afterCreate:this._attachToNode}):qo(e)?m("div",{key:e},!e.destroyed&&e.render()):m("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return m("div",{class:Vs.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};a([l()],jt.prototype,"creator",null),a([l()],jt.prototype,"graphic",null),a([l({type:cs})],jt.prototype,"viewModel",void 0),jt=a([I("esri.widgets.Feature.FeatureContent")],jt);const Gi=jt;let He=class extends S{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,s=[];return t==null||t.forEach(n=>{if(!(!n.hasOwnProperty("visible")||n.visible))return;const r=n.clone();r.label=da(r,e),s.push(r)}),s}};a([l()],He.prototype,"attributes",void 0),a([l({type:[hc]})],He.prototype,"expressionInfos",void 0),a([l()],He.prototype,"description",void 0),a([l({type:[Zo]})],He.prototype,"fieldInfos",void 0),a([l({readOnly:!0})],He.prototype,"formattedFieldInfos",null),a([l()],He.prototype,"title",void 0),He=a([I("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],He);const Ms=He,nh=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function rh(i){let e=null;return nh.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function oh(i,e){if(typeof e!="string"||!e)return e;const t=rh(e);if(!t)return e;const s=e.match(t.pattern),n=s&&s[2],r=ri(ri(t.label,{messages:i,hierPart:n}),{appName:t.appName}),o=t.target?` target="${t.target}"`:"",c=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${o} href="$1"${c}>${r}</a>`)}const ci={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let Ee=class extends ne{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new Ms,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new bs,this.addHandles(v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),O))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,n=e.fieldName,r=e.label||n,o=s?s[n]==null?"":s[n]:"",c=!(!e.format||!e.format.dateFormat),d=typeof o=="number"&&!c?this._forceLTR(o):oh(this.messagesURIUtils,o),h={[ci.fieldDataDate]:c};return m("tr",{key:`fields-element-info-row-${n}-${t}`},m("th",{key:`fields-element-info-row-header-${n}-${t}`,class:ci.fieldHeader,innerHTML:r}),m("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(ci.fieldData,h),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?m("table",{class:ci.esriTable,summary:this.messages.fieldsSummary},m("tbody",null,e.map((t,s)=>this.renderFieldInfo(t,s)))):null}render(){var e;return m("div",{class:ci.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};a([l()],Ee.prototype,"attributes",null),a([l()],Ee.prototype,"description",null),a([l()],Ee.prototype,"expressionInfos",null),a([l()],Ee.prototype,"fieldInfos",null),a([l()],Ee.prototype,"title",null),a([l({type:Ms,nonNullable:!0})],Ee.prototype,"viewModel",void 0),a([l(),se("esri/widgets/Feature/t9n/Feature")],Ee.prototype,"messages",void 0),a([l(),se("esri/widgets/support/t9n/uriUtils")],Ee.prototype,"messagesURIUtils",void 0),Ee=a([I("esri.widgets.Feature.FeatureFields")],Ee);const _a=Ee,ah={maximumFractionDigits:20};function lh(i){return Fn(i,ah)}const ch="<",dh=">",hh=jo("short-date");function uh(i,e,t,s){let n="";e===0?n=`${ch} `:e===t&&(n=`${dh} `);let r=null;return r=s?ns(i,hh):lh(i),n+r}const ph=new wt([64,64,64]);function mh(i,e){const t=[],s=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,s),i.map((n,r)=>t.includes(r)?uh(n,r,s,e):null)}async function gh(i,e,t){let s=!1,n=[],r=[];if(i.stops){const h=i.stops;n=h.map(u=>u.value),s=h.some(u=>!!u.label),s&&(r=h.map(u=>u.label))}const o=n[0],c=n[n.length-1];if(o==null&&c==null)return null;const d=s?null:mh(n,t);return(await Promise.all(n.map(async(h,u)=>({value:h,color:i.type==="opacity"?await fh(h,i,e):(await w(()=>import("./UniqueValueRenderer-83bbe8b7.js").then(p=>p.v),["assets/UniqueValueRenderer-83bbe8b7.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/enumeration-e46f3fd4.js","assets/jsonMap-a9c94baf.js","assets/Extent-7f29a1bb.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/Clonable-f249bc0f.js","assets/LegendOptions-54bbb61a.js","assets/reactiveUtils-3c1b281e.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/PopupTemplate-343851b8.js","assets/number-53937715.js","assets/Identifiable-e3a09883.js","assets/jsonUtils-8bd548d9.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js"])).getColor(i,h),label:s?r[u]:d[u]})))).reverse()}async function fh(i,e,t=ph){const s=new wt(t),n=(await w(()=>import("./UniqueValueRenderer-83bbe8b7.js").then(r=>r.v),["assets/UniqueValueRenderer-83bbe8b7.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/enumeration-e46f3fd4.js","assets/jsonMap-a9c94baf.js","assets/Extent-7f29a1bb.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/Clonable-f249bc0f.js","assets/LegendOptions-54bbb61a.js","assets/reactiveUtils-3c1b281e.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/PopupTemplate-343851b8.js","assets/number-53937715.js","assets/Identifiable-e3a09883.js","assets/jsonUtils-8bd548d9.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js"])).getOpacity(e,i);return n!=null&&(s.a=n),s}function _h(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(s=>{var n;return((n=s.color)==null?void 0:n.a)>0});let t=e.length-1;if(e&&e[0]){const s=e[t];s&&s.ratio!==1&&(e.push(new Mc({ratio:1,color:s.color})),t++)}return e.map((s,n)=>{var o,c;let r="";return n===0?r=((o=i.legendOptions)==null?void 0:o.minLabel)||"low":n===t&&(r=((c=i.legendOptions)==null?void 0:c.maxLabel)||"high"),{color:s.color,label:r,ratio:s.ratio}}).reverse()}R.getLogger("esri.renderers.support.utils");async function ge(i,e,t){$l(i,e,()=>[]).push(...t)}async function yh(i){var t,s;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const n=i.visualVariables.filter(r=>r.type==="color");for(const r of n){const o=(await gh(r)).map(c=>c.color);await ge(e,r.field||r.valueExpression,o)}}if(i.type==="heatmap"){const n=_h(i).map(r=>r.color);await ge(e,i.field||i.valueExpression,n)}else if(i.type==="pie-chart"){for(const n of i.attributes)await ge(e,n.field||n.valueExpression,[n.color]);await ge(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,Ut(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const n of i.attributes)await ge(e,n.field||n.valueExpression,[n.color]);await ge(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((s=i.authoringInfo)==null?void 0:s.type)==="predominance")for(const n of i.uniqueValueInfos??[])await ge(e,n.value.toString(),[Ut(n.symbol,null)]);else{const n=(i.uniqueValueInfos??[]).map(h=>Ut(h.symbol,null)),{field:r,field2:o,field3:c,valueExpression:d}=i;(r||d)&&await ge(e,r||d,n),o&&await ge(e,o,n),c&&await ge(e,c,n)}else if(i.type==="class-breaks"){const n=i.classBreakInfos.map(c=>Ut(c.symbol,null)),{field:r,valueExpression:o}=i;await ge(e,r??o,n)}else i.type==="simple"&&await ge(e,"default",[Ut(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await ge(e,"default",[Ut(i.defaultSymbol,null)]),e.forEach((n,r)=>{const o=Ol(n.filter(Boolean),(c,d)=>JSON.stringify(c)===JSON.stringify(d));e.set(r,o)}),e}const vh="esri.widgets.Feature.support.relatedFeatureUtils",Dr=R.getLogger(vh),Or=new Map;function gn(i){if(!Qe(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function wh(i,e){if(!e.relationships)return null;let t=null;const{relationships:s}=e;return s.some(n=>n.id===parseInt(i,10)&&(t=n,!0)),t}function bh({originRelationship:i,relationships:e,layerId:t}){let s;return e&&e.some(n=>(`${n.relatedTableId}`===t&&n.id===i.id&&(s=n),!!s)),s}function Mh(i,e){const t=e.toLowerCase();for(const s in i)if(s.toLowerCase()===t)return i[s];return null}function Ih(i,e){const t=wh(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function Ch(i,e){if(!e||!i)return;const{features:t,statsFeatures:s}=i,n=t&&t.value;e.relatedFeatures=n?n.features:[];const r=s&&s.value;e.relatedStatsFeatures=r?r.features:[]}function Th(i,e,t,s){const n=new on;return n.outFields=["*"],n.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),n.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(n,s)}function Eh(i,e,t){let s=0;const n=[];for(;s<e.length;)n.push(`${i} IN (${e.slice(s,t+s)})`),s+=t;return n.join(" OR ")}async function xh(i,e,t,s){const n=t.layerId.toString(),{layerInfo:r,relation:o,relatedFields:c,outStatistics:d,url:h,sourceSpatialReference:u}=e,p=bh({originRelationship:o,relationships:r.relationships,layerId:n});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const f=(await Th(i,p,t,s))[i.attributes[t.objectIdField]];if(!f)return null;const y=f.features.map(T=>T.attributes[r.objectIdField]);if((d==null?void 0:d.length)>0&&r.supportsStatistics){const T=new Ps;T.where=Eh(r.objectIdField,y,1e3),T.outFields=c,T.outStatistics=d,T.sourceSpatialReference=u;const C={features:Promise.resolve(f),statsFeatures:ks(h,T)};return bt(C)}}const g=p==null?void 0:p.keyField;if(g){const f=cc(Fh(r.fields,g)),y=Mh(i.attributes,o.keyField),T=f?`${g}=${y}`:`${g}='${y}'`,C=ks(h,new Ps({where:T,outFields:e.relatedFields,sourceSpatialReference:u}),s),P=e.outStatistics&&e.outStatistics.length>0&&r.supportsStatistics?ks(h,new Ps({where:T,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:u}),s):null,D={features:C};return P&&(D.statsFeatures=P),bt(D)}return null}function kh(i,e){return Ul(i,{query:{f:"json"},signal:e&&e.signal})}function Ah({relatedInfos:i,layer:e},t){const s={};return i.forEach((n,r)=>{const{relation:o}=n;if(!o){const p=new x("relation-required","A relation is required on a layer to retrieve related records.");throw Dr.error(p),p}const{relatedTableId:c}=o;if(typeof c!="number"){const p=new x("A related table ID is required on a layer to retrieve related records.");throw Dr.error(p),p}const d=`${e.url}/${c}`,h=Or.get(d),u=h||kh(d,t);h||Or.set(d,u),s[r]=u}),bt(s)}function Ph({graphic:i,relatedInfos:e,layer:t},s){const n={};return e.forEach((r,o)=>{r.layerInfo&&(n[o]=xh(i,r,t,s))}),bt(n)}function $h({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const s=new Ic({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(s)}}function Fh(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const Vr={chartAnimation:!0};let Y=class extends S{constructor(e){super(e),this.abilities={...Vr},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...Vr,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,s=(e+t)%t;this.activeMediaInfoIndex=s}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,s=t+e;this._setContentElementMedia(s)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:s,expressionAttributes:n,fieldInfoMap:r,layer:o}=this;return t==null?void 0:t.map(c=>{const d=c==null?void 0:c.clone();if(!d)return null;if(d.title=Lt({attributes:e,fieldInfoMap:r,globalAttributes:s,expressionAttributes:n,layer:o,text:d.title}),d.caption=Lt({attributes:e,fieldInfoMap:r,globalAttributes:s,expressionAttributes:n,layer:o,text:d.caption}),d.altText=Lt({attributes:e,fieldInfoMap:r,globalAttributes:s,expressionAttributes:n,layer:o,text:d.altText}),d.type==="image"){const{value:h}=d;return this._setImageValue({value:h,formattedAttributes:s,layer:o}),d.value.sourceURL?d:void 0}if(d.type==="pie-chart"||d.type==="line-chart"||d.type==="column-chart"||d.type==="bar-chart"){const{value:h}=d;return this._setChartValue({value:h,chartType:d.type,attributes:e,formattedAttributes:s,layer:o,expressionAttributes:n}),d}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:s,formattedAttributes:n,layer:r}=e,{linkURL:o,sourceURL:c}=s;if(c){const d=mn(c,r);s.sourceURL=pn({formattedAttributes:n,template:d,fieldInfoMap:t})}if(o){const d=mn(o,r);s.linkURL=pn({formattedAttributes:n,template:d,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:s,formattedAttributes:n,chartType:r,layer:o,expressionAttributes:c}=e,{popupTemplate:d,relatedInfos:h}=this,{fields:u,normalizeField:p}=t;if(t.fields=Id(u,o),p&&(t.normalizeField=Pi(p,o)),!u.some(f=>!!(n[f]!=null||Qe(f)&&h.size)))return;const g=d==null?void 0:d.fieldInfos;u.forEach(f=>{if(Qe(f))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:g,fieldName:f,formattedAttributes:n,chartType:r,value:t})]);const y=this._getChartOption({value:t,attributes:s,chartType:r,formattedAttributes:n,expressionAttributes:c,fieldName:f,fieldInfos:g});t.series.push(y)})}_getRelatedChartInfos(e){var T;const{fieldInfos:t,fieldName:s,formattedAttributes:n,chartType:r,value:o}=e,c=[],d=gn(s),{layerId:h,fieldName:u}=d,p=(T=this.relatedInfos)==null?void 0:T.get(h.toString());if(!p)return c;const{relatedFeatures:g,relation:f}=p;if(!f||!g)return c;const{cardinality:y}=f;return g.forEach(C=>{const{attributes:P}=C;P&&Object.keys(P).forEach(D=>{D===u&&c.push(this._getChartOption({value:o,attributes:P,formattedAttributes:n,fieldName:s,chartType:r,relatedFieldName:D,fieldInfos:t}))})}),y==="one-to-many"||y==="many-to-many"?c:[c[0]]}_getTooltip({label:e,value:t,chartType:s}){return s==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var ee;const{value:t,attributes:s,formattedAttributes:n,expressionAttributes:r,fieldName:o,relatedFieldName:c,fieldInfos:d,chartType:h}=e,{layer:u,fieldInfoMap:p}=this,{normalizeField:g,tooltipField:f}=t,y=g?Qe(g)?s[gn(g).fieldName]:s[g]:null,T=Dn(o)&&r&&r[o]!==void 0?r[o]:c&&s[c]!==void 0?s[c]:s[o]!==void 0?s[o]:n[o],C=new uc({fieldName:o,value:T===void 0?null:T&&y?T/y:T});if(Qe(o)){const W=p.get(o.toLowerCase()),me=p.get(f.toLowerCase()),It=(W==null?void 0:W.fieldName)??o,Ct=n[(me==null?void 0:me.fieldName)??f]??(W==null?void 0:W.label)??(W==null?void 0:W.fieldName)??c,zt=n[It];return C.tooltip=this._getTooltip({label:Ct,value:zt,chartType:h}),C}const P=ua(d,o),D=Pi(o,u),L=f&&n[f]!==void 0?n[f]:da(P||new Zo({fieldName:D}),(ee=this.popupTemplate)==null?void 0:ee.expressionInfos),B=n[D];return C.tooltip=this._getTooltip({label:L,value:B,chartType:h}),C}};a([l()],Y.prototype,"abilities",void 0),a([pe("abilities")],Y.prototype,"castAbilities",null),a([l()],Y.prototype,"activeMediaInfoIndex",void 0),a([l({readOnly:!0})],Y.prototype,"activeMediaInfo",null),a([l()],Y.prototype,"attributes",void 0),a([l()],Y.prototype,"description",void 0),a([l()],Y.prototype,"fieldInfoMap",void 0),a([l()],Y.prototype,"formattedAttributes",void 0),a([l()],Y.prototype,"expressionAttributes",void 0),a([l({readOnly:!0})],Y.prototype,"formattedMediaInfos",null),a([l()],Y.prototype,"layer",void 0),a([l({readOnly:!0})],Y.prototype,"formattedMediaInfoCount",null),a([l()],Y.prototype,"mediaInfos",void 0),a([l()],Y.prototype,"popupTemplate",void 0),a([l()],Y.prototype,"relatedInfos",void 0),a([l()],Y.prototype,"title",void 0),Y=a([I("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Y);const Dt=Y;var Nr=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Rh=[].concat(Nr.slice(30,39),Nr.slice(28,30).reverse()),Sh=[{name:"default",colors:Rh},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const zr="en-us",qn=new Map([["ar",()=>w(()=>import("./ar-7e4d7001.js"),["assets/ar-7e4d7001.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.a)],["bg-bg",()=>w(()=>import("./bg_BG-fa0eaeae.js"),["assets/bg_BG-fa0eaeae.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["bs-ba",()=>w(()=>import("./bs_BA-4f949e9b.js"),["assets/bs_BA-4f949e9b.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["ca-es",()=>w(()=>import("./ca_ES-ac250c21.js"),["assets/ca_ES-ac250c21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["cs-cz",()=>w(()=>import("./cs_CZ-41aa2dde.js"),["assets/cs_CZ-41aa2dde.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["da-dk",()=>w(()=>import("./da_DK-3cc83778.js"),["assets/da_DK-3cc83778.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-de",()=>w(()=>import("./de_DE-7cf156b8.js"),["assets/de_DE-7cf156b8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-ch",()=>w(()=>import("./de_CH-b40119c2.js"),["assets/de_CH-b40119c2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["el-gr",()=>w(()=>import("./el_GR-f5b4e421.js"),["assets/el_GR-f5b4e421.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-us",()=>w(()=>import("./en_US-b653138f.js"),["assets/en_US-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-ca",()=>w(()=>import("./en_CA-b653138f.js"),["assets/en_CA-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["es-es",()=>w(()=>import("./es_ES-21713ea8.js"),["assets/es_ES-21713ea8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["et-ee",()=>w(()=>import("./et_EE-7e4a5525.js"),["assets/et_EE-7e4a5525.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["fi-fi",()=>w(()=>import("./fi_FI-9ff24319.js"),["assets/fi_FI-9ff24319.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["fr-fr",()=>w(()=>import("./fr_FR-51c37695.js"),["assets/fr_FR-51c37695.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["he-il",()=>w(()=>import("./he_IL-5c441159.js"),["assets/he_IL-5c441159.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hr-hr",()=>w(()=>import("./hr_HR-f42ffa87.js"),["assets/hr_HR-f42ffa87.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hu-hu",()=>w(()=>import("./hu_HU-5fba6ab9.js"),["assets/hu_HU-5fba6ab9.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["id-id",()=>w(()=>import("./id_ID-981fbb86.js"),["assets/id_ID-981fbb86.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["it-it",()=>w(()=>import("./it_IT-c635b784.js"),["assets/it_IT-c635b784.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["ja-jp",()=>w(()=>import("./ja_JP-e2cf7b21.js"),["assets/ja_JP-e2cf7b21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.j)],["ko-kr",()=>w(()=>import("./ko_KR-32aae4f2.js"),["assets/ko_KR-32aae4f2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.k)],["lt-lt",()=>w(()=>import("./lt_LT-3c0b9d54.js"),["assets/lt_LT-3c0b9d54.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["lv-lv",()=>w(()=>import("./lv_LV-c1cc4a4c.js"),["assets/lv_LV-c1cc4a4c.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["nb-no",()=>w(()=>import("./nb_NO-5958d98d.js"),["assets/nb_NO-5958d98d.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["nl-nl",()=>w(()=>import("./nl_NL-004b20fd.js"),["assets/nl_NL-004b20fd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["pl-pl",()=>w(()=>import("./pl_PL-d6d01c5e.js"),["assets/pl_PL-d6d01c5e.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-br",()=>w(()=>import("./pt_BR-a08a6ce1.js"),["assets/pt_BR-a08a6ce1.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-pt",()=>w(()=>import("./pt_PT-d532c840.js"),["assets/pt_PT-d532c840.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["ro-ro",()=>w(()=>import("./ro_RO-e4007f77.js"),["assets/ro_RO-e4007f77.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["ru-ru",()=>w(()=>import("./ru_RU-905ac2e8.js"),["assets/ru_RU-905ac2e8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["sk-sk",()=>w(()=>import("./sk_SK-cae815ce.js"),["assets/sk_SK-cae815ce.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sl-sl",()=>w(()=>import("./sl_SL-50353bbe.js"),["assets/sl_SL-50353bbe.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sr-rs",()=>w(()=>import("./sr_RS-9a9b8450.js"),["assets/sr_RS-9a9b8450.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sv-se",()=>w(()=>import("./sv_SE-346c1643.js"),["assets/sv_SE-346c1643.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["th-th",()=>w(()=>import("./th_TH-210af5ed.js"),["assets/th_TH-210af5ed.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["tr-tr",()=>w(()=>import("./tr_TR-855c517f.js"),["assets/tr_TR-855c517f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["uk-ua",()=>w(()=>import("./uk_UA-7de21af4.js"),["assets/uk_UA-7de21af4.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.u)],["vi-vn",()=>w(()=>import("./vi_VN-f87f03fa.js"),["assets/vi_VN-f87f03fa.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.v)],["zh-cn",()=>w(()=>import("./zh_Hans-79f10982.js"),["assets/zh_Hans-79f10982.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-hk",()=>w(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-tw",()=>w(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)]]);function Lh(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const s of qn.keys())if(s.startsWith(e)){t=s;break}return t}function Dh(i){return i?qn.has(i.toLowerCase())?i.toLowerCase():Lh(i)||zr:zr}let Ht,di;async function Oh(i=Ec()){if(i=Dh(i),Ht&&i===di)return Ht;Ht=w(()=>import("./index-3c8f1bc3.js"),["assets/index-3c8f1bc3.js","assets/_commonjsHelpers-a430e9ea.js"]).then(e=>e.i),di=i;try{const[e,t]=await Promise.all([Ht,qn.get(di)()]);di===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return Ht=null,di=null,null}return Ht}function Vh(i,e="default"){const t=Sh.find(s=>s.name===e);return t?t.colors.map(s=>i.color(s)):null}const G={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},Ns=.05,zs=.95,Bs=15,Ne="color",tt="tooltip",hi="value",Br="default-line-value";let de=class extends ne{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new Dt,this.messages=null,this._getChartDependencies=async s=>{const n=await Oh(),{destroyed:r,viewModel:o}=this;if(r||!o||!s)return;const{activeMediaInfo:c}=o,d=await this._getRendererColors(n);this._renderChart({chartDiv:s,mediaInfo:c,chartsModule:n,colorMap:d})}}initialize(){this._featureElementInfo=new bs,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),O),v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),O)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return m("div",{bind:this,class:G.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?m("div",{key:"media-element-container",class:G.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:s,formattedMediaInfoCount:n}=this.viewModel,{value:r,refreshInterval:o,altText:c,title:d,type:h}=e,{sourceURL:u,linkURL:p}=r,g=ca(p)?"_blank":"_self",f=g==="_blank"?"noreferrer":"",y=o?t:null,T=y?y.timestamp:0,C=y?y.sourceURL:u,P=m("img",{alt:c||d,key:`media-${h}-${s}-${n}-${T}`,src:C});return(p?m("a",{title:d,href:p,rel:f,target:g},P):null)||P}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:s}=this.viewModel;return m("div",{key:`media-${e.type}-${t}-${s}`,bind:this,class:G.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?m("div",{key:"media-title",class:G.mediaItemTitle,innerHTML:e.title}):null,s=e.caption?m("div",{key:"media-caption",class:G.mediaItemCaption,innerHTML:e.caption}):null;return m("div",{key:"media-container",class:G.mediaItemContainer},m("div",{key:"media-item-container",class:G.mediaItem},this.renderMediaInfoType()),t,s)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",s=t?this.messages.previous:this.messages.next,n=t?this.classes(G.mediaButton,G.mediaPrevious):this.classes(G.mediaButton,G.mediaNext),r=t?this.classes(G.mediaIcon,G.mediaPreviousIconLTR,G.iconLeftTriangleArrow):this.classes(G.mediaIcon,G.mediaNextIconLTR,G.iconRightTriangleArrow),o=t?this.classes(G.mediaIcon,G.mediaPreviousIconRTL,G.iconRightTriangleArrow):this.classes(G.mediaIcon,G.mediaNextIconRTL,G.iconLeftTriangleArrow),c=t?"media-previous":"media-next",d=t?this._previous:this._next;return m("button",{type:"button",key:c,title:s,"aria-label":s,tabIndex:0,class:n,bind:this,onclick:d},m("span",{"aria-hidden":"true",class:r}),m("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var c,d;const{am4core:t}=e,s=new Map,n=(d=(c=this.viewModel)==null?void 0:c.layer)==null?void 0:d.renderer,r="default";if(!n)return s;const o=await yh(n);return o.delete(r),Array.from(o.values()).every(h=>(h==null?void 0:h.length)===1)&&(s.set(Br,t.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach(h=>{h&&s.set(h,t.color(o.get(h)[0].toCss(!0)))})),s}_handleMediaKeyup(e){const t=Ft(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:s,chartDiv:n,mediaInfo:r,colorMap:o}=e,{value:c,type:d}=r,{am4core:h}=s,u=Vh(h);function p(y){y instanceof h.ColorSet&&u&&(y.list=u)}ds()&&h.useTheme(s.am4themes_dark);const g=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!g.matches?h.useTheme(s.am4themes_animated):h.unuseTheme(s.am4themes_animated),h.useTheme(p);const f=d==="pie-chart"?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",r.altText||r.title),f.data=c.series.map(y=>({[tt]:y.tooltip,[hi]:y.value,[Ne]:o.get(y.fieldName)})).filter(y=>d!=="pie-chart"||y.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:s}=e,{am4core:n,am4charts:r}=s,o=n.create(t,r.PieChart);o.rtl=Oe(this.container);const c=o.series.push(new r.PieSeries);return c.labels.template.disabled=!0,c.ticks.template.disabled=!0,c.dataFields.value=hi,c.dataFields.category=tt,this._customizeChartTooltip(c.tooltip,n),c.slices.template.propertyFields.fill=Ne,c.slices.template.propertyFields.stroke=Ne,o}_getMinSeriesValue(e){let t=0;return e.forEach(s=>t=Math.min(s.value,t)),t}_createColumnChart(e,t){const{chartsModule:s,mediaInfo:n}=t,{value:r}=n,{am4core:o,am4charts:c}=s,d=e.xAxes.push(new c.CategoryAxis);d.dataFields.category=tt,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,o),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dy=-d.tooltip.contentHeight});const h=e.yAxes.push(new c.ValueAxis),u=h.renderer.labels.template;h.renderer.minLabelPosition=Ns,h.renderer.maxLabelPosition=zs,h.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(h.tooltip,o),u.wrap=!0;const p=e.series.push(new c.ColumnSeries);p.dataFields.valueY=hi,p.dataFields.categoryX=tt,p.columns.template.propertyFields.fill=Ne,p.columns.template.propertyFields.stroke=Ne,e.cursor=new c.XYCursor,r.series.length>Bs&&(e.scrollbarX=new o.Scrollbar)}_createBarChart(e,t){const{chartsModule:s,mediaInfo:n}=t,{value:r}=n,{am4core:o,am4charts:c}=s,d=e.yAxes.push(new c.CategoryAxis);d.dataFields.category=tt,d.renderer.inversed=!0,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,o),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dx=d.tooltip.contentWidth});const h=e.xAxes.push(new c.ValueAxis),u=h.renderer.labels.template;h.renderer.minLabelPosition=Ns,h.renderer.maxLabelPosition=zs,h.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(h.tooltip,o),u.wrap=!0;const p=e.series.push(new c.ColumnSeries);p.dataFields.valueX=hi,p.dataFields.categoryY=tt,p.columns.template.propertyFields.fill=Ne,p.columns.template.propertyFields.stroke=Ne,e.cursor=new c.XYCursor,r.series.length>Bs&&(e.scrollbarY=new o.Scrollbar)}_createLineChart(e,t){const{chartsModule:s,mediaInfo:n,colorMap:r}=t,{value:o}=n,{am4core:c,am4charts:d}=s,h=e.xAxes.push(new d.CategoryAxis);h.dataFields.category=tt,h.renderer.labels.template.disabled=!0,this._customizeChartTooltip(h.tooltip,c),h.tooltip.events.on("sizechanged",()=>{h.tooltip.dy=-h.tooltip.contentHeight});const u=e.yAxes.push(new d.ValueAxis),p=u.renderer.labels.template;u.renderer.minLabelPosition=Ns,u.renderer.maxLabelPosition=zs,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,c),p.wrap=!0;const g=e.series.push(new d.LineSeries);g.dataFields.categoryX=tt,g.dataFields.valueY=hi,g.strokeWidth=1;const f=r.get(Br);f&&(g.stroke=f);const y=g.bullets.push(new d.CircleBullet);y.propertyFields.fill=Ne,y.propertyFields.stroke=Ne,e.cursor=new d.XYCursor,o.series.length>Bs&&(e.scrollbarX=new c.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:s,mediaInfo:n}=e,{type:r}=n,{am4core:o,am4charts:c}=s,d=o.create(t,c.XYChart);return d.rtl=Oe(this.container),r==="column-chart"&&this._createColumnChart(d,e),r==="bar-chart"&&this._createBarChart(d,e),r==="line-chart"&&this._createLineChart(d,e),d}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:s}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(s.sourceURL);const r=setInterval(()=>{this._updateMediaInfoTimestamp(s.sourceURL)},n);this._refreshTimer=r}_getImageSource(e,t){const s=e.includes("?")?"&":"?",[n,r=""]=e.split("#");return`${n}${s}timestamp=${t}${r?"#":""}${r}`}};a([l()],de.prototype,"attributes",null),a([l()],de.prototype,"activeMediaInfoIndex",null),a([l()],de.prototype,"description",null),a([l()],de.prototype,"fieldInfoMap",null),a([l()],de.prototype,"layer",null),a([l()],de.prototype,"mediaInfos",null),a([l()],de.prototype,"popupTemplate",null),a([l()],de.prototype,"relatedInfos",null),a([l()],de.prototype,"title",null),a([l({type:Dt})],de.prototype,"viewModel",void 0),a([l(),se("esri/widgets/Feature/t9n/Feature")],de.prototype,"messages",void 0),de=a([I("esri.widgets.Feature.FeatureMedia")],de);const ya=de,Nh=["$datastore","$map","$layer","$aggregatedfeatures"],zh="esri.widgets.Feature.support.arcadeFeatureUtils",Bh=R.getLogger(zh);function qh(i){return typeof i=="string"?Li(Vn(i)):Array.isArray(i)?Uh(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?Hh(i):i}function Uh(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?Li(Vn(e)):e}</li>`).join("")}</ul>`}function Hh(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?Li(Vn(t)):t}</td></tr>`}).join("")}</table>`}function Gh({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:s,viewInfo:n,map:r,graphic:o,interceptor:c}){t.forEach(d=>{const h=d.toLowerCase(),u={map:r,spatialReference:n.sr,interceptor:c};if(h==="$map"&&(s.vars[h]=e.convertMapToFeatureSetCollection(u)),h==="$layer"&&(s.vars[h]=e.convertFeatureLayerToFeatureSet({layer:o.sourceLayer,spatialReference:n.sr,interceptor:c})),h==="$datastore"&&(s.vars[h]=e.convertServiceUrlToWorkspace({url:o.sourceLayer.url,spatialReference:n.sr,interceptor:c})),h==="$aggregatedfeatures"){const p=o.layer,{fields:g,objectIdField:f,geometryType:y,spatialReference:T,displayField:C}=p,P=new xc({fields:g,objectIdField:f,geometryType:y,spatialReference:T,displayField:C,...p.type==="feature"?{templates:p.templates,typeIdField:p.typeIdField,types:p.types}:null,source:i});s.vars[h]=e.convertFeatureLayerToFeatureSet({layer:P,spatialReference:n.sr,interceptor:c})}})}function va(){return w(()=>import("./arcadeUtils-93ccece7.js").then(i=>i.ay),["assets/arcadeUtils-93ccece7.js","assets/geometry-4b789d90.js","assets/ensureType-fa162cfc.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/Error-bd05b442.js","assets/Extent-7f29a1bb.js","assets/cast-daef7652.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/preload-helper-101896b7.js","assets/number-8b20c6e8.js","assets/locale-30120714.js","assets/Field-0ac3c9d2.js","assets/enumeration-e46f3fd4.js","assets/fieldType-4ec45634.js","assets/jsonUtils-8bd548d9.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/request-c2b0ab45.js","assets/unitUtils-43365914.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/sizeVariableUtils-d4870b0d.js"])}function Wh(i){return"createQuery"in i&&"queryFeatures"in i}async function jh({graphic:i,view:e}){const{isAggregate:t,layer:s}=i;if(!t||!s||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(s);if(!Wh(n))return[];const r=n.createQuery();r.aggregateIds=[i.getObjectId()];const{features:o}=await n.queryFeatures(r);return o}async function wa({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:s,map:n,graphic:r,view:o}){if(!i||!i.expression)return null;const c=e.createSyntaxTree(i.expression),d=Nh.filter(f=>e.hasVariable(c,f)),[h]=await Promise.all([jh({graphic:r,view:o}),e.loadScriptDependencies(c,!0,d)]),u=e.getViewInfo({spatialReference:s}),p=e.createExecContext(r,u);p.interceptor=t,p.useAsync=!0,Gh({aggregatedFeatures:h,arcadeUtils:e,featureSetVars:d,context:p,viewInfo:u,map:n,graphic:r,interceptor:t});const g=e.createFunction(c,p);return e.executeAsyncFunction(g,p).catch(f=>Bh.error("arcade-execution-error",{error:f,graphic:r,expressionInfo:i}))}async function Zh({expressionInfos:i,spatialReference:e,graphic:t,interceptor:s,map:n,view:r}){if(!i||!i.length)return{};const o=await va(),c={};for(const u of i)c[`expression/${u.name}`]=wa({expressionInfo:u,arcadeUtils:o,interceptor:s,spatialReference:e,map:n,graphic:t,view:r});const d=await bt(c),h={};for(const u in d)h[u]=qh(d[u].value);return h}const Kh=1;let fe=class extends vs(S){constructor(i){super(i),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:e}=this;e&&e.abort(),this._abortController=null},this._createVM=()=>{var s,n;const e=(s=this.contentElement)==null?void 0:s.type;(n=this.contentElementViewModel)==null||n.destroy();const t=e==="fields"?new Ms:e==="media"?new Dt:e==="text"?new cs:null;this._set("contentElementViewModel",t)},this._compile=async()=>{this._cancelQuery();const e=new AbortController;this._abortController=e,await this._compileExpression(),this._abortController===e&&(this._abortController=null)},this._compileThrottled=si(this._compile,Kh,this),this._compileExpression=async()=>{const{expressionInfo:e,graphic:t,interceptor:s,spatialReference:n,map:r,view:o,_abortController:c}=this;if(!(e&&t&&n&&r))return void this._set("contentElement",null);const d=await va();if(c!==this._abortController)return;const h=await wa({arcadeUtils:d,expressionInfo:e,graphic:t,interceptor:s,map:r,spatialReference:n,view:o});if(!h||h.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const u=await h.castAsJsonAsync(c.signal),p=u==null?void 0:u.type,g=p==="media"?pc.fromJSON(u):p==="text"?Ko.fromJSON(u):p==="fields"?mc.fromJSON(u):null;this._set("contentElement",g)},this.handles.add([v(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),O),v(()=>[this.contentElement],()=>this._createVM(),O)])}destroy(){var i;this._cancelQuery(),(i=this.contentElementViewModel)==null||i.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get state(){const{_abortController:i,contentElement:e,contentElementViewModel:t}=this;return i?"loading":e||t?"ready":"disabled"}get map(){var i;return((i=this.view)==null?void 0:i.map)??null}set map(i){this._override("map",i)}};a([l()],fe.prototype,"_abortController",void 0),a([l({type:gc})],fe.prototype,"expressionInfo",void 0),a([l({type:Nt})],fe.prototype,"graphic",void 0),a([l({readOnly:!0})],fe.prototype,"contentElement",void 0),a([l({readOnly:!0})],fe.prototype,"contentElementViewModel",void 0),a([l()],fe.prototype,"interceptor",void 0),a([l()],fe.prototype,"spatialReference",null),a([l({readOnly:!0})],fe.prototype,"state",null),a([l()],fe.prototype,"map",null),a([l()],fe.prototype,"view",void 0),fe=a([I("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],fe);const Un=fe,Vi={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let Wi=class extends ne{constructor(e,t){super(e,t),this.viewModel=new Un}initialize(){this.addHandles(v(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),O))}destroy(){this._destroyContentWidget()}renderLoading(){return m("div",{key:"loading-container",class:Vi.loadingSpinnerContainer},m("span",{class:this.classes(Vi.iconLoading,Vi.spinner)}))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:Vi.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,s=t==null?void 0:t.type;this._destroyContentWidget();const n=e?s==="fields"?new _a({viewModel:e}):s==="media"?new ya({viewModel:e}):s==="text"?new Gi({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};a([l({type:Un})],Wi.prototype,"viewModel",void 0),Wi=a([I("esri.widgets.Feature.FeatureExpression")],Wi);const Yh=Wi,qs=100;let N=class extends Bo(Qo(vs(S))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await Ti(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await Ti(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await Ti(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=si(this._queryController,qs,this),this._queryFeatureCountThrottled=si(this._queryFeatureCountController,qs,this),this._queryPageThrottled=si(this._queryPageController,qs,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:s}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,s.removeAll(),s.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([v(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),O),v(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),v(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:s}=this,n=1,r=Math.ceil(s/t)||1;this._set("featurePage",Math.min(Math.max(e,n),r))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(s=>{const n=s.clone(),r=Pi(s.field,t);return n.field=r,n}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new H}get relatedLayer(){const{layer:e,map:t,relationship:s}=this;return e!=null&&e.loaded?Ud(t,e,s):null}get relationship(){var s;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((s=t==null?void 0:t.relationships)==null?void 0:s.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new H}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:s,graphic:n,relatedLayer:r}=this;return t?"loading":e||s?"querying":n&&r?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var u,p,g,f;const{layer:e,relatedLayer:t,relationshipId:s,objectId:n,_queryFeatureCountAbortController:r}=this;if(await(e==null?void 0:e.load()),!t||typeof n!="number"||!((p=(u=e==null?void 0:e.capabilities)==null?void 0:u.queryRelated)!=null&&p.supportsCount))return void this._set("featureCount",0);await t.load();const o=t.createQuery(),c=((f=(g=e.capabilities)==null?void 0:g.queryRelated)==null?void 0:f.supportsCacheHint)??!1,d=new on({cacheHint:c,relationshipId:s,returnGeometry:!1,objectIds:[n],where:o.where}),h=await e.queryRelatedFeaturesCount(d,{signal:r==null?void 0:r.signal});this._set("featureCount",h[n]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:s}=this;return t?e:s?e.slice(0,s):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:s,_queryPageAbortController:n}=this;!s||t<2||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var W,me,It,Ct,zt;const{orderByFieldsFixedCasing:t,showAllEnabled:s,featuresPerPage:n,displayCount:r,layer:o,relationshipId:c,featurePage:d,featureCount:h,relatedLayer:u}=this;await(o==null?void 0:o.load());const{relationship:p,objectId:g}=this;if(!p||typeof g!="number"||!((me=(W=o==null?void 0:o.capabilities)==null?void 0:W.queryRelated)!=null&&me.supportsPagination))return[];const f=s?((d-1)*n+h)%h:0,y=s?n:r;if(!u)return[];await u.load();const T=u.objectIdField,C=[...t==null?void 0:t.map(Ce=>Ce.field),T],P=t==null?void 0:t.map(Ce=>`${Ce.field} ${Ce.order}`),D=((Ct=(It=o.capabilities)==null?void 0:It.queryRelated)==null?void 0:Ct.supportsCacheHint)||!1,L=u.createQuery(),B=new on({orderByFields:P,start:f,num:y,outFields:C,cacheHint:D,relationshipId:c,returnGeometry:!1,objectIds:[g],where:L.where}),ee=((zt=(await o.queryRelatedFeatures(B,{signal:e==null?void 0:e.signal}))[g])==null?void 0:zt.features)||[];return ee.forEach(Ce=>Ce.sourceLayer=u),ee}};a([l()],N.prototype,"_queryAbortController",void 0),a([l()],N.prototype,"_queryPageAbortController",void 0),a([l()],N.prototype,"_queryFeatureCountAbortController",void 0),a([l({value:1})],N.prototype,"featurePage",null),a([l()],N.prototype,"featuresPerPage",void 0),a([l({readOnly:!0})],N.prototype,"orderByFieldsFixedCasing",null),a([l()],N.prototype,"description",void 0),a([l({readOnly:!0})],N.prototype,"itemDescriptionFieldName",null),a([l({value:3})],N.prototype,"displayCount",null),a([l({type:Nt})],N.prototype,"graphic",void 0),a([l()],N.prototype,"layer",void 0),a([l()],N.prototype,"map",void 0),a([l({readOnly:!0})],N.prototype,"objectId",null),a([l({readOnly:!0})],N.prototype,"objectIdField",null),a([l()],N.prototype,"orderByFields",void 0),a([l({readOnly:!0})],N.prototype,"relatedFeatures",null),a([l({readOnly:!0})],N.prototype,"relatedLayer",null),a([l({readOnly:!0})],N.prototype,"relationship",null),a([l({readOnly:!0})],N.prototype,"featureCount",void 0),a([l({readOnly:!0})],N.prototype,"relatedFeatureViewModels",null),a([l()],N.prototype,"relationshipId",void 0),a([l()],N.prototype,"showAllEnabled",void 0),a([l({readOnly:!0})],N.prototype,"state",null),a([l()],N.prototype,"title",void 0),N=a([I("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],N);const Hn=N,ze={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},qr={title:!0,description:!0};let oe=class extends ne{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([s])=>{s!=null&&s.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new Hn,this.messages=null,this.messagesCommon=null,this.visibleElements={...qr},this._increaseFeaturePage=()=>{const{state:s,showAllEnabled:n,relatedFeatures:r,featuresPerPage:o,featurePage:c}=this.viewModel;s==="ready"&&n&&r.length>=o*c&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new bs,this.addHandles([v(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),O),v(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),xe(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([w(()=>import("./calcite-list-90050e8d.js"),["assets/calcite-list-90050e8d.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/interactive-52dcf836.js"]),w(()=>import("./calcite-list-item-fe342bd9.js"),["assets/calcite-list-item-fe342bd9.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/conditionalSlot-711e482d.js","assets/observers-73b5e0ed.js","assets/interactive-52dcf836.js"]),w(()=>import("./calcite-icon-ac6b684b.js"),["assets/calcite-icon-ac6b684b.js","assets/icon-de53a9d7.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/observers-73b5e0ed.js"]),w(()=>import("./calcite-notice-f1b46e02.js"),["assets/calcite-notice-f1b46e02.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/conditionalSlot-711e482d.js","assets/observers-73b5e0ed.js","assets/icon-de53a9d7.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=le(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:s}=this.viewModel;return!e&&(t>s||s===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return De(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...qr,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?m("div",{key:"sticky-loader",class:ze.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return m("span",{class:this.classes(ze.iconLoading,ze.spinner)})}renderLoading(){return m("div",{key:"loading-container",class:ze.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return m("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=Oe(this.container)?"chevron-left":"chevron-right";return m("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var r,o;const{itemDescriptionFieldName:t}=this.viewModel,s=e.title;e.description=t&&((r=e.formattedAttributes)==null?void 0:r.global[t]);const n=e.state==="loading";return m("calcite-list-item",{key:e.uid,label:n?`${(o=this.messagesCommon)==null?void 0:o.loading}`:s,description:n?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?m("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return m("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return m("div",{key:"feature-observer",class:ze.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return m("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return m("div",{key:"list-container",class:this.classes(ze.listContainer,{[ze.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return m("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:this.classes(ze.base,ze.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(s=>{this.addHandles(v(()=>[s.title,s.state],()=>this.scheduleRender(),O),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,s=t.description&&this.description,n=t.title&&this.title;this._featureElementInfo.set({description:s,title:n,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await An(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};a([l()],oe.prototype,"_relatedFeatureIntersectionObserverNode",void 0),a([l({readOnly:!0})],oe.prototype,"displayShowAllButton",null),a([l({readOnly:!0})],oe.prototype,"displayListItems",null),a([l()],oe.prototype,"description",null),a([l({readOnly:!0})],oe.prototype,"featureCountDescription",null),a([l()],oe.prototype,"headingLevel",void 0),a([l()],oe.prototype,"title",null),a([l({type:Hn})],oe.prototype,"viewModel",void 0),a([l(),se("esri/widgets/Feature/t9n/Feature")],oe.prototype,"messages",void 0),a([l(),se("esri/t9n/common")],oe.prototype,"messagesCommon",void 0),a([l()],oe.prototype,"visibleElements",void 0),a([pe("visibleElements")],oe.prototype,"castVisibleElements",null),oe=a([I("esri.widgets.Feature.FeatureRelationship")],oe);const Ur=oe;let Qh=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=s=>{}),this.preRequestCallback||(this.preLayerQueryCallback=s=>{})}};var wi;const Xh=1,Hr="content-view-models",Gr="relationship-view-models",Wr={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let q=wi=class extends Qo(S){constructor(i){super(i),this._handles=new Je,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=si(this._graphicChanged,Xh,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...Wr},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(v(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),O))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return M(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return Ld(Ar(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return la(this.graphic)}castAbilities(i){return{...Wr,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof Dt&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof Dt&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof Dt&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){So(t)||(this._error=t,R.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new Ko({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(Gr),(e=this._handles)==null||e.remove(Hr),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var n;const t=(n=i==null?void 0:i.graphic)==null?void 0:n.getObjectId(),s=e==null?void 0:e.getObjectId();return M(t)&&M(s)&&t===s}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(s=>{i.find(n=>this._matchesFeature(n,s))||i.add(new wi({abilities:{relationshipContent:!1},map:t,graphic:s}))}),i.forEach(s=>{(e==null?void 0:e.find(r=>this._matchesFeature(s,r)))||i.remove(s)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:s,contentElementViewModel:n}=i,r=s==null?void 0:s.type;n&&r&&(r==="fields"&&(this._createFieldsFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createFieldsVMParams(s,e))),r==="media"&&(this._createMediaFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createMediaVMParams(s,e))),r==="text"&&n.set(this._createTextVMParams(s)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:s,relationshipId:n,title:r,description:o}=i,{_sourceLayer:c,graphic:d,map:h}=this,u=new Hn({displayCount:t,graphic:d,orderByFields:s,relationshipId:n,layer:c,map:h,...this._compileTitleAndDesc({title:r,description:o})});return this.contentViewModels[e]=u,this._handles.add(xe(()=>u.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(u)),Gr),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:s,map:n,spatialReference:r,view:o}=this,c=new Un({expressionInfo:t,graphic:s,interceptor:wi.interceptor,map:n,spatialReference:r,view:o});return this.contentViewModels[e]=c,this._handles.add(v(()=>c.contentElementViewModel,()=>this._setExpressionContentVM(c,e),O),Hr),i}_compileAttachments(i,e){const{graphic:t}=this,{description:s,title:n}=i;return this.contentViewModels[e]=new zn({graphic:t,...this._compileTitleAndDesc({title:n,description:s})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:s,destroyer:n}=i;return this.contentViewModels[e]=new cs({graphic:t,creator:s,destroyer:n}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:s,graphic:n,formattedAttributes:r,_expressionAttributes:o}=this,{attributes:c}=n,d=r.global;return{title:Lt({attributes:c,fieldInfoMap:t,globalAttributes:d,expressionAttributes:o,layer:s,text:i}),description:Lt({attributes:c,fieldInfoMap:t,globalAttributes:d,expressionAttributes:o,layer:s,text:e})}}_createFieldsVMParams(i,e){var h;const{_effectivePopupTemplate:t,formattedAttributes:s}=this,n={...s.global,...s.content[e]},r=(h=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:h.filter(({fieldName:u})=>Dn(u)||Qe(u)||n.hasOwnProperty(u)),o=t==null?void 0:t.expressionInfos,{description:c,title:d}=i;return{attributes:n,expressionInfos:o,fieldInfos:r,...this._compileTitleAndDesc({title:d,description:c})}}_compileFields(i,e){const t=i.clone(),s=new Ms(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=s,t.fieldInfos=s.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:s,_fieldInfoMap:n,formattedAttributes:r,_effectivePopupTemplate:o,relatedInfos:c,_sourceLayer:d,_expressionAttributes:h}=this,{attributes:u}=s,{description:p,mediaInfos:g,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:u,layer:d,fieldInfoMap:n,formattedAttributes:{...r.global,...r.content[e]},expressionAttributes:h,mediaInfos:g,popupTemplate:o,relatedInfos:c,...this._compileTitleAndDesc({title:f,description:p})}}_compileMedia(i,e){const t=i.clone(),s=new Dt(this._createMediaVMParams(i,e));return t.mediaInfos=s.formattedMediaInfos.slice(0),this.contentViewModels[e]=s,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:s,_expressionAttributes:n}=this;if(i&&i.text){const{attributes:r}=e,o=this.formattedAttributes.global;i.text=Lt({attributes:r,fieldInfoMap:t,globalAttributes:o,expressionAttributes:n,layer:s,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new cs(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:s}=i,n=e==null?void 0:e.editFieldsInfo;return s&&n?Sd(n,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:s,_expressionAttributes:n}=this,{attributes:r}=s,o=this.formattedAttributes.global;return Lt({attributes:r,fieldInfoMap:e,globalAttributes:o,expressionAttributes:n,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return ls(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return ls(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:s,_effectivePopupTemplate:n,spatialReference:r,map:o,view:c}=this;if(e!==this._featureAbortController||!s)return;await Vd({graphic:s,popupTemplate:n,layer:t,spatialReference:r},i);const{content:{value:d},title:{value:h}}=await bt({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:u}}=await bt({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:Zh({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:r,graphic:s,map:o,interceptor:wi.interceptor,view:c})});e===this._featureAbortController&&s&&(this._expressionAttributes=u,this._graphicExpressionAttributes={...s.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(h)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:s,graphic:n,relatedInfos:r,_sourceLayer:o,_fieldInfoMap:c,_graphicExpressionAttributes:d}=this;t.content[e]=Ls({fieldInfos:s==null?void 0:s.fieldInfos,graphic:n,attributes:{...d,...i.attributes},layer:o,fieldInfoMap:c,relatedInfos:r})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:s,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:o,_graphicExpressionAttributes:c}=this;t.content[e]=Ls({fieldInfos:i.fieldInfos,graphic:s,attributes:{...c,...i.attributes},layer:r,fieldInfoMap:o,relatedInfos:n})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:s,_sourceLayer:n,_fieldInfoMap:r,_graphicExpressionAttributes:o}=this,c=e==null?void 0:e.fieldInfos,d={global:Ls({fieldInfos:c,graphic:t,attributes:o,layer:n,fieldInfoMap:r,relatedInfos:s}),content:[]};return Array.isArray(i)&&i.forEach((h,u)=>{h.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:h,contentElementIndex:u,formattedAttributes:d}),h.type==="media"&&this._createMediaFormattedAttributes({contentElement:h,contentElementIndex:u,formattedAttributes:d})}),d}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,Ar(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:s,_sourceLayer:n}=this;s.clear();const r=M(n.associatedLayer)?await n.associatedLayer.load(t):n;if(!r)return;const o=e.filter(h=>h&&Qe(h.fieldName));if(!o||!o.length)return;e.forEach(h=>this._configureRelatedInfo(h,r));const c=await Ah({relatedInfos:s,layer:r},t);Object.keys(c).forEach(h=>{var g;const u=s.get(h.toString()),p=(g=c[h])==null?void 0:g.value;u&&p&&(u.layerInfo=p.data)});const d=await Ph({graphic:i,relatedInfos:s,layer:r},t);Object.keys(d).forEach(h=>{var u;Ch((u=d[h])==null?void 0:u.value,s.get(h.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,s=gn(i.fieldName);if(!s)return;const{layerId:n,fieldName:r}=s;if(!n)return;const o=t.get(n.toString())||Ih(n,e);o&&($h({relatedInfo:o,fieldName:r,fieldInfo:i}),this.relatedInfos.set(n,o))}};q.interceptor=new Qh(Bd,qd),a([l()],q.prototype,"_error",void 0),a([l()],q.prototype,"_featureAbortController",void 0),a([l({readOnly:!0})],q.prototype,"_effectivePopupTemplate",null),a([l({readOnly:!0})],q.prototype,"_fieldInfoMap",null),a([l({readOnly:!0})],q.prototype,"_sourceLayer",null),a([l()],q.prototype,"abilities",void 0),a([pe("abilities")],q.prototype,"castAbilities",null),a([l({readOnly:!0})],q.prototype,"content",void 0),a([l({readOnly:!0})],q.prototype,"contentViewModels",void 0),a([l()],q.prototype,"description",void 0),a([l({type:Boolean})],q.prototype,"defaultPopupTemplateEnabled",void 0),a([l({readOnly:!0})],q.prototype,"state",null),a([l({readOnly:!0})],q.prototype,"formattedAttributes",void 0),a([l({type:Nt,value:null})],q.prototype,"graphic",null),a([l({readOnly:!0})],q.prototype,"lastEditInfo",void 0),a([l({readOnly:!0})],q.prototype,"relatedInfos",void 0),a([l()],q.prototype,"spatialReference",null),a([l({readOnly:!0})],q.prototype,"title",void 0),a([l()],q.prototype,"map",null),a([l({readOnly:!0})],q.prototype,"waitingForContent",null),a([l()],q.prototype,"view",void 0),q=wi=a([I("esri.widgets.FeatureViewModel")],q);const Gn=q,U={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},ba=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>qo(t)&&!t.destroyed?m("div",{class:U.contentNode,key:t},t.render()):t instanceof HTMLElement?m("div",{class:U.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):ic(t)?m("div",{class:U.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const s=this;t.appendChild(s)}};return e=a([I("esri.widgets.Feature.ContentMixin")],e),e};var fn;const jr={title:!0,content:!0,lastEditedInfo:!0},Zr="relationship-handles";let J=fn=class extends ba(ne){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...jr},this.viewModel=new Gn}initialize(){this.addHandles(v(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),O))}loadDependencies(){return w(()=>import("./calcite-notice-f1b46e02.js"),["assets/calcite-notice-f1b46e02.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/conditionalSlot-711e482d.js","assets/observers-73b5e0ed.js","assets/icon-de53a9d7.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...jr,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=m("div",{class:U.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return m("div",{class:this.classes(U.base,U.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return m("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?m("div",{key:"error-title",slot:"title"},i.errorMessage):null,m("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return m("div",{key:"loading-container",class:U.loadingSpinnerContainer},m("span",{class:this.classes(U.iconLoading,U.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?m("div",{class:U.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?m(Bn,{level:this.headingLevel,class:U.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?m("div",{class:U.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:m("div",{class:U.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:s}=e.viewModel;return t==="loading"||s.length>0?m("div",{key:this._buildKey("attachments-element",i),class:this.classes(U.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?m("div",{key:this._buildKey("relationship-element",i),class:U.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("expression-element",i),class:U.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("custom-element",e),class:U.contentElement},s.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("fields-element",i),class:U.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("media-element",i),class:U.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:s,user:n}=t,r=t.type==="edit"?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,o=De(r,{date:s,user:n});return m("div",{key:"edit-info-element",class:this.classes(U.lastEditedInfo,U.contentElement)},o)}renderText(i,e){const t=i.text,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("text-element",e),class:this.classes(U.contentElement,U.text)},s.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(Zr),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([xe(()=>i,"select-record",({featureViewModel:s})=>{e&&(s.abilities={relationshipContent:!0},e.push(new fn({flowItems:e,viewModel:s,visibleElements:t})))}),xe(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:s}=i;s.showAllEnabled=!0;const n=new Ur({visibleElements:{title:!1,description:!1},viewModel:s});this._addFeatureRelationshipHandles(n),e.push(n)})],Zr)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(t))t.forEach((n,r)=>{if(n.type==="attachments"&&(this._contentWidgets[r]=new Kd({displayType:n.displayType,headingLevel:e.title?i+1:i,viewModel:s[r]})),n.type==="fields"&&(this._contentWidgets[r]=new _a({viewModel:s[r]})),n.type==="media"&&(this._contentWidgets[r]=new ya({viewModel:s[r]})),n.type==="text"&&(this._contentWidgets[r]=new Gi({viewModel:s[r]})),n.type==="custom"&&(this._contentWidgets[r]=new Gi({viewModel:s[r]})),n.type==="expression"&&(this._contentWidgets[r]=new Yh({viewModel:s[r]})),n.type==="relationship"){const o=new Ur({viewModel:s[r]});this._addFeatureRelationshipHandles(o),this._contentWidgets[r]=o}},this);else{const n=s[0];n&&!n.destroyed&&(this._contentWidgets[0]=new Gi({viewModel:n}))}this.scheduleRender()}};a([l()],J.prototype,"graphic",null),a([l()],J.prototype,"defaultPopupTemplateEnabled",null),a([l()],J.prototype,"flowItems",void 0),a([l()],J.prototype,"headingLevel",void 0),a([l()],J.prototype,"label",null),a([l(),se("esri/widgets/Feature/t9n/Feature")],J.prototype,"messages",void 0),a([l(),se("esri/t9n/common")],J.prototype,"messagesCommon",void 0),a([l(),se("esri/widgets/support/t9n/uriUtils")],J.prototype,"messagesURIUtils",void 0),a([l()],J.prototype,"spatialReference",null),a([l({readOnly:!0})],J.prototype,"title",null),a([l()],J.prototype,"visibleElements",void 0),a([pe("visibleElements")],J.prototype,"castVisibleElements",null),a([l()],J.prototype,"map",null),a([l()],J.prototype,"view",null),a([l({type:Gn})],J.prototype,"viewModel",void 0),J=fn=a([I("esri.widgets.Feature")],J);const Jh=J;var Ma;const ji=Symbol("anchorHandles");let Et=class extends fs.EventedAccessor{constructor(e){super(e),this[Ma]=new Je,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[ji].add([Xe(()=>yi(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),v(()=>this.screenLocation,(t,s)=>{M(t)&&M(s)&&this.emit("view-change")})])}destroy(){this.view=null,this[ji]=le(this[ji])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:s}=this;return s&&M(e)&&M(t)&&t.ready?t.toScreen(e):null}};Ma=ji,a([l()],Et.prototype,"location",void 0),a([l()],Et.prototype,"screenLocation",null),a([l()],Et.prototype,"screenLocationEnabled",void 0),a([l()],Et.prototype,"view",void 0),Et=a([I("esri.widgets.support.AnchorElementViewModel")],Et);const Ia=Et,eu="esri.widgets.CompassViewModel";let Zi=class extends Ia{constructor(e){super(e),this.visible=!1}};a([l()],Zi.prototype,"visible",void 0),Zi=a([I(eu)],Zi);const Ca=Zi,Us={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let xt=class extends ne{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new Ca}initialize(){this.addHandles(v(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:s}=e;t&&(this.viewModel.location=t),this.visible=!0;const n=()=>this.hide();s&&s.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,s=!!t,n=e&&s,r=!e&&s,o={[Us.spinnerStart]:n,[Us.spinnerFinish]:r},c=this._getPositionStyles();return m("div",{class:this.classes(Us.base,o),styles:c})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=An(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if($(t)||$(e))return{};const{padding:s}=t;return{left:e.x-s.left+"px",top:e.y-s.top+"px"}}};a([l()],xt.prototype,"location",null),a([l()],xt.prototype,"view",null),a([l({type:Ca})],xt.prototype,"viewModel",void 0),a([l()],xt.prototype,"visible",null),xt=a([I("esri.widgets.Spinner")],xt);const tu=xt,iu="OBJECTID";var Kr;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(Kr||(Kr={}));const Yr=ve("android");ve("chrome")||Yr&&Yr>=4;rn();function Ta(i){return i&&"opacity"in i?i.opacity*Ta(i.parent):1}async function su(i,e){if(!i)return;const t=i.sourceLayer,s=(M(e)&&e.useSourceLayer?t:i.layer)??t,n=Ta(s);if(M(i.symbol)&&(!M(e)||e.ignoreGraphicSymbol!==!0)){const C=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:M(e)?e.webStyleCache:null}):i.symbol.clone();return As(C,null,n),C}const r=(M(e)?e.renderer:null)??(s&&"renderer"in s?s.renderer:null);let o=r&&"getSymbolAsync"in r?await r.getSymbolAsync(i,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,cache:M(e)?e.webStyleCache:null}):o.clone(),!(r&&"visualVariables"in r&&r.visualVariables&&r.visualVariables.length))return As(o,null,n),o;if("arcadeRequiredForVisualVariables"in r&&r.arcadeRequiredForVisualVariables&&($(e)||$(e.arcade))){const C={...ye(e)};C.arcade=await Yo(),e=C}const c=await w(()=>import("./UniqueValueRenderer-83bbe8b7.js").then(C=>C.v),["assets/UniqueValueRenderer-83bbe8b7.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/enumeration-e46f3fd4.js","assets/jsonMap-a9c94baf.js","assets/Extent-7f29a1bb.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/Clonable-f249bc0f.js","assets/LegendOptions-54bbb61a.js","assets/reactiveUtils-3c1b281e.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/PopupTemplate-343851b8.js","assets/number-53937715.js","assets/Identifiable-e3a09883.js","assets/jsonUtils-8bd548d9.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js"]),d=[],h=[],u=[],p=[];for(const C of r.visualVariables)switch(C.type){case"color":d.push(C);break;case"opacity":h.push(C);break;case"rotation":p.push(C);break;case"size":C.target||u.push(C)}const g=!!d.length&&d[d.length-1],f=g?c.getColor(g,i,e):null,y=!!h.length&&h[h.length-1];let T=y?c.getOpacity(y,i,e):null;if(n!=null&&(T=T!=null?T*n:n),As(o,f,T),u.length){const C=c.getAllSizes(u,i,e);await vc(o,C)}for(const C of p)wc(o,c.getRotationAngle(C,i,e),C.axis);return o}let nu=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const s in e){const n=e[s],r=new vl(n,void 0,void 0,2,2);this._properties[s]={pool:r,acquired:[]}}this._afterDispatchHandle=wl(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const s of t.acquired)tr(s)||t.pool.release(s);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),s=this._properties[e];let n=s.pool.acquire();for(s.acquired.push(n);n===t;)s.acquired.push(n),n=s.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let s=0;for(const n of t.acquired)tr(n)?t.acquired[s++]=n:t.pool.release(n);t.acquired.length=s}}};const ru=ve("mac")?"Meta":"Ctrl",Is={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)Is[i]=String.fromCharCode(i);for(let i=1;i<25;i++)Is[111+i]=`F${i}`;for(let i=65;i<91;i++)Is[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function ou(i){if(i.key!==void 0)return Ft(i);const e=Is[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function au(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let lu=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const s of this.keyModifiers)if(!t.has(s))return!1;return!0}};const Qr=R.getLogger("esri.views.input.InputHandler");let X=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const s of t)this._incomingEventMatches.push(s.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?Qr.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,s){let n;typeof t=="function"?(s=t,n=[]):n=t||[];const r=typeof e=="string"?new lu(e,n):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},c=u=>{const p=this._incoming[u.match.eventType];if(p){const g=p.indexOf(u);p.splice(g,1),o(),this._manager&&this._manager.updateDependencies()}},d=new cu(r,s,{onPause:c,onRemove:c,onResume:u=>{const p=this._incoming[u.match.eventType];p&&!p.includes(u)&&(p.push(u),o(),this._manager&&this._manager.updateDependencies())}});let h=this._incoming[r.eventType];return h||(h=[],this._incoming[r.eventType]=h),h.push(d),o(),this._manager&&this._manager.updateDependencies(),d}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new du(e,{onEmit:(s,n,r,o)=>{var c;(c=this._manager)==null||c.emit(s.eventType,n,r,o)},onRemove:s=>{var n;delete this._outgoing[s.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Qr.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var s;const t=this._incoming[e.type];if(t){for(const n of t)if(n.match.matches(e)&&((s=n.callback)==null||s.call(n,e),e.shouldStopPropagation()))break}}},cu=class{constructor(e,t,s){this.match=e,this._callback=t,this._handler=s}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},du=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,s){this._removed||this._handler.onEmit(this,e,t,s)}remove(){this._removed=!0,this._handler.onRemove(this)}},hu=class extends X{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:s,y:n}=e;t===this._value&&this._x===s&&this._y===n||(this._value=t,this._x=s,this._y=n,this._onChange(t,s,n))}},uu=class extends X{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new $c(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},Fe=class extends S{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=ru,this._latestPointerType="mouse",this._propertiesPool=new nu({latestPointerLocation:mu},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,s=yt.INTERNAL){if(this._nameToGroup[e])return void R.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void R.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const n={name:e,handlers:t.map(r=>({handler:r,active:!0,removed:!1,priorityIndex:0,groupPriority:s,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let r=n.handlers.length-1;r>=0;r--){const o=n.handlers[r];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(c,d,h,u,p)=>{this._emitInputEvent(o.priorityIndex+1,c,d,h,p,u)},setPointerCapture:(c,d)=>{this._setPointerCapture(n,o,c,d)},setEventCallback:c=>{o.eventCallback=c},setUninstallCallback:c=>{o.uninstallCallback=c},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(s=>{var n;s.removed=!0,(n=s.uninstallCallback)==null||n.call(s)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):R.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let s=this._handlers.length-1;s>=0;s--){const n=this._handlers[s];n.priorityIndex=s,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let s=this._handlersPriority.length-1;s>=0;s--){const n=this._handlersPriority[s];n.priorityIndex=s;let r=n.handler.hasSideEffects;if(!r){for(const o of n.handler.outgoingEventTypes)if(e.has(o)){r=!0;break}}if(r)for(const o of n.handler.incomingEventMatches){e.add(o.eventType);for(const c of o.keyModifiers)au(c)||t.add(c)}n.active=r}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,s){this._latestPointerType=e;const n=this._get("latestPointerLocation");if($(n)||n.x!==t||n.y!==s){const r=this._propertiesPool.get("latestPointerLocation");r.x=t,r.y=s,this._set("latestPointerLocation",r)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const r=t;this._pointerCaptures.delete(r.native.pointerId)}this._updateKeyModifiers(e,t);const s=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,s,n)}_updateKeyModifiers(e,t){if(!t)return;let s=!1;const n=()=>{if(!s){const c=new Set;this._activeKeyModifiers.forEach(d=>{c.add(d)}),this._activeKeyModifiers=c,s=!0}},r=(c,d)=>{d&&!this._activeKeyModifiers.has(c)?(n(),this._activeKeyModifiers.add(c)):!d&&this._activeKeyModifiers.has(c)&&(n(),this._activeKeyModifiers.delete(c))};if(e==="key-down"||e==="key-up"){const c=t.key;this._keyModifiers.has(c)&&r(c,e==="key-down")}const o=t.native;r("Alt",!(!o||!o.altKey)),r("Ctrl",!(!o||!o.ctrlKey)),r("Shift",!(!o||!o.shiftKey)),r("Meta",!(!o||!o.metaKey)),r("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new hu((e,t,s)=>this._setLatestPointer(e,t,s)),this._multiTouchHandler=new uu,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],yt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,yt.INTERNAL)}_setPointerCapture(e,t,s,n){const r=e.name+"-"+t.priorityIndex,o=this._pointerCaptures.get(s.pointerId)||new Set;this._pointerCaptures.set(s.pointerId,o),n?(o.add(r),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(s,!0)):o.has(r)&&(o.delete(r),o.size===0&&(this._pointerCaptures.delete(s.pointerId),this.eventSource&&this.eventSource.setPointerCapture(s,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,s,n){this._emitInputEvent(0,e,t,s,n)}_emitInputEvent(e,t,s,n,r,o){const c=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),d=r!==void 0&&r,h={event:new pu(t,s,c,o||this._activeKeyModifiers,d),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(h):this._doNewPropagation(h)}_doNewPropagation(e){this._currentPropagation={events:new gr,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,s;const e=Vl(this._currentPropagation);for(;e.events.length>0;){const{event:n,priorityIndex:r}=e.events.pop(),o=n.data&&n.data.eventId;if(!(o!=null&&this._stoppedPropagationEventIds.has(o)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((s=(t=e.currentHandler).eventCallback)==null||s.call(t,n)),n.shouldStopPropagation()){o!=null&&this._stoppedPropagationEventIds.add(o);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new gr;t.push(e);const s=this._currentPropagation;if(s){for(;s.events.length;)t.push(s.events.pop());s.events=t,s.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const s of e.handler.incomingEventMatches)for(const n of t.handler.incomingEventMatches){if(s.eventType!==n.eventType)continue;const r=s.keyModifiers.filter(o=>n.keyModifiers.includes(o));if(r.length===s.keyModifiers.length!=(r.length===n.keyModifiers.length))return s.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const s of e){let n=0;for(;n<t.length&&this._compareHandlerPriority(s,t[n])>=0;)n++;t.splice(n,0,s)}return t}get debug(){const e=t=>{const s=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=s};return{injectEvent:(t,s)=>{e(()=>{this._onEventReceived(t,s)})},disablePointerCapture:e}}};a([l({readOnly:!0})],Fe.prototype,"hasPendingInputs",null),a([l({constructOnly:!0})],Fe.prototype,"eventSource",void 0),a([l({constructOnly:!0})],Fe.prototype,"recognizers",void 0),a([l()],Fe.prototype,"_latestPointerType",void 0),a([l()],Fe.prototype,"latestPointerType",null),a([l()],Fe.prototype,"multiTouchActive",null),a([l({readOnly:!0})],Fe.prototype,"latestPointerLocation",void 0),Fe=a([I("esri.views.input.InputManager")],Fe);let pu=class{constructor(e,t,s,n,r){this.type=e,this.data=t,this.timestamp=s,this.modifiers=n,this.cancelable=r,this._propagationState=ft.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=ft.STOPPED}shouldStopPropagation(){return(this._propagationState&ft.STOPPED)!=0}async(e){this._propagationState|=ft.PAUSED;const t=(s,n)=>{this._propagationState&=~ft.PAUSED;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),n)throw s;return s};return(typeof e=="function"?e():e).then(s=>t(s,!1),s=>t(s,!0))}shouldPausePropagation(e){return!!(this._propagationState&ft.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var ft;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(ft||(ft={}));const yt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let mu=class{};function Xr(i){return i&&typeof i.highlight=="function"}const Cs={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},Ot=new Si({id:"zoom-to-feature",title:"{messages.zoom}",className:Cs.iconZoom}),Jr=new Si({id:"remove-selected-feature",title:"{messages.remove}",className:Cs.iconTrash}),ei=new Si({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:Cs.iconZoom}),ti=new Si({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:Cs.iconBrowseClusteredFeatures}),gu="esri.widgets.Popup.PopupViewModel",hs=R.getLogger(gu),fu=i=>{const{event:e,view:t}=i,{action:s}=e,n=t&&t.popup;if(!s)return Promise.reject(new x("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new x("trigger-action:missing-arguments","view.popup is missing"));const{disabled:r,id:o}=s;if(!o)return Promise.reject(new x("trigger-action:invalid-action","action.id is missing"));if(r)return Promise.reject(new x("trigger-action:invalid-action","Action is disabled"));if(o===Ot.id)return yu(n.viewModel).catch(El);if(o===ei.id)return vu(n.viewModel);if(o===ti.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,o===Jr.id){n.close();const{selectedFeature:c}=n;if(!c)return Promise.reject(new x(`trigger-action:${Jr.id}`,"selectedFeature is required",{selectedFeature:c}));const{sourceLayer:d}=c;return d?d.remove(c):t.graphics.remove(c),Promise.resolve()}return Promise.resolve()};function Ea(i){const{selectedFeature:e,location:t,view:s}=i;return s?s.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function Rt(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function _u(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let s;try{s=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!s||!s.boundingBox||s.boundingBox[0]===s.boundingBox[3]&&s.boundingBox[1]===s.boundingBox[4]&&s.boundingBox[2]===s.boundingBox[5]}return!0}async function yu(i){const{location:e,selectedFeature:t,view:s,zoomFactor:n}=i,r=Ea(i);if(!r){const h=new x("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:r,view:s});throw hs.error(h),h}const o=s.scale/n,c=i.get("selectedFeature.geometry")||e,d=c&&c.type==="point"&&await _u(t,s);Ot.active=!0,Ot.disabled=!0;try{await i.zoomTo({target:{target:r,scale:d?o:void 0}})}catch{const u=new x("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});hs.error(u)}finally{Ot.active=!1,Ot.disabled=!1,i.zoomToLocation=null,d&&(i.location=c)}}async function vu(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const c=new x("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw hs.error(c),c}if(!Rt(e)){const c=new x("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw hs.error(c),c}const s=e.sourceLayer,n=await t.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],ei.active=!0,ei.disabled=!0;const{extent:o}=await n.queryExtent(r);await i.zoomTo({target:o}),ei.active=!1,ei.disabled=!1}async function wu(i){const{selectedFeature:e,view:t}=i,s=e.sourceLayer,n=await t.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()];const{extent:o}=await n.queryExtent(r);i.selectedClusterBoundaryFeature.geometry=o,t.graphics.add(i.selectedClusterBoundaryFeature)}async function bu(i){const{selectedFeature:e,view:t}=i,s=e.sourceLayer,n=await t.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],ti.active=!0,ti.disabled=!0;const{features:o}=await n.queryFeatures(r);ti.active=!1,ti.disabled=!1,t.popup.open({features:[e].concat(o),featureMenuOpen:!0})}function Mu(i){const e=i.features.filter(t=>Rt(t));e.length&&(i.features=e)}const xa=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:s}=this;return this.goToOverride?this.goToOverride(s,t):s.goTo(t.target,t.options)}};return a([l()],e.prototype,"goToOverride",void 0),a([l()],e.prototype,"view",void 0),e=a([I("esri.widgets.support.GoTo")],e),e},Ei=H.ofType({key:"type",defaultKeyValue:"button",base:fc,typeMap:{button:Si,toggle:_c}}),Iu=()=>[Ot.clone()],Cu=()=>[ei.clone(),ti.clone()];let F=class extends xa(Ia){constructor(e){super(e),this._handles=new Je,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new Ei,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new Nt({symbol:new bc({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([v(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),v(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),v(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),v(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),v(()=>this.location,e=>this._locationChange(e)),v(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),v(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),v(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),v(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>fu({event:e,view:this.view})),Xe(()=>!this.waitingForResult,()=>this._waitingForResultChange(),ki),v(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),v(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),Xe(()=>!this.visible,()=>this.browseClusterEnabled=!1),v(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new Ei;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:n,includeDefaultActions:r,selectedFeature:o}=this,c=r?s.concat(t):t,d=o&&(typeof o.getEffectivePopupTemplate=="function"&&o.getEffectivePopupTemplate(n)||o.popupTemplate),h=d&&d.actions,u=d&&d.overwriteActions?h:h?h.concat(c):c;return u&&u.filter(Boolean).forEach(p=>e.add(p)),e}get defaultActions(){const e=this._get("defaultActions")||new Ei;return e.removeAll(),e.addMany(Rt(this.selectedFeature)?Cu():Iu()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:n,selectedFeatureIndex:r}=this,o=n&&t.length;o&&s&&r===-1?this.selectedFeatureIndex=0:o&&r!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=Vo(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const s=r=>{this._pendingPromises.has(t)&&this._updateFeatures(r),this._updatePendingPromises(t)},n=()=>this._updatePendingPromises(t);t.then(s,n)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=Ea(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new x("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:s}=this;if(!s||!e)throw new x("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location);const n=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const r of n)delete t[r];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){Mu(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?Rt(t)?(await wu(this),await bu(this)):R.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):R.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(Ot.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(Rt(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:n,featureViewModels:r}=this;if(s===null)return;const o=((s-1)*n+t)%t,c=o+n;r.slice(o,c).forEach((d,h)=>{d&&!d.graphic&&(d.graphic=e[o+h])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:n}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(n.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),Rt(e)?void 0:(e.symbol=await su(e),this._selectedClusterFeature=e,void n.graphics.add(this._selectedClusterFeature));!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=n.center.clone()}):this.location=ye(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:s,promisesPerLayerView:n}=t,r=Promise.resolve(s),o=n.map(c=>c.promise);this.promises=[r,...o]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(Rt(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const n=s.slice(0),r=[];t.forEach((o,c)=>{var h,u;if(!o)return;let d=null;if(n.some((p,g)=>(p&&p.graphic===o&&(d=p,n.splice(g,1)),!!d)),d)r[c]=d;else{const p=new Gn({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(h=this.view)==null?void 0:h.spatialReference,graphic:o===e?o:null,map:(u=this.view)==null?void 0:u.map,view:this.view});r[c]=p}}),n.forEach(o=>o&&!o.destroyed&&o.destroy()),this._set("featureViewModels",r)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const n=this.view.on("click",r=>{r.pointerType==="mouse"&&r.button!==0||this._fetchFeaturesAndOpen(r)},yt.WIDGET);t.add(n,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:n}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const r=this.fetchFeatures(e,{signal:n,event:t});return r.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),r}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:n}=this;this._fetchFeaturesWithController(t,e).then(r=>{const{clientOnlyGraphics:o,promisesPerLayerView:c,location:d}=r,h=[Promise.resolve(o),...c.map(u=>u.promise)];return n.popup.open({location:d||s,promises:h}),r})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return $(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:s}=e;return s&&"layer"in s&&s.layer?s.layer:(s==null?void 0:s.type)==="map-notes"||(s==null?void 0:s.type)==="subtype-group"?s:t}_getHighlightTarget(e,t){const s=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||iu:null,n=e.attributes;return n&&s&&n[s]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:s,activeFeature:n,visible:r}=this;if(!(n&&s&&t&&r))return;const o=this._getHighlightLayer(n);if(!(o&&o instanceof mr))return;const c=this._getLayerView(s,o);this._highlightActiveFeaturePromise=c;const d=await c;if(!(d&&Xr(d)&&this._highlightActiveFeaturePromise===c&&this.activeFeature&&this.highlightEnabled))return;const h=d.highlight(this._getHighlightTarget(n,o));this._handles.add(h,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:n,visible:r}=this;if(!(t&&n&&s&&r))return;const o=this._getHighlightLayer(t);if(!(o&&o instanceof mr))return;const c=this._getLayerView(n,o);this._highlightSelectedFeaturePromise=c;const d=await c;if(!(d&&Xr(d)&&this._highlightSelectedFeaturePromise===c&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const h=d.highlight(this._getHighlightTarget(t,o));this._handles.add(h,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter(n=>!t.includes(n));this.features=t.concat(s)}};a([l()],F.prototype,"featurePage",void 0),a([l()],F.prototype,"isLoadingFeature",null),a([l({type:Ei})],F.prototype,"actions",void 0),a([l({readOnly:!0})],F.prototype,"active",null),a([l()],F.prototype,"activeFeature",void 0),a([l({readOnly:!0})],F.prototype,"allActions",null),a([l({type:Boolean})],F.prototype,"defaultPopupTemplateEnabled",void 0),a([l()],F.prototype,"autoCloseEnabled",void 0),a([l()],F.prototype,"autoOpenEnabled",void 0),a([l()],F.prototype,"browseClusterEnabled",void 0),a([l()],F.prototype,"content",void 0),a([l({type:Ei,readOnly:!0})],F.prototype,"defaultActions",null),a([l({readOnly:!0})],F.prototype,"featureCount",null),a([l()],F.prototype,"features",null),a([l()],F.prototype,"featuresPerPage",void 0),a([l()],F.prototype,"featureViewModelAbilities",void 0),a([l({readOnly:!0})],F.prototype,"featureViewModels",void 0),a([l()],F.prototype,"highlightEnabled",void 0),a([l()],F.prototype,"includeDefaultActions",void 0),a([l({type:K})],F.prototype,"location",null),a([l({readOnly:!0})],F.prototype,"pendingPromisesCount",null),a([l({readOnly:!0})],F.prototype,"selectedClusterBoundaryFeature",void 0),a([l({readOnly:!0})],F.prototype,"waitingForResult",null),a([l({readOnly:!0})],F.prototype,"promiseCount",null),a([l()],F.prototype,"promises",null),a([l({value:null,readOnly:!0})],F.prototype,"selectedFeature",null),a([l({value:-1})],F.prototype,"selectedFeatureIndex",null),a([l({readOnly:!0})],F.prototype,"selectedFeatureViewModel",null),a([l({readOnly:!0})],F.prototype,"state",null),a([l()],F.prototype,"title",void 0),a([l()],F.prototype,"updateLocationEnabled",void 0),a([l()],F.prototype,"view",void 0),a([l()],F.prototype,"visible",void 0),a([l()],F.prototype,"zoomFactor",void 0),a([l()],F.prototype,"zoomToLocation",void 0),a([l()],F.prototype,"centerAtLocation",null),F=a([I("esri.widgets.Popup.PopupViewModel")],F);const ka=F,eo="selected-index",Tu=0,to="popup-spinner",_={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},io={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},so="esri-popup";function Be(i,e){return e===void 0?`${so}__${i}`:`${so}__${i}-${e}`}const no={closeButton:!0,featureNavigation:!0};let E=class extends ba(ne){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Je,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([s])=>{s!=null&&s.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=si(()=>this._displaySpinner(),Tu),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new H,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new ka,this.visibleElements={...no},this._addSelectedFeatureIndexHandle(),this.addHandles([v(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},()=>this._positionContainer()),v(()=>{var s;return[(s=this.viewModel)==null?void 0:s.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},(s,n)=>{!!s!=!!n&&this.reposition()}),v(()=>{var s,n,r,o,c,d;return[(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.padding,(o=(r=this.viewModel)==null?void 0:r.view)==null?void 0:o.size,(c=this.viewModel)==null?void 0:c.active,(d=this.viewModel)==null?void 0:d.location,this.alignment]},()=>this.reposition()),v(()=>this.spinnerEnabled,s=>this._spinnerEnabledChange(s)),v(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.size},(s,n)=>this._updateDockEnabledForViewSize(s,n)),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.view},(s,n)=>this._viewChange(s,n)),v(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.ready},(s,n)=>this._viewReadyChange(s,n)),v(()=>{var s,n;return[(s=this.viewModel)==null?void 0:s.waitingForResult,(n=this.viewModel)==null?void 0:n.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),v(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),v(()=>{var s,n,r,o;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.title,(o=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:o.state]},()=>this._setTitleFromFeatureWidget()),v(()=>{var s,n,r,o;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.content,(o=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:o.state]},()=>this._setContentFromFeatureWidget()),Xe(()=>!this.collapsed,()=>{var s,n;((n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),xe(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},"change",()=>this._watchActions()),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},()=>this._watchActions(),O),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.featureViewModels},()=>this._featureMenuViewportScrollTop()),xe(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),v(()=>{var s,n,r,o;return[(n=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:n.state,(o=(r=this._activeFlowItemWidget)==null?void 0:r.viewModel)==null?void 0:o.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([w(()=>import("./calcite-flow-2c0235bf.js"),["assets/calcite-flow-2c0235bf.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/observers-73b5e0ed.js"]),w(()=>import("./calcite-flow-item-5db715a4.js"),["assets/calcite-flow-item-5db715a4.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js","assets/action-6710ee2f.js","assets/observers-73b5e0ed.js","assets/interactive-52dcf836.js","assets/icon-de53a9d7.js","assets/tooltip-93f07e20.js"]),w(()=>import("./calcite-action-42bd95bb.js"),["assets/calcite-action-42bd95bb.js","assets/action-6710ee2f.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/observers-73b5e0ed.js","assets/interactive-52dcf836.js","assets/icon-de53a9d7.js","assets/guid-e49c4e43.js"]),w(()=>import("./calcite-tooltip-64a2b1d0.js"),["assets/calcite-tooltip-64a2b1d0.js","assets/tooltip-93f07e20.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js"]),w(()=>import("./calcite-icon-ac6b684b.js"),["assets/calcite-icon-ac6b684b.js","assets/icon-de53a9d7.js","assets/widget-8a5f4608.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/intl-afc91037.js","assets/number-53937715.js","assets/jsonMap-a9c94baf.js","assets/locale-30120714.js","assets/messages-03a939ad.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/assets-4cb15247.js","assets/Evented-d8fc77f0.js","assets/Promise-088a0e17.js","assets/reactiveUtils-3c1b281e.js","assets/uuid-73213768.js","assets/observers-73b5e0ed.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const s=e.viewModel;if(s!=null&&s.waitingForContent||(s==null?void 0:s.state)==="error")return!0;const n=s==null?void 0:s.content;return Array.isArray(n)?!!n.length:!!n}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||io}set dockOptions(e){const t={...io},s=this.get("viewModel.view.breakpoints"),n={};s&&(n.width=s.xsmall,n.height=s.xsmall);const r={...t,...e},o={...t.breakpoint,...n},{breakpoint:c}=r;c===!0?r.breakpoint=o:typeof c=="object"&&(r.breakpoint={...o,...c}),this._set("dockOptions",r),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:s,_flowItems:n}=this,{selectedFeatureViewModel:r}=this.viewModel,o={...t,title:!1};return r?(e?(e.viewModel=r,e.visibleElements=o):this._feature=new Jh({flowItems:n,headingLevel:s+1,viewModel:r,visibleElements:o}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...no,...e}}blur(){const{active:e}=this.viewModel;e||R.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||R.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var r,o;this._handles.remove(eo);const t=!!e&&!!e.featureMenuOpen,s=!!e&&!!e.actionsMenuOpen,n={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:s,featureMenuOpen:t};((o=(r=this.viewModel)==null?void 0:r.view)==null?void 0:o.widthBreakpoint)==="xsmall"&&(n.collapsed=!0),this.set(n),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var T,C,P,D;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:s,dividedActions:n,currentAlignment:r,currentDockPosition:o}=this,{active:c}=this.viewModel,{menuActions:d}=n,h=c&&d.length>1&&e,u=c&&t,p=c&&!t,g=(C=(T=this.selectedFeature)==null?void 0:T.layer)==null?void 0:C.title,f=(D=(P=this.selectedFeature)==null?void 0:P.layer)==null?void 0:D.id,y={[_.alignTopCenter]:r==="top-center",[_.alignBottomCenter]:r==="bottom-center",[_.alignTopLeft]:r==="top-left",[_.alignBottomLeft]:r==="bottom-left",[_.alignTopRight]:r==="top-right",[_.alignBottomRight]:r==="bottom-right",[_.isDocked]:u,[_.shadow]:p,[_.isDockedTopLeft]:o==="top-left",[_.isDockedTopCenter]:o==="top-center",[_.isDockedTopRight]:o==="top-right",[_.isDockedBottomLeft]:o==="bottom-left",[_.isDockedBottomCenter]:o==="bottom-center",[_.isDockedBottomRight]:o==="bottom-right",[_.isFeatureMenuOpen]:s,[_.isActionsMenuOpen]:h};return m("div",{class:this.classes(_.base,y),role:"presentation","data-layer-title":g,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return m("span",{"aria-hidden":"true",class:this.classes(_.icon,_.iconLoading,_.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?m("div",{key:Be("loading-container"),role:"presentation",class:_.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=Oe(this.container),t={[_.iconRightTriangleArrow]:e,[_.paginationPreviousIconRTL]:e,[_.iconLeftTriangleArrow]:!e,[_.paginationPreviousIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(_.icon,t)})}renderPreviousButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(_.button,_.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=Oe(this.container),t={[_.iconLeftTriangleArrow]:e,[_.paginationNextIconRTL]:e,[_.iconRightTriangleArrow]:!e,[_.paginationNextIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(_.icon,t)})}renderNextButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(_.button,_.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:s}=this,{featureCount:n,selectedFeatureIndex:r}=this.viewModel;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(_.button,_.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":s.menu,title:s.menu},this._getPageText(n,r))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),s={[_.iconUndock]:e,[_.iconDock]:!e,[_.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[_.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[_.iconDockToTop]:!e&&t==="top-center",[_.iconDockToBottom]:!e&&t==="bottom-center"};return m("span",{"aria-hidden":"true",class:this.classes(s,_.icon)})}renderDockButton(){var r,o,c;const{dockEnabled:e,messages:t}=this,s=(o=(r=this.viewModel)==null?void 0:r.view)==null?void 0:o.widthBreakpoint,n=e?t.undock:t.dock;return s!=="xsmall"&&((c=this.dockOptions)!=null&&c.buttonEnabled)?m("div",{role:"button","aria-label":n,title:n,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(_.button,_.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:s,contentCollapsed:n,messagesCommon:r}=this,o={[_.headerContainerButton]:s},c=m(Bn,{level:this.headingLevel,class:_.headerTitle,innerHTML:e}),d=s?m("button",{key:`${e}--collapsible`,id:t,title:n?r.expand:r.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(_.headerContainer,o),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},c,m("calcite-icon",{class:_.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):m("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(_.headerContainer,o)},c);return e?d:null}renderCloseIcon(){return m("span",{"aria-hidden":"true",class:this.classes(_.icon,_.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?m("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:_.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return m("header",{class:_.header},this.renderTitle(),m("div",{class:_.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:s,_flowItems:n,messagesCommon:r}=this,{content:o}=this.viewModel,c=n.toArray(),d={[_.contentHasFlows]:!!c.length};return t&&!s?m("div",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(_.content,d)},m("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},m("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":r.back,afterCreate:ss,key:"root-flow-item"},this.renderContent()),c.map(h=>this.renderFlowItem(h))),c.map(h=>this.renderFlowItemTooltip(h))):null}renderFlowItem(e){const{messages:t,messagesCommon:s}=this,n=ds();return m("calcite-flow-item",{class:this.classes({[_.calciteThemeDark]:!n,[_.calciteThemeLight]:n}),heading:e.title,"intl-back":s.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},m("calcite-action",{class:_.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:r=>this._storeExitRelatedRecordsAction(e,r),onclick:this._destroyFlowItemWidgets}),m("div",{class:this.classes(_.contentFlowItem,{[_.calciteThemeDark]:n,[_.calciteThemeLight]:!n})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:s}=this,n=ds();return m("calcite-tooltip",{class:this.classes({[_.calciteThemeDark]:!n,[_.calciteThemeLight]:n}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:s.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n,messagesCommon:r}=this,o=s?r.close:r.open,{menuActions:c}=n;return c.length?m("div",{key:Be("actions-menu-button"),class:this.classes(_.button,_.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":s?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":o,title:o},m("span",{"aria-hidden":"true",class:_.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n}=this,{menuActions:r}=n;return r.length&&s?m("ul",{id:e,role:"menu","aria-labelledby":t,key:Be("actions"),class:_.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},r.toArray().map(o=>this.renderAction({action:o,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,s=!!e.length,n=!!t.length;return s||n?m("div",{key:"inline-actions-container","data-inline-actions":s.toString(),"data-menu-actions":n.toString(),class:_.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?m("section",{key:Be("navigation"),class:this.classes(_.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:s,menuActions:n}=t,r=!!s.length,o=!!n.length,c={[_.footerHasPagination]:e,[_.footerHasActions]:r,[_.footerHasActionsMenu]:o};return e||r?m("div",{key:Be("feature-buttons"),class:this.classes(_.footer,c)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:s}=this.viewModel,n=De(e.selectedFeatures,{total:t.length});return m("section",{key:Be("menu"),class:_.featureMenu},m("strong",{class:_.featureMenuHeader},n),m("nav",{bind:this,class:_.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:ss},this.renderFeatureMenu(),m("div",{class:_.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),s?m("div",{class:_.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:m("div",{key:Be("pointer"),class:_.pointer,role:"presentation"},m("div",{class:this.classes(_.pointerDirection,_.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:s,titleId:n,contentId:r,collapsible:o,hasContent:c,contentCollapsed:d,visibleElements:h}=this,{title:u}=this.viewModel,p=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||s==="top-left"||s==="top-center"||s==="top-right",g=t==="top-left"||t==="top-center"||t==="top-right"||s==="bottom-left"||s==="bottom-center"||s==="bottom-right",f={[_.shadow]:e,[_.isCollapsible]:o,[_.isCollapsed]:d};return m("div",{class:this.classes(_.main,_.widget,f),tabIndex:h.closeButton?null:-1,role:"dialog","aria-labelledby":u?n:"","aria-describedby":c&&!d?r:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},p?this.renderFooter():null,p?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),g?this.renderFooter():null,g?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?m("div",{class:U.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return m("span",{key:"text",class:_.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),s=this._getActionImage(e),n={[_.iconLoading]:e.active,[_.rotating]:e.active,[_.icon]:!!t,[_.actionImage]:!e.active&&!!s};return t&&(n[t]=!e.active),m("span",{key:"icon","aria-hidden":"true",class:this.classes(_.icon,n),styles:this._getIconStyles(s)})}renderAction(e){const{action:t,type:s}=e,n=this._getActionTitle(t),r={[_.action]:t.type!=="toggle",[_.actionToggle]:t.type==="toggle",[_.actionToggleOn]:t.type==="toggle"&&t.value,[_.buttonDisabled]:t.disabled},o=[this.renderActionIcon(t),this.renderActionText(n)],c=s==="menu-item"?m("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(_.button,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o):m("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(_.button,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o);return t.visible?c:null}renderFeatureMenuItem(e,t){const{messages:s,messagesCommon:n}=this,{selectedFeatureIndex:r,selectedFeatureViewModel:o}=this.viewModel,c=e===o,d={[_.featureMenuSelected]:c},h=c?m("span",{key:Be(`feature-menu-selected-feature-${r}`),title:s.selectedFeature,"aria-label":s.selectedFeature,class:_.iconCheckMark}):null,u=m("span",{innerHTML:e.title||n.untitled});return m("li",{role:"menuitem",tabIndex:-1,key:Be(`feature-menu-feature-${r}`),class:this.classes(d,_.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},m("span",{class:_.featureMenuTitle},u,h))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?m("ol",{class:_.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(s=>!!s.graphic).map((s,n)=>this.renderFeatureMenuItem(s,n))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:s,messagesCommon:n}=this,{id:r}=e,o=s==null?void 0:s.attributes,c=r==="zoom-to-feature"?De(e.title,{messages:t}):r==="remove-selected-feature"?De(e.title,{messages:n}):r==="zoom-to-clustered-features"||r==="browse-clustered-features"?De(e.title,{messages:t}):e.title;return c&&o?De(c,o):c}_getActionClass(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{className:n,image:r}=e,o=r||n?n:_.iconDefaultAction;return o&&s?De(o,s):o}_getActionImage(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{image:n}=e;return n&&s?De(n,s):n}_createFeatureUpdatedAnimation(){return sc("enter",_.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const s=Math.round(e);return Math.max(t?s-1:s,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(s=>{this._handles.add(v(()=>[s.uid,s.active,s.className,s.disabled,s.id,s.title,s.image,s.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(o=>o.visible),s=this._getInlineActionCount(),n=s===null,r=s===0;return{inlineActions:n?t.slice(0):r?new H:t.slice(0,s),menuActions:n?new H:r?t.slice(0):t.slice(s)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var s,n;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((s=e.viewModel)==null?void 0:s.state)==="error"?t.errorMessage:((n=e.viewModel)==null?void 0:n.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){Ft(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){Ft(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,s=e.currentTarget["data-feature-index"];t.activeFeature=t.features[s]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=Ft(e),{_featureMenuNode:s}=this,n=e.currentTarget["data-feature-index"];if(!s)return;const r=s.querySelectorAll("li"),o=r.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),r[r.length-1].focus()):(e.stopPropagation(),r[0].focus()):(e.stopPropagation(),r[(n+1+o)%o].focus()):(e.stopPropagation(),r[(n-1+o)%o].focus())}_handleActionMenuItemKeyup(e){const t=Ft(e),{_actionsMenuNode:s}=this,n=e.currentTarget.dataset.actionUid,{menuActions:r}=this.dividedActions,o=r.findIndex(h=>h.uid===n);if(!s)return;const c=s.querySelectorAll("li"),d=c.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),c[c.length-1].focus()):(e.stopPropagation(),c[0].focus()):(e.stopPropagation(),c[(o+1+d)%d].focus()):(e.stopPropagation(),c[(o-1+d)%d].focus())}_handleMainKeyup(e){const t=Ft(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:s}=this.viewModel;s?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await $n(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=v(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,s)=>this._selectedFeatureIndexUpdated(t,s));this._handles.add(e,eo)}_selectedFeatureIndexUpdated(e,t){const{featureCount:s}=this;s&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:s,screenLocation:n,side:r,view:o}=e;if(isNaN(s)||isNaN(t)||!o||!n)return!1;const c=o.padding;return r==="right"&&n.x+s/2>o.width-c.right||r==="left"&&n.x-s/2<c.left||r==="top"&&n.y-t<c.top||r==="bottom"&&n.y+t>o.height-c.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:s,_mainContainerNode:n,viewModel:r}=this,{screenLocation:o,view:c}=r;if($(o)||!c||!s)return"top-center";if(!this._isScreenLocationWithinView(o,c))return this._get("currentAlignment")||"top-center";function d(B){return parseInt(B.replace(/[^-\d\.]/g,""),10)}const h=n?window.getComputedStyle(n,null):null,u=h?d(h.getPropertyValue("max-height")):0,p=h?d(h.getPropertyValue("height")):0,{height:g,width:f}=s.getBoundingClientRect(),y=f+t,T=Math.max(g,u,p)+t,C=this._isOutsideView({popupHeight:T,popupWidth:y,screenLocation:o,side:"right",view:c}),P=this._isOutsideView({popupHeight:T,popupWidth:y,screenLocation:o,side:"left",view:c}),D=this._isOutsideView({popupHeight:T,popupWidth:y,screenLocation:o,side:"top",view:c}),L=this._isOutsideView({popupHeight:T,popupWidth:y,screenLocation:o,side:"bottom",view:c});return P?D?"bottom-right":"top-right":C?D?"bottom-left":"top-left":D?L?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return Oe(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var c;if(e!=="auto")return e;const t=(c=this.viewModel)==null?void 0:c.view,s=Oe(this.container)?"top-left":"top-right";if(!t)return s;const n=t.padding||{left:0,right:0,top:0,bottom:0},r=t.width-n.left-n.right,{breakpoints:o}=t;return o&&r<=o.xsmall?"bottom-center":s}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:s}=e.getBoundingClientRect(),n=this._calculatePositionStyle(t,s);n&&(e.style.top=n.top,e.style.left=n.left,e.style.bottom=n.bottom,e.style.right=n.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:s}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+s:e}_calculateAlignmentPosition(e,t,s,n){const{currentAlignment:r,_pointerOffsetInPx:o}=this,c=n/2,d=s.height-t,h=s.width-e,{padding:u}=this.view;return r==="bottom-center"?{top:t+o-u.top,left:e-c-u.left}:r==="top-left"?{bottom:d+o-u.bottom,right:h+o-u.right}:r==="bottom-left"?{top:t+o-u.top,right:h+o-u.right}:r==="top-right"?{bottom:d+o-u.bottom,left:e+o-u.left}:r==="bottom-right"?{top:t+o-u.top,left:e+o-u.left}:r==="top-center"?{bottom:d+o-u.bottom,left:e-c-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:s,view:n}=this;if(!n)return;if(s)return{left:"",top:"",right:"",bottom:""};if($(e)||!t)return;const r=this._calculateFullWidth(t),o=this._calculateAlignmentPosition(e.x,e.y,n,r);return o?{top:o.top!==void 0?`${o.top}px`:"auto",left:o.left!==void 0?`${o.left}px`:"auto",bottom:o.bottom!==void 0?`${o.bottom}px`:"auto",right:o.right!==void 0?`${o.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const s=this.get("viewModel.view");this._wireUpView(s)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,s){const[n,r]=e,[o,c]=t,{width:d,height:h}=s;return n<=d&&o>d||n>d&&o<=d||r<=h&&c>h||r>h&&c<=h}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const s=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=s.left+s.right,r=s.top+s.bottom,o=[],c=[];o[0]=e[0]-n,o[1]=e[1]-r,c[0]=t[0]-n,c[1]=t[1]-r;const{dockOptions:d}=this,h=d.breakpoint;this._dockingThresholdCrossed(o,c,h)&&this._setDockEnabledForViewSize(d),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const s=t.active&&!e;t.screenLocationEnabled=s}_shouldDockAtCurrentViewSize(e){var d,h;const t=e.breakpoint,s=(h=(d=this.viewModel)==null?void 0:d.view)==null?void 0:h.ui;if(!s)return!1;const{width:n,height:r}=s;if(isNaN(n)||isNaN(r))return!1;const o=t.hasOwnProperty("width")&&n<=t.width,c=t.hasOwnProperty("height")&&r<=t.height;return o||c}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?De(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,to),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new tu({view:e}),e.ui.add(this._spinner,{key:to,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:s}=this.viewModel,n=s.findIndex(o=>o.uid===t),r=s.getItemAt(n);r&&r.type==="toggle"&&(r.value=!r.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};a([l({readOnly:!0})],E.prototype,"actionsMenuId",null),a([l({readOnly:!0})],E.prototype,"actionsMenuButtonId",null),a([l({readOnly:!0})],E.prototype,"featureMenuId",null),a([l({readOnly:!0})],E.prototype,"titleId",null),a([l({readOnly:!0})],E.prototype,"contentId",null),a([l({readOnly:!0})],E.prototype,"hasContent",null),a([l({readOnly:!0})],E.prototype,"featureNavigationVisible",null),a([l({readOnly:!0})],E.prototype,"collapsible",null),a([l({readOnly:!0})],E.prototype,"featureMenuVisible",null),a([l({readOnly:!0})],E.prototype,"contentCollapsed",null),a([l({readOnly:!0})],E.prototype,"dividedActions",null),a([l({readOnly:!0,dependsOn:["_flowItems.length"]})],E.prototype,"_activeFlowItemWidget",null),a([l()],E.prototype,"actions",null),a([l()],E.prototype,"actionsMenuOpen",null),a([l()],E.prototype,"alignment",void 0),a([l()],E.prototype,"autoCloseEnabled",null),a([l()],E.prototype,"autoOpenEnabled",null),a([l()],E.prototype,"defaultPopupTemplateEnabled",null),a([l()],E.prototype,"content",null),a([l()],E.prototype,"collapsed",void 0),a([l()],E.prototype,"collapseEnabled",void 0),a([l({readOnly:!0})],E.prototype,"currentAlignment",null),a([l({readOnly:!0})],E.prototype,"currentDockPosition",null),a([l()],E.prototype,"dockOptions",null),a([l()],E.prototype,"dockEnabled",void 0),a([l({readOnly:!0})],E.prototype,"featureCount",null),a([l()],E.prototype,"featureMenuOpen",void 0),a([l()],E.prototype,"features",null),a([l()],E.prototype,"goToOverride",null),a([l()],E.prototype,"headingLevel",void 0),a([l()],E.prototype,"highlightEnabled",null),a([l()],E.prototype,"location",null),a([l()],E.prototype,"label",null),a([l()],E.prototype,"maxInlineActions",void 0),a([l(),se("esri/widgets/Popup/t9n/Popup")],E.prototype,"messages",void 0),a([l(),se("esri/t9n/common")],E.prototype,"messagesCommon",void 0),a([l()],E.prototype,"promises",null),a([l({readOnly:!0})],E.prototype,"selectedFeature",null),a([l()],E.prototype,"selectedFeatureIndex",null),a([l({readOnly:!0})],E.prototype,"selectedFeatureWidget",null),a([l()],E.prototype,"spinnerEnabled",void 0),a([l()],E.prototype,"title",null),a([l()],E.prototype,"updateLocationEnabled",null),a([l()],E.prototype,"view",null),a([l({type:ka}),Xd(["triggerAction","trigger-action"])],E.prototype,"viewModel",void 0),a([l()],E.prototype,"visible",null),a([l()],E.prototype,"visibleElements",void 0),a([pe("visibleElements")],E.prototype,"castVisibleElements",null),a([Me()],E.prototype,"_close",null),a([Me()],E.prototype,"_toggleDockEnabled",null),a([Me()],E.prototype,"_toggleFeatureMenu",null),a([Me()],E.prototype,"_toggleActionsMenu",null),a([Me()],E.prototype,"_triggerAction",null),a([Me()],E.prototype,"_selectFeature",null),a([Me()],E.prototype,"_next",null),a([Me()],E.prototype,"_previous",null),E=a([I("esri.widgets.Popup")],E);const ro=E,Hs=[0,0];function Eu(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return Hs[0]=t.left+((e==null?void 0:e.pageXOffset)??0),Hs[1]=t.top+((e==null?void 0:e.pageYOffset)??0),Hs}function oo(i){i&&(Ho(i),i.parentNode&&i.parentNode.removeChild(i))}function xu(i){const e=document.createElement("div");return i.appendChild(e),e}const ui=16,Ni=750,ku=512,Au=2,Pu=i=>{let e=class extends i{constructor(...t){var s;super(...t),this._freqInfo={freq:ui,time:Ni},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((s=t[0])==null?void 0:s.popup)!==void 0||(this.popup=new ro({view:this})),this.handles.add([v(()=>this.cursor,n=>{const{surface:r}=this;r&&r.setAttribute("data-cursor",n)}),v(()=>this.interacting,n=>{const{surface:r}=this;r&&r.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(v(()=>this.ui,(t,s)=>this._handleUIChange(t,s))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=le(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const s=this._get("container"),n=Uo(t),r=n instanceof HTMLDivElement?n:null;if(r||typeof t!="string"||R.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),s===r)return;const o="dom-size";if(this.handles.remove(o),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(oo(this.root),this._set("root",null)),this.userContent&&(dr(this.userContent,s),oo(this.userContent),this._set("userContent",null))),!r)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);r.classList.add("esri-view");const c=document.createElement("div");c.className="esri-view-user-storage",dr(r,c),r.appendChild(c),this._set("userContent",c);const d=document.createElement("div");d.className="esri-view-root",r.insertBefore(d,r.firstChild),this._set("root",d);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,d.appendChild(h),this._set("surface",h);const u=new Tr;d.appendChild(u.surface),this._set("overlay",u),v(()=>u.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=ni({render:()=>{var g;return(g=this.overlay)==null?void 0:g.render()}}):this._overlayRenderTaskHandle=Mt(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(v(()=>this.size,p=>{const[g,f]=p,y="esri-view-surface--inset-outline";g>=document.body.clientWidth||f>=document.body.clientHeight?h.classList.add(y):h.classList.remove(y)},O),o),this._set("container",r),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const s=this._get("popup");s&&s!==t&&s.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,s,n){const r=this.position;return t-=r?r[0]:0,s-=r?r[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}containerToPage(t,s,n){const r=this.position;return t+=r?r[0]:0,s+=r?r[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}_handleUIChange(t,s){s&&(this.handles.remove("ui"),s.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([v(()=>this.root,s=>{t.container=s?xu(s):null},O),v(()=>this.popup,(s,n)=>{const r="popup",o="manual";n&&t.remove(n,r),s&&(s.view=t.view,t.add(s,{key:r,position:o}))},O)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=ui,t.time=Ni,this.handles.add([(()=>{const s=()=>{t.freq=ui,t.time=Ni};return window.addEventListener("resize",s),{remove(){window.removeEventListener("resize",s)}}})(),ni({prepare:s=>{const n=this._measure(),r=this._freqInfo;if(r.time+=s.deltaTime,n&&(r.freq=ui,this._get("resizing")||this._set("resizing",!0)),r.time<r.freq)return;r.time=0;const o=this._position();r.freq=o||n?ui:Math.min(Ni,r.freq*Au),!n&&r.freq>=ku&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,s=t?t.clientWidth:0,n=t?t.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const r=this.width,o=this.height;return s===r&&n===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:r,oldHeight:o,width:s,height:n}),!0)}_position(){const t=this.container,s=this.position,n=t&&Eu(t);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return a([l()],e.prototype,"container",null),a([l({readOnly:!0})],e.prototype,"focused",null),a([l({readOnly:!0})],e.prototype,"height",void 0),a([l({type:ro})],e.prototype,"popup",null),a([l({type:Tr})],e.prototype,"overlay",void 0),a([l({readOnly:!0})],e.prototype,"position",void 0),a([l({readOnly:!0})],e.prototype,"resizing",void 0),a([l({readOnly:!0})],e.prototype,"root",void 0),a([l({value:null,readOnly:!0})],e.prototype,"size",null),a([l({readOnly:!0})],e.prototype,"surface",void 0),a([l({readOnly:!0})],e.prototype,"suspended",void 0),a([l()],e.prototype,"ui",void 0),a([l({readOnly:!0})],e.prototype,"userContent",void 0),a([l({readOnly:!0})],e.prototype,"width",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),e=a([I("esri.views.DOMContainer")],e),e},$u=i=>{let e=class extends i{async fetchPopupFeatures(t,s){await this.when();const{location:n,queryArea:r,layerViewsAndGraphics:o,clientOnlyGraphics:c}=await this._prepareFetchPopupFeatures(t,s),d=Promise.resolve(c),h=this._queryLayerPopupFeatures(r,o,s),u=h.map(p=>p.promise);return{location:n,clientOnlyGraphics:c,allGraphicsPromise:xl([d,...u]).then(p=>Array.from(new Set(p.flat()))),promisesPerLayerView:h}}_queryLayerPopupFeatures(t,s,n){return s.map(({layerView:r,graphics:o})=>{const c={clientGraphics:o,event:M(n)?n.event:null,signal:M(n)?n.signal:null,defaultPopupTemplateEnabled:!!M(n)&&!!n.defaultPopupTemplateEnabled},d=r.fetchPopupFeatures(t,c);return{layerView:r,promise:d}})}_isValidPopupGraphic(t,s){return t&&!!t.getEffectivePopupTemplate(M(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,s){const{clientGraphics:n,queryArea:r,location:o}=await this._popupHitTestGraphics(t,s),c=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:d,clientOnlyGraphics:h}=this._graphicsPerFetchPopupLayerView(n,c);return{clientOnlyGraphics:h,layerViewsAndGraphics:d,queryArea:r,location:o}}async _popupHitTestGraphics(t,s){const{results:n,mapPoint:r}=await this.popupHitTest(t),o=n.filter(d=>d.type==="graphic"&&this._isValidPopupGraphic(d.graphic,s)),c=o.length?o[0].mapPoint:null;return{clientGraphics:o.map(d=>d.graphic),queryArea:r,location:r||c}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(s=>{this._isValidPopupLayerView(s)&&t.push(s)}),M(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return M(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,s){const n=[],r=new Map,o=s.map(c=>{const d=[];return"layer"in c?r.set(c.layer,d):r.set(c.graphics,d),{layerView:c,graphics:d}});for(const c of t){const d=r.get(c.layer)||r.get(c.sourceLayer)||null;d?d.push(c):n.push(c)}return{layerViewsAndGraphics:o,clientOnlyGraphics:n}}};return e=a([I("esri.views.PopupView")],e),e};let us=class extends Vc{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{$(t.item)||t.item.parent===this.owner&&(R.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};us=a([I("esri.support.AnalysesCollection")],us);let lt=class extends S{constructor(e){super(e),this.view=null,this.baseLayerViews=new H,this.referenceLayerViews=new H,this._loadingHandle=v(()=>{var t,s;return(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap},t=>{t&&t.load().catch(()=>{})},O)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,s;if(this.view&&this.view.suspended)return!1;const e=(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};a([l({constructOnly:!0})],lt.prototype,"view",void 0),a([l({readOnly:!0})],lt.prototype,"baseLayerViews",void 0),a([l({readOnly:!0})],lt.prototype,"referenceLayerViews",void 0),a([l({readOnly:!0})],lt.prototype,"suspended",null),a([l({type:Boolean,readOnly:!0})],lt.prototype,"updating",null),lt=a([I("esri.views.BasemapView")],lt);let Fu=class{constructor(e,t,s){this.layer=e,this.view=t,this.layerViewImporter=s,this._controller=new AbortController,this._deferred=Lo(),this._started=!1,this.done=!1,or(this._controller.signal,()=>{const n=new x("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:s}=this;t.emit("layerview-destroy",{view:s,layerView:e}),s.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,r;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:s}=this;this._map=s.map;try{let o,c;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)o=await t.createLayerView(s,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new x("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(t);_t(e),o="default"in u?new u.default({layer:t,view:s}):new u({layer:t,view:s})}const d=()=>{c=Mt(c),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};c=or(e,d),_t(e);try{await o.when()}catch(u){throw d(),u}if(!((r=(n=this._map)==null?void 0:n.allLayers)==null?void 0:r.includes(t)))return d(),void this._deferred.reject(new x("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=o,t.emit("layerview-create",{view:s,layerView:o}),s.emit("layerview-create",{layer:t,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){t.emit("layerview-create-error",{view:s,error:o}),s.emit("layerview-create-error",{layer:t,error:o}),this.done=!0,this._deferred.reject(new x("layerview:create-error","layerview creation failed",{layer:t,error:o}))}}},be=class extends S{constructor(i){super(i),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new Go,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var t;const e=(t=this.view.map)==null?void 0:t.allLayers;if(e)for(const s of e)this.layerViewImporter.hasLayerViewModule(s)&&this.layerViewImporter.importLayerView(s)},this._reschedule=()=>($(this._workPromise)&&(this._workPromise=Lo(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(bl(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var o,c,d;const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),$(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const t=[],s=h=>{if(!$(h))for(const u of h)u&&(t.push(u),this._createLayerView(u),"layers"in u&&u.layers&&s(u.layers))};for(const h of this._rootCollectionNames)s(this.get(h));this._refreshCollections();for(const[h,u]of this._layerLayerViewInfoMap)t.includes(h)||(this._layerLayerViewInfoMap.delete(u.layer),u.destroy());const n=t.filter(h=>h.type==="group").map(h=>h.layers),r=[(o=e==null?void 0:e.ground)==null?void 0:o.layers,(c=e==null?void 0:e.basemap)==null?void 0:c.baseLayers,(d=e==null?void 0:e.basemap)==null?void 0:d.referenceLayers,e==null?void 0:e.layers,...n].filter(h=>!!h);this.addHandles(r.map(h=>this._watchUpdatingTracking.addOnCollectionChange(()=>h,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([xe(()=>{var i,e;return(e=(i=this.view)==null?void 0:i.map)==null?void 0:e.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),v(()=>{const i=this.view,e=i==null?void 0:i.map;return[e==null?void 0:e.basemap,e==null?void 0:e.ground,e==null?void 0:e.layers,i==null?void 0:i.ready]},()=>this._reschedule(),Tt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,M(this._workPromise)&&(this._workPromise.reject(kl()),this._workPromise=null)}get _layersToLayerViews(){const i=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&i.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(i)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return M(this._workPromise)||this._watchUpdatingTracking.updating||ms(this._layerLayerViewInfoMap,i=>!i.done)}get updatingRemaining(){let i=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++i;return i}clear(){if(!this.destroyed){for(const i of this._layerLayerViewInfoMap.values())i.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(i){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(i))throw new x("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:i});return this._layerLayerViewInfoMap.get(i).promise}_refreshCollections(){for(const[i,e]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(i),this.get(e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(i,e,t){if(!i||!e)return void(e&&e.removeAll());let s=0;for(const n of i){const r=this._layerLayerViewInfoMap.get(n);if(!r||!r.layerView)continue;const o=r.layerView;o.layer=n,o.parent=t,e.getItemAt(s)!==o&&e.splice(s,0,o),n.layers&&this._populateLayerViewsOwners(n.layers,o.layerViews,o),s+=1}s<e.length&&e.splice(s,e.length)}_createLayerView(i){if(this._layerLayerViewInfoMap.has(i))return this.view.ready&&this._layerLayerViewInfoMap.get(i).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");i.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);const e=new Fu(i,this.view,this.layerViewImporter);e.promise.then(()=>this._refreshCollections(),t=>{t&&(So(t)||t.name==="cancelled:layerview-create")||R.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${i.title??"no title"}', id:'${i.id??"no id"}' of type '${i.type}'.`,{layer:i,error:t}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(i,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([l()],be.prototype,"_workPromise",void 0),a([l({readOnly:!0})],be.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],be.prototype,"_layersToLayerViews",null),a([l({readOnly:!0})],be.prototype,"_rootCollectionNames",null),a([l()],be.prototype,"layerViewImporter",void 0),a([l()],be.prototype,"supportsGround",void 0),a([l({readOnly:!0})],be.prototype,"updating",null),a([l({readOnly:!0})],be.prototype,"updatingRemaining",null),a([l({constructOnly:!0})],be.prototype,"view",void 0),be=a([I("esri.views.LayerViewManager")],be);const Ru=be;let _e=class extends S{constructor(e){super(e),this.factor=1.5,this.offset=ue(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([l({type:Number})],_e.prototype,"factor",void 0),a([l({nonNullable:!0})],_e.prototype,"offset",void 0),a([l()],_e.prototype,"position",void 0),a([l({type:Number,range:{min:0}})],_e.prototype,"size",void 0),a([l()],_e.prototype,"maskUrl",void 0),a([l()],_e.prototype,"maskEnabled",void 0),a([l()],_e.prototype,"overlayUrl",void 0),a([l()],_e.prototype,"overlayEnabled",void 0),a([l({readOnly:!0})],_e.prototype,"version",null),a([l({type:Boolean})],_e.prototype,"visible",void 0),_e=a([I("esri.views.Magnifier")],_e);const Aa=_e;let bi=class extends S{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(Fc.TEXTURE_UNLOAD))??Rc}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,s){const n=this.makeUid(e);let r=this._textureRequests.get(n);return r||(r={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:s},this._stage&&(this._stage.add(r.texture),this._stage.loadImmediate(r.texture)),this._textureRequests.set(n,r)),r.referenceCount++,{uid:n,texture:r.texture,release:()=>this._release(n)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return M(t)?`${e}.${t}px`:e}};a([l()],bi.prototype,"_frameTask",void 0),a([l()],bi.prototype,"updating",null),bi=a([I("esri.views.3d.support.TextureCollection")],bi);var ao;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(ao||(ao={}));const Pa=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],$a={};function Fa(i){return!!$a[i]}function Su(i){for(const e of i)if(!Fa(e))return!1;return!0}Pa.forEach(i=>{$a[i]=!0});let Lu=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:s},n)=>this.inputManager.installHandlers(n,[t],s))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,s,n){const r=Array.isArray(e)?e:e.split(",");if(!Su(r))return r.some(Fa)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,c;Array.isArray(t)?c=t:(o=t,c=[]),typeof s=="function"?o=s:n=s,n=n??yt.DEFAULT;const d=this._createUniqueGroupName(),h=new Du(this.view,r,c,o);this._handlers.set(d,{handler:h,priority:n});for(const u of r){const p=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,p+1)}return this.inputManager&&this.inputManager.installHandlers(d,[h],n),{remove:()=>this._removeHandler(d,r)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const s of t){const n=this._handlerCounts.get(s);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",s):n===1?this._handlerCounts.delete(s):this._handlerCounts.set(s,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Du=class extends X{constructor(e,t,s,n){super(!0),this.view=e;for(const r of t)switch(r){case"click":this.registerIncoming("click",s,o=>n(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",s,o=>n(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",s,o=>n(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",s,o=>n(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",s,o=>n(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",s,o=>{const c=this._wrapDrag(o);c&&n(c)});break;case"key-down":this.registerIncoming("key-down",s,o=>n(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",s,o=>n(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",s,o=>n(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",s,o=>n(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",s,o=>n(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",s,o=>n(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",s,o=>n(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",s,o=>n(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",s,o=>n(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",s,o=>{n(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",s,o=>{n(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",s,o=>{n(this._wrapBlur(o))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:s,buttons:n,x:r,y:o,native:c,eventId:d}=e.data,{cancelable:h,timestamp:u}=e;return{type:"click",pointerType:t,button:s,buttons:n,x:r,y:o,native:c,timestamp:u,screenPoint:ue(r,o),mapPoint:this._getMapPoint(r,o),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:r,y:o,native:c,eventId:d}=e.data,{cancelable:h,timestamp:u}=e;return{type:"double-click",pointerType:t,button:s,buttons:n,x:r,y:o,native:c,timestamp:u,mapPoint:this._getMapPoint(r,o),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:s,buttons:n,x:r,y:o,native:c,eventId:d}=e.data,h=c.pointerId,{cancelable:u,timestamp:p}=e;return{type:"immediate-click",pointerId:h,pointerType:t,button:s,buttons:n,x:r,y:o,native:c,timestamp:p,mapPoint:this._getMapPoint(r,o),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:r,y:o,native:c,eventId:d}=e.data,h=c.pointerId,{cancelable:u,timestamp:p}=e;return{type:"immediate-double-click",pointerId:h,pointerType:t,button:s,buttons:n,x:r,y:o,native:c,timestamp:p,mapPoint:this._getMapPoint(r,o),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:s,buttons:n,x:r,y:o,native:c}=e.data,{cancelable:d,timestamp:h}=e;return{type:"hold",pointerType:t,button:s,buttons:n,x:r,y:o,native:c,timestamp:h,mapPoint:this._getMapPoint(r,o),cancelable:d,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(ue(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:s,y:n}=t.center,{action:r,pointerType:o,button:c}=t;if(r==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const d=t.pointer.native,h=t.buttons,{cancelable:u,timestamp:p}=e,g={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return r==="end"&&(this._latestDragStart=void 0),{type:"drag",action:r,x:s,y:n,origin:g,pointerType:o,button:c,buttons:h,radius:t.radius,angle:Zl(t.angle),native:d,timestamp:p,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:s,native:n}=e.data,{cancelable:r,timestamp:o}=e;return{type:"key-down",key:t,repeat:s,native:n,timestamp:o,cancelable:r,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:s}=e.data,{cancelable:n,timestamp:r}=e;return{type:"key-up",key:t,native:s,timestamp:r,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:s,y:n,button:r,buttons:o,native:c,eventId:d}=e.data,h=c.pointerId,u=c.pointerType,{cancelable:p,timestamp:g}=e;return{type:t,x:s,y:n,pointerId:h,pointerType:u,button:r,buttons:o,native:c,timestamp:g,eventId:d,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:s,buttons:n,native:r,eventId:o}=e.data.currentEvent,{button:c}=e.data.startEvent,d=e.data.startEvent.native.pointerId,h=e.data.startEvent.native.pointerType,u=e.data.action,p={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:g,timestamp:f}=e;return{type:"pointer-drag",x:t,y:s,pointerId:d,pointerType:h,button:c,buttons:n,action:u,origin:p,native:r,timestamp:f,eventId:o,cancelable:g,stopPropagation:()=>e.stopPropagation(),async:y=>e.async(y),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:s,timestamp:n}=e,{x:r,y:o,deltaY:c,native:d}=s;return{type:"mouse-wheel",x:r,y:o,deltaY:c,native:d,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:s,device:n}=e.data,{cancelable:r,timestamp:o}=e,{buttons:c,axes:d}=s;return{type:"gamepad",device:n,timestamp:o,action:t,buttons:c,axes:d,cancelable:r,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}};var $i,lo,co;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})($i||($i={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(lo||(lo={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(co||(co={}));function Ou(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return R.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function _n(i){return i.visible&&i.getEditableFlag($i.USER)&&i.getEditableFlag($i.MANAGER)}function Re(i){return ue(i.x,i.y)}function Ra(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return ue(e.clientX-t.left,e.clientY-t.top)}function ho(i,e){return e instanceof Event?Ra(i,e):Re(e)}function uo(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let Vu=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const s=()=>e.stopPropagation();switch(e.type){case"pointer-move":po(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!mo(e))break;const n=Re(e),r=this._intersect(n,e.pointerType,t.forEachTool);if($(r))break;const o=r.manipulator,c=r.tool;!(M(o)&&M(c)&&o.interactive)||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,e,t),M(o)&&M(c)&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:c,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&$(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(r.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),s());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!mo(e))break;const n=this._grabbedManipulators.get(e.pointerId),r=yi(n,({manipulator:u})=>u),o=yi(n,({tool:u})=>u);if($(r)||$(o))break;const c=Re(e);c.x=oi(c.x,0,t.view.width),c.y=oi(c.y,0,t.view.height);const d=ye(n).start,h=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(r.dragging=!0,h?r.events.emit("drag",{action:"update",start:d,screenPoint:c}):r.events.emit("drag",{action:"start",start:d,screenPoint:c,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:r,start:d}));break;case"end":r.dragging=!1,h&&r.events.emit("drag",{action:"end",start:d,screenPoint:c}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}s();break}case"immediate-click":{const n=Re(e),r=this._intersect(n,e.pointerType,t.forEachTool);if(Nu(e)||t.forEachTool(h=>{if((!M(r)||r.tool!==h||h.automaticManipulatorSelection)&&h.manipulators){let u=!1;h.manipulators.forEach(({manipulator:p})=>{p.selected&&(p.selected=!1,u=!0)}),u&&h.onManipulatorSelectionChanged&&h.onManipulatorSelectionChanged()}}),$(r))break;const{manipulator:o,tool:c}=r;if(!o.interactive)break;o.selectable&&c.automaticManipulatorSelection&&(o.selected=!o.selected,c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged());const d=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:d,stopPropagation:s});break}case"click":{const n=Re(e),r=this._intersect(n,e.pointerType,t.forEachTool),o=M(r)?r.manipulator:null;if($(o)||!o.interactive)break;const c=e.native.shiftKey;o.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:c}),s();break}case"double-click":{const n=Re(e),r=this._intersect(n,e.pointerType,t.forEachTool),o=M(r)?r.manipulator:null;if($(o)||!o.interactive)break;const c=e.native.shiftKey;o.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:s});break}case"immediate-double-click":{const n=Re(e),r=this._intersect(n,e.pointerType,t.forEachTool),o=M(r)?r.manipulator:null;if($(o)||!o.interactive)break;const c=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:s});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,s){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Re(t)}),this._grabbedManipulators.forEach(({manipulator:n},r)=>{n===e&&this._grabbedManipulators.delete(r)}),this._afterManipulatorUngrab(s.setActiveTool)}_handlePointerEnd(e,t){const s=yi(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);$(s)||s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Re(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return ms(e,({manipulator:s})=>!($(s)||!s.interactive)&&(s.grabbing&&s.grabCursor?(t=s.grabCursor,!0):!!s.cursor&&(t=s.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,s=new Set;this._grabbedManipulators.forEach(({tool:n})=>{t.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{s.add(n)}),e(n=>{n.hasGrabbedManipulators=t.has(n),n.hasHoveredManipulators=s.has(n);const r=this._grabbedManipulators.values(),o=Ml(r,({tool:c})=>c===n);n.firstGrabbedManipulator=M(o)?o.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:s},n=!0,r){const o=(c,d)=>c===e&&($(r)||r===d);this._grabbedManipulators.forEach(({tool:c,manipulator:d,pointerType:h},u)=>{o(c,d)&&(this._grabbedManipulators.delete(u),d.grabbing=!1,d.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:h}))}),this._draggedManipulators.forEach(({tool:c,manipulator:d},h)=>{o(c,d)&&(this._draggedManipulators.delete(h),d.dragging=!1,d.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:c,manipulator:d},h)=>{o(c,d)&&(this._hoveredManipulators.delete(h),d.hovering=!1)}),this._afterManipulatorUngrab(s),this._onFocusChange(t)}_intersect(e,t,s){let n=null;return s(r=>{if(r.manipulators==null||!_n(r))return!1;const o=r.manipulators.intersect(e,t);return!$(o)&&(n={tool:r,manipulator:o},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,s)=>{this._updateHoveredStateForPointerAtScreenPosition(ue(t.x,t.y),s,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!po(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Re(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,s,n){let r=this._intersect(e,s,n);const o=yi(this._hoveredManipulators.get(t),({manipulator:c})=>c);M(r)&&!r.manipulator.interactive&&(r=null),M(r)&&o===r.manipulator||(M(o)&&(o.hovering=!1),M(r)?(r.manipulator.hovering=!0,this._hoveredManipulators.set(t,r)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function po(i){return i==="mouse"}function mo(i){return i.pointerType!=="mouse"||i.button===0}function Nu(i){return!!i.native.shiftKey}const go="attached",Gs="tools";let Ge=class extends Wo{constructor(e){super(e),this._manipulatorState=new Vu,this.tools=new H,this.cursor=null,this._forEachTool=t=>{for(const s of this.tools.items)if(t(s))return}}initialize(){this.handles.add([this.view.on(Pa,e=>{this._handleInputEvent(e)},yt.TOOL),...Ou(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(M(e)&&!this.view.ready)return void R.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),M(t)&&t.deactivate(),M(e)&&e.activate(),this._removeIncompleteTools(e);for(const s of this.tools){this._updateToolEditableFlag(s);const n=_n(s);!$(this.activeTool)&&n||this._manipulatorState.clearPointers(s,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new bi(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([v(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),Ro(()=>this._set("textures",le(this.textures)))],go)):this.handles.add(v(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){M(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(go)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:s})=>e(s,t))})}_handleInputEvent(e){let t=!1;const s={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};M(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(s):this._forEachTool(n=>{!t&&n.visible&&n.handleInputEvent(s)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(s,this._manipulatorStateEventArgs),!t&&M(this.activeTool)&&this.activeTool.handleInputEventAfter(s),this._manipulatorState.handleHoverEvent(s,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(Gs),this._forEachTool(e=>{if(e instanceof S){const t=v(()=>[e.cursor,e.visible,e.editable],()=>{_n(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,Gs)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Gs)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag($i.MANAGER,$(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;$(e)&&this._forEachTool(t=>!(!M(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>($(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};a([l({constructOnly:!0,nonNullable:!0})],Ge.prototype,"view",void 0),a([l({readOnly:!0,nonNullable:!0})],Ge.prototype,"textures",void 0),a([l({value:null})],Ge.prototype,"activeTool",null),a([l({readOnly:!0,type:H})],Ge.prototype,"tools",void 0),a([l({readOnly:!0})],Ge.prototype,"cursor",void 0),a([l({readOnly:!0})],Ge.prototype,"updating",null),Ge=a([I("esri.views.ToolViewManager")],Ge);const zu=Ge;let Zt=class extends S{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Bu.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return qu[this.deviceType]}};a([l({nonNullable:!0,readOnly:!0})],Zt.prototype,"nativeIndex",void 0),a([l({type:String,readOnly:!0})],Zt.prototype,"deviceType",null),a([l({type:Number,readOnly:!0})],Zt.prototype,"axisThreshold",null),Zt=a([I("esri.views.input.gamepad.GamepadInputDevice")],Zt);const Bu=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),qu={standard:.15,spacemouse:.025,unknown:0},Wn=Zt;let Mi=class extends S{constructor(...e){super(...e),this.devices=new H,this.enabledFocusMode="document"}};a([l({type:H.ofType(Wn),readOnly:!0})],Mi.prototype,"devices",void 0),a([l({type:["document","view","none"]})],Mi.prototype,"enabledFocusMode",void 0),Mi=a([I("esri.views.input.gamepad.GamepadSettings")],Mi);const Uu=Mi;let Ki=class extends S{constructor(){super(...arguments),this.gamepad=new Uu}};a([l({readOnly:!0})],Ki.prototype,"gamepad",void 0),Ki=a([I("esri.views.input.Input")],Ki);const Hu=Ki;let ct=class extends S{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([l({type:Boolean,nonNullable:!0})],ct.prototype,"enabled",void 0),a([l({type:Wn})],ct.prototype,"device",void 0),a([l({type:["pan","zoom"],nonNullable:!0})],ct.prototype,"mode",void 0),a([l({type:["forward-down","forward-up"],nonNullable:!0})],ct.prototype,"tiltDirection",void 0),a([l({type:Number,nonNullable:!0})],ct.prototype,"velocityFactor",void 0),ct=a([I("esri.views.navigation.gamepad.GamepadSettings")],ct);const Sa=ct;let kt=class extends S{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Sa,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};a([l({type:Boolean})],kt.prototype,"browserTouchPanEnabled",void 0),a([l({type:Sa,nonNullable:!0})],kt.prototype,"gamepad",void 0),a([l({type:Boolean})],kt.prototype,"momentumEnabled",void 0),a([l({type:Boolean})],kt.prototype,"mouseWheelZoomEnabled",void 0),kt=a([I("esri.views.navigation.Navigation")],kt);const La=kt;var fo;function Gu(i){var s;const e=i.url?Nc(i.url):void 0;return!(((s=i.spatialReference)==null?void 0:s.vcsWkid)==null&&M(e)&&e.serverType==="ImageServer")&&Da(i)&&i.heightModelInfo?i.heightModelInfo:Wu(i)?Ln.deriveUnitFromSR(Zu,i.spatialReference):null}function Da(i){return"heightModelInfo"in i}function Oa(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function Wu(i){return Oa(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):Va(i)}function ju(i){return i.layers!=null||Va(i)||Oa(i)||Da(i)}function Va(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(fo||(fo={}));const Zu=new Ln({heightModel:"gravity-related-height"});let yn,Ws=null;async function Ku(i){Ws||(Ws=w(()=>import("./geometryServiceUtils-ea4423f2.js"),["assets/geometryServiceUtils-ea4423f2.js","assets/Error-bd05b442.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/Portal-ac0dca24.js","assets/preload-helper-101896b7.js","assets/cast-daef7652.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/request-c2b0ab45.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/Extent-7f29a1bb.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/jsonMap-a9c94baf.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/Polyline-c56eca9b.js","assets/normalizeUtils-d322ac85.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js"]).then(e=>yn=e)),await Ws,_t(i)}async function Na(i,e,t,s){if(!i)return null;const n=i.spatialReference;return Ai()||_s(n,e)?Ri(i,e):yn?yn.projectGeometry(i,e,t,s):(await Promise.race([Ku(s),ys(s)]),Na(i,e,t,s))}let V=class extends S{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=nn(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return M(this.userSpatialReference)?this.userSpatialReference:ye(this._spatialReferenceTask.spatialReference)}get extent(){return ye(this._extentTask.extent)}get heightModelInfo(){return ye(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return ye(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return ye(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return $(this.userSpatialReference)||this.userSpatialReference.equals(ye(this._spatialReferenceTask.spatialReference))?ye(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return ye(this._tileInfoTask.tileInfo)}get mapCollections(){var s,n,r,o;const e=(s=this.map)==null?void 0:s.call(this),t=[];return M(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(r=e==null?void 0:e.ground)==null?void 0:r.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let s=null;for(const r of e){const o=this._getSupportedSpatialReferences(r);if(o.length>0){const c=this._narrowDownSpatialReferenceCandidates(s,o);M(c)&&(s=c)}if(M(s)&&s.length===1)break}if(t&&($(s)||s.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(s);return{spatialReference:M(n)?n.spatialReference:null,viewingMode:M(n)?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var s,n,r,o,c,d,h;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(s=this.map)==null?void 0:s.call(this))==null?void 0:n.basemap,layers:(c=(o=(r=this.map)==null?void 0:r.call(this))==null?void 0:o.basemap)==null?void 0:c.baseLayers},{layers:(h=(d=this.map)==null?void 0:d.call(this))==null?void 0:h.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var s,n,r;if(!this.required.heightModelInfo||this.suspended&&((s=this._get("_heightModelInfoTask"))!=null&&s.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const o of e)if(ju(o)){const c=Gu(o);if(c)return{heightModelInfo:c,vcsWkid:(n=o.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(r=o.spatialReference)==null?void 0:r.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,s=[];for(const n of e.layers){const r="fullExtents"in n&&n.fullExtents||(M(n.fullExtent)?[n.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:r[0],c=r.find(d=>d.spatialReference.equals(this.spatialReference))??o;if(c)return{candidates:[{extent:c,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const d of r)s.push({extent:d,layer:n})}return{candidates:s,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if($(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const s=this._pickExtentCandidate(e),n=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:M(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(M(this._projectExtentTask.task)&&(this._projectExtentTask.task=nn(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:n.clone(),task:ta(async r=>{try{const o=await Na(s.extent,n,s.layer.portalItem,r);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(Al(r))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if($(e))return t;const s=[],n=(r,o)=>M(r)?M(o)?r===o&&r:r:o;for(const r of e)for(const o of t){if(!r.spatialReference.equals(o.spatialReference))continue;const c=n(r.viewingMode,o.viewingMode);if(c!==!1){s.push({spatialReference:r.spatialReference,viewingMode:c});break}}return s.length>0?s:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return $(e)||e.length<1?M(t)?{spatialReference:t,viewingMode:null}:null:(M(t)&&e.length>1&&e.some(({spatialReference:s})=>s.equals(t))&&(e=e.filter(({spatialReference:s})=>s.equals(t))),e.length>1&&e.some(({viewingMode:s})=>s!==_r.Local)&&(e=e.filter(({viewingMode:s})=>s!==_r.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const s=[];for(const n of t){const r=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(M(r)){const o=M(r.constraints)?r.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:c,viewingMode:d}of o)(!this.requiresExtentInSpatialReference||$(this.userSpatialReference)||c.equals(this.userSpatialReference))&&s.push({spatialReference:c,viewingMode:d})}}return s}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:s})=>t.equals(s.spatialReference))||e[0]}_collectLayers(e){var s;if(this._loadMaybe((s=this.map)==null?void 0:s.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const n of e)if(this._collectCollection(n,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const s of e.layers){switch(this._loadMaybe(s)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(s),"layers"in s&&this._collectCollection({layers:s.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};a([l()],V.prototype,"required",void 0),a([l({constructOnly:!0})],V.prototype,"map",void 0),a([l({constructOnly:!0})],V.prototype,"getSpatialReferenceSupport",void 0),a([l()],V.prototype,"defaultSpatialReference",void 0),a([l()],V.prototype,"userSpatialReference",void 0),a([l()],V.prototype,"sourcePreloadCount",void 0),a([l()],V.prototype,"priorityCollection",void 0),a([l()],V.prototype,"requiresExtentInSpatialReference",void 0),a([l()],V.prototype,"suspended",void 0),a([l({readOnly:!0})],V.prototype,"ready",null),a([l({readOnly:!0})],V.prototype,"heightModelInfoReady",null),a([l({readOnly:!0})],V.prototype,"spatialReference",null),a([l({readOnly:!0})],V.prototype,"extent",null),a([l({readOnly:!0})],V.prototype,"heightModelInfo",null),a([l({readOnly:!0})],V.prototype,"vcsWkid",null),a([l({readOnly:!0})],V.prototype,"latestVcsWkid",null),a([l({readOnly:!0})],V.prototype,"viewingMode",null),a([l({readOnly:!0})],V.prototype,"tileInfo",null),a([l({readOnly:!0})],V.prototype,"mapCollections",null),a([l({readOnly:!0})],V.prototype,"_allLayers",null),a([l({readOnly:!0})],V.prototype,"_spatialReferenceTask",null),a([l({readOnly:!0})],V.prototype,"_tileInfoTask",null),a([l({readOnly:!0})],V.prototype,"_heightModelInfoTask",null),a([l({readOnly:!0})],V.prototype,"_extentCandidatesTask",null),a([l()],V.prototype,"_extentTask",null),a([l()],V.prototype,"_projectExtentTask",void 0),V=a([I("esri.views.support.DefaultsFromMap")],V);var Yi;let k=Yi=class extends vs(fs.EventedMixin(Dc(S))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new is({getCollections:()=>{var e,t,s;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new ia,this.analyses=new us,this.typeSpecificPreconditionsReady=!0,this.layerViews=new H,this.magnifier=new Aa,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Hu,this.navigation=new La,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Lu(this),this.persistableViewModels=new H,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(v(()=>this.preconditionsReady,e=>{var t,s;e?(this._currentSpatialReference=this.spatialReference,Yi.views.add(this)):(this._currentSpatialReference=null,Yi.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),M(this.analysisViewManager)&&this.analysisViewManager.detach(),(s=this.layerViewManager)==null||s.clear(),this._teardown()):e&&!this.ready&&(this._startup(),M(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ki))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,$n(()=>this.ready)))),this.basemapView=new lt({view:this}),this.layerViewManager=new Ru({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new zu({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([v(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),v(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),v(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([v(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var s;const t=((s=this.map)==null?void 0:s.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(M(i))return;const n=Ro(()=>i=nn(i));i=ta(async r=>{try{await An(this.spatialReferenceWarningDelay,null,r)}catch{return}finally{i=null}R.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=le(this.graphics),this.analyses=le(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),le(this.analysisViewManager),this.toolViewManager=le(this.toolViewManager),this.layerViewManager=le(this.layerViewManager),this.basemapView=le(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return R.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new V({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||sn.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(R.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),sn.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!gs(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return M(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new x("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return M(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&R.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(Xe(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};k.views=new H,a([l()],k.prototype,"_userSpatialReference",void 0),a([l()],k.prototype,"activeTool",null),a([l({readOnly:!0})],k.prototype,"allLayerViews",void 0),a([l()],k.prototype,"groundView",void 0),a([l()],k.prototype,"animation",null),a([l()],k.prototype,"basemapView",void 0),a([l({readOnly:!0})],k.prototype,"_defaultsFromMapSettings",null),a([l()],k.prototype,"defaultsFromMap",null),a([l()],k.prototype,"fatalError",void 0),a([l({type:ai})],k.prototype,"extent",null),a([l(fr(ia,"graphics"))],k.prototype,"graphics",void 0),a([l(fr(us,"analyses"))],k.prototype,"analyses",void 0),a([l({readOnly:!0,type:Ln})],k.prototype,"heightModelInfo",null),a([l({readOnly:!0})],k.prototype,"interacting",null),a([l({readOnly:!0})],k.prototype,"navigating",null),a([l({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],k.prototype,"preconditionsReady",null),a([l({readOnly:!0})],k.prototype,"typeSpecificPreconditionsReady",void 0),a([l({type:H,readOnly:!0})],k.prototype,"layerViews",void 0),a([l({type:Aa})],k.prototype,"magnifier",void 0),a([l({value:null,type:ra})],k.prototype,"map",null),a([l()],k.prototype,"padding",void 0),a([l({readOnly:!0})],k.prototype,"ready",void 0),a([l({type:Pn})],k.prototype,"spatialReference",null),a([l()],k.prototype,"spatialReferenceWarningDelay",void 0),a([l()],k.prototype,"stationary",null),a([l({readOnly:!0})],k.prototype,"supportsGround",void 0),a([l({type:Sc})],k.prototype,"timeExtent",void 0),a([l()],k.prototype,"tools",null),a([l()],k.prototype,"toolViewManager",void 0),a([l({readOnly:!0})],k.prototype,"type",void 0),a([l({type:Number})],k.prototype,"scale",void 0),a([l({readOnly:!0})],k.prototype,"updating",void 0),a([l({readOnly:!0})],k.prototype,"initialExtentRequired",void 0),a([l({readOnly:!0})],k.prototype,"initialExtent",null),a([l()],k.prototype,"cursor",null),a([l({readOnly:!0})],k.prototype,"input",void 0),a([l({type:La,nonNullable:!0})],k.prototype,"navigation",void 0),a([l()],k.prototype,"layerViewManager",void 0),a([l()],k.prototype,"analysisViewManager",void 0),a([l()],k.prototype,"width",void 0),a([l()],k.prototype,"height",void 0),a([l({readOnly:!0})],k.prototype,"resizing",void 0),a([l({value:null,readOnly:!0})],k.prototype,"size",null),a([l({readOnly:!0})],k.prototype,"suspended",void 0),a([l({readOnly:!0})],k.prototype,"viewEvents",void 0),a([l({readOnly:!0})],k.prototype,"persistableViewModels",void 0),a([l()],k.prototype,"_isValid",void 0),a([l()],k.prototype,"_readyCycleForced",void 0),a([l()],k.prototype,"_currentSpatialReference",void 0),k=Yi=a([I("esri.views.View")],k);const Yu=k;let dt=class extends Oc{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new x("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=Pl(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};a([l({readOnly:!0})],dt.prototype,"done",null),a([l({readOnly:!0,type:String})],dt.prototype,"state",void 0),a([l()],dt.prototype,"target",void 0),dt=a([I("esri.views.ViewAnimation")],dt),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(dt||(dt={}));const vn=dt;function vt(){return[1,0,0,1,0,0]}function Qu(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function Xu(i,e,t,s,n,r){return[i,e,t,s,n,r]}function Ju(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:vt,clone:Qu,fromValues:Xu,createView:Ju},Symbol.toStringTag,{value:"Module"}));const za=96,Ba=39.37,ep=180/Math.PI;function qa(i){return i.wkid?i:i.spatialReference||Pn.WGS84}function jn(i,e){return e.type?te(i,e.x,e.y):os(i,e)}function Ua(i){return nc(i)}function xi(i,e){const t=Math.max(1,e[0]),s=Math.max(1,e[1]);return Math.max(i.width/t,i.height/s)*cp(i.spatialReference)}async function Ii(i,e,t,s){let n,r;if(!i||Array.isArray(i)&&!i.length)return null;if(H.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const c=i.every(u=>"attributes"in u),d=i.some(u=>!u.geometry);let h=i;if(c&&d&&e&&e.allLayerViews){const u=new Map;for(const y of i){const T=y.layer,C=u.get(T)||[],P=y.attributes[T.objectIdField];P!=null&&C.push(P),u.set(T,C)}const p=[];u.forEach((y,T)=>{const C=e.allLayerViews.find(P=>P.layer.id===T.id);if("queryFeatures"in C){const P=T.createQuery();P.objectIds=y,P.returnGeometry=!0,p.push(C.queryFeatures(P))}});const g=await Promise.all(p),f=[];for(const y of g)if(y&&y.features&&y.features.length)for(const T of y.features)M(T.geometry)&&f.push(T.geometry);h=f}for(const u of h)s=await Ii(u,e,t,s);return s}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")n=new K(i);else if(i instanceof Rl)n=i;else if("geometry"in i){if(i.geometry)n=i.geometry;else if(i.layer){const c=i.layer,d=e.allLayerViews.find(h=>h.layer.id===c.id);if("queryFeatures"in d){const h=c.createQuery();h.objectIds=[i.attributes[c.objectIdField]],h.returnGeometry=!0;const u=await d.queryFeatures(h);n=Nl(u,"features",0,"geometry")}}}if($(n)||(r=n.type==="point"?new ai({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!r))return null;Ai()||_s(r.spatialReference,t)||await ys();const o=Ri(r,t);return o?s=s?s.union(o):o:null}function tp(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const s of i){const n=s.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,t=n.maxScale>t?n.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function js(i,e){return gs(qa(i),e)?i:Ri(i,e)}async function ip(i,e){if(!i||!e)return new Ve({targetGeometry:new K,scale:0,rotation:0});let t=e.spatialReference;const{constraints:s,padding:n,viewpoint:r,size:o}=e,c=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let d=null;i instanceof Ve?d=i:i.viewpoint?d=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(d=i.target);let h=null;d&&d.targetGeometry?h=d.targetGeometry:i instanceof ai?h=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(h=await Ii(i.center,e,t)||await Ii(i.extent,e,t)||await Ii(i.target,e,t)||await Ii(i,e,t)),!h&&r&&r.targetGeometry?h=r.targetGeometry:!h&&e.extent&&(h=e.extent),t||(t=qa(e.spatialReference||e.extent||h)),Ai()||gs(h.spatialReference,t)||_s(h,t)||await ys();const u=js(h.center?h.center:h,t);let p=null;if(d&&M(d.targetGeometry)&&d.targetGeometry.type==="point")p=d.scale;else if("scale"in i&&i.scale)p=i.scale;else if("zoom"in i&&i.zoom!==-1&&s&&s.effectiveLODs)p=s.zoomToScale(i.zoom);else if(Array.isArray(h)||h.type==="point"||h.type==="extent"&&h.width===0&&h.height===0){const T=js(e.extent,t);p=M(T)?xi(T,c):e.extent?xi(e.extent,c):r.scale}else p=xi(js(h.extent,t),c);const g=tp(i);g&&(g.min&&g.min>p?p=g.min:g.max&&g.max<p&&(p=g.max));let f=0;d?f=d.rotation:i.hasOwnProperty("rotation")?f=i.rotation:r&&(f=r.rotation);let y=new Ve({targetGeometry:u,scale:p,rotation:f});return s&&(y=s.fit(y),s.constrainByGeometry(y),s.rotationEnabled||(y.rotation=f)),y}function ke(i,e){const t=i.targetGeometry,s=e.targetGeometry;return t.x=s.x,t.y=s.y,t.spatialReference=s.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function sp(i,e,t){return t?te(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):ws(i,e,.5)}const np=function(){const i=Q();return function(e,t,s){const n=t.targetGeometry;jn(i,n);const r=.5*li(t);return e.xmin=i[0]-r*s[0],e.ymin=i[1]-r*s[1],e.xmax=i[0]+r*s[0],e.ymax=i[1]+r*s[1],e.spatialReference=n.spatialReference,e}}();function rp(i,e,t,s,n){return wn(i,e,t.center),i.scale=xi(t,s),n&&n.constraints&&n.constraints.constrain(i),i}function op(i,e,t,s){return Yn(i,e,t,s),ea(i,i)}const Ha=function(){const i=Q();return function(e,t,s){return na(e,dp(e,t),sp(i,t,s))}}(),ap=function(){const i=vt(),e=Q();return function(t,s,n,r){const o=li(s),c=Zn(s);return te(e,o,o),Ac(i,e),Sn(i,i,c),rs(i,i,Ha(e,n,r)),rs(i,i,[0,r.top-r.bottom]),te(t,i[4],i[5])}}();function li(i){return i.scale*lp(i.targetGeometry)}function lp(i){return M(i)&&No(i.spatialReference)?1/(Ua(i.spatialReference)*Ba*za):1}function Zn(i){return sa(i.rotation)||0}function cp(i){return No(i)?Ua(i)*Ba*za:1}function dp(i,e){return ws(i,e,.5)}const Kn=function(){const i=Q(),e=Q(),t=Q();return function(s,n,r,o,c,d){return Uc(i,n),ws(e,r,.5*d),te(t,1/o*d,-1/o*d),Jo(s,e),c&&Sn(s,s,c),Xo(s,s,t),rs(s,s,i),s}}(),Yn=function(){const i=Q();return function(e,t,s,n){const r=li(t),o=Zn(t);return jn(i,t.targetGeometry),Kn(e,i,s,r,o,n)}}(),hp=function(){const i=Q();return function(e,t,s,n){const r=li(t);return jn(i,t.targetGeometry),Kn(e,i,s,r,0,n)}}();function up(i){const e=Sl(i);return e?e.valid[1]-e.valid[0]:0}function pp(i,e){return Math.round(up(i)/e)}const mp=function(){const i=Q(),e=Q(),t=[0,0,0];return function(s,n,r){ln(i,s,n),yr(i,i),ln(e,s,r),yr(e,e),Bc(t,i,e);let o=Math.acos(qc(i,e)/(vr(i)*vr(e)))*ep;return t[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),gp=function(){const i=Q();return function(e,t,s,n){const r=e.targetGeometry;return ke(e,t),ap(i,t,s,n),r.x+=i[0],r.y+=i[1],e}}(),wn=function(i,e,t){ke(i,e);const s=i.targetGeometry;return s.x=t.x,s.y=t.y,s.spatialReference=t.spatialReference,i},fp=function(){const i=Q();return function(e,t,s,n,r){r||(r="center"),na(i,s,n),ws(i,i,.5);const o=i[0],c=i[1];switch(r){case"center":te(i,0,0);break;case"left":te(i,-o,0);break;case"top":te(i,0,c);break;case"right":te(i,o,0);break;case"bottom":te(i,0,-c);break;case"top-left":te(i,-o,c);break;case"bottom-left":te(i,-o,-c);break;case"top-right":te(i,o,c);break;case"bottom-right":te(i,o,-c)}return Ts(e,t,i),e}}();function Sy(i,e,t){return ke(i,e),i.rotation+=t,i}function _p(i,e,t){return ke(i,e),i.rotation=t,i}const yp=function(){const i=Q();return function(e,t,s,n,r){return ke(e,t),isNaN(s)||s===0||(Wa(i,n,t,r),e.scale=t.scale*s,ja(i,i,e,r),Ts(e,e,te(i,i[0]-n[0],n[1]-i[1]))),e}}();function _o(i,e,t){return ke(i,e),i.scale=t,i}const Ga=function(){const i=Q();return function(e,t,s,n,r,o){return ke(e,t),isNaN(s)||s===0||(Wa(i,r,t,o),e.scale=t.scale*s,e.rotation+=n,ja(i,i,e,o),Ts(e,e,te(i,i[0]-r[0],r[1]-i[1]))),e}}(),Ly=function(){const i=Q(),e=Q();return function(t,s,n,r,o,c,d){return Ha(e,c,d),Hc(i,o,e),r?Ga(t,s,n,r,i,c):yp(t,s,n,i,c)}}(),Wa=function(){const i=vt();return function(e,t,s,n){return Ke(e,t,op(i,s,n,1))}}(),ja=function(){const i=vt();return function(e,t,s,n){return Ke(e,t,Yn(i,s,n,1))}}(),Ts=function(){const i=Q(),e=vt();return function(t,s,n){ke(t,s);const r=li(s),o=t.targetGeometry;return kc(e,Zn(s)),Xo(e,e,Wc(r,r)),Ke(i,n,e),o.x+=i[0],o.y+=i[1],t}}();let vp=class{constructor(e,t,s,n){const r=e.targetGeometry,o=t.targetGeometry;n?typeof n=="string"&&(n=zc(n)||an.ease):n=an.ease,this.easing=n,this.duration=s,this.sCenterX=r.x,this.sCenterY=r.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const s=this.easing(t);let n,r,o,c;t>=1?(n=this.tCenterX,r=this.tCenterY,o=this.tRotation,c=this.tScale):(n=this.sCenterX+s*this.dCenterX,r=this.sCenterY+s*this.dCenterY,o=this.sRotation+s*this.dRotation,c=this.sScale+s*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=r,e.scale=c,e.rotation=o}},We=class extends S{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=an.ease,this.view=null,this.viewpoint=null,this.viewpoint=new Ve({targetGeometry:new K,scale:0,rotation:0}),this._updateTask=ni({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,s){this.stop();const n=this.viewpoint;ke(n,t),this.transition=new vp(this.viewpoint,e.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const r=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const s=new vn({target:e.clone()}),n=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return s.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==vn.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const s=(performance.now()-this._startTime)/this.transition.duration,n=s>=1;this.transition.applyRatio(this.viewpoint,s),n&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};a([l()],We.prototype,"animation",void 0),a([l()],We.prototype,"duration",void 0),a([l()],We.prototype,"transition",void 0),a([l()],We.prototype,"easing",void 0),a([l()],We.prototype,"view",void 0),a([l()],We.prototype,"viewpoint",void 0),We=a([I("esri.views.2d.AnimationManager")],We);const wp=We;let bp=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:s,labelManager:n,layerViews:r,state:{id:o}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),r.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),M(n)&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),M(s)&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=v(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=ni(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,s=e.lastUpdateId;s!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),s!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function Z(){return Promise.all([w(()=>import("./webglDeps-a4f110e1.js"),["assets/webglDeps-a4f110e1.js","assets/VertexArrayObject-8a5c7580.js","assets/Error-bd05b442.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/Texture-6f3336a0.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-cb6895d7.js","assets/enums-64ab819c.js","assets/ProgramTemplate-66c62c24.js","assets/programUtils-663da5ee.js"]),w(()=>import("./mapViewDeps-3a10fa17.js"),["assets/mapViewDeps-3a10fa17.js","assets/Error-bd05b442.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/cast-daef7652.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-f64c5776.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/mathUtils-daf59e84.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/BufferPool-c496e3db.js","assets/WGLContainer-db0ff963.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-663da5ee.js","assets/RenderingContext-7629f78b.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-f5d9de07.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-c27e6a55.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/assets-4cb15247.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/persistableUrlUtils-7e525def.js","assets/styleUtils-84c98663.js","assets/CircularArray-d560a86f.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-78d35324.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-996bdb9a.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/SimpleObservable-7c382d01.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/fieldUtils-021fea8a.js","assets/Symbol-f45dc441.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/Collection-e2259e32.js","assets/collectionUtils-09289d8f.js","assets/labelUtils-4072dca9.js","assets/jsonUtils-f34afef9.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/capabilities-320386e9.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/PopupTemplate-343851b8.js","assets/number-53937715.js","assets/Identifiable-e3a09883.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/Graphic-cf98a91a.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-98f52808.js","assets/asyncUtils-59234081.js","assets/requestImageUtils-39957a4b.js","assets/Basemap-8691c5d8.js","assets/loadAll-6dec1444.js","assets/PortalItem-07c1e88d.js","assets/messages-03a939ad.js","assets/writeUtils-7d75cb47.js","assets/layerUtils-6996b9ea.js","assets/CollectionFlattener-c6dafa4a.js","assets/TablesMixin-c836f156.js","assets/Layer-8a472a77.js","assets/Cyclical-1a93cb12.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/intl-afc91037.js","assets/TileInfo-2e5a94dc.js","assets/widget-8a5f4608.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-1890fc00.js","assets/query-e9f3f48f.js","assets/pbfQueryUtils-21bc0894.js","assets/queryZScale-bb883c00.js","assets/FeatureSet-9ea00c01.js","assets/RelationshipQuery-c22f6308.js","assets/utils-95450d21.js","assets/ItemCache-9a7b0057.js","assets/TopFeaturesQuery-da583ecc.js","assets/FeatureLayer-029b8c63.js","assets/MultiOriginJSONSupport-03b5d89b.js","assets/FeatureLayerBase-eb47a35c.js","assets/HeightModelInfo-15bb1adf.js","assets/arcgisLayerUrl-269cc7a9.js","assets/editsZScale-b69b4057.js","assets/APIKeyMixin-abc940e1.js","assets/ArcGISService-a76daa10.js","assets/CustomParametersMixin-35ce1754.js","assets/EditBusLayer-0384e3a7.js","assets/OrderedLayer-f1fc272b.js","assets/PortalLayer-4d594091.js","assets/RefreshableLayer-b2e977af.js","assets/ScaleRangeLayer-d12362d4.js","assets/TemporalLayer-e6ec9fbe.js","assets/TimeInfo-cbe37d4e.js","assets/FeatureTemplate-a0acfd3d.js","assets/FeatureType-1ca0df1a.js","assets/fieldProperties-6efd2194.js","assets/versionUtils-95cac3d6.js","assets/styleUtils-77b2285b.js","assets/popupUtils-aa41216c.js","assets/Scheduler-74975675.js","assets/GraphicsCollection-e2a7679b.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js"])])}const pi=()=>Z().then(()=>w(()=>import("./TileLayerView2D-4ab60cdb.js"),["assets/TileLayerView2D-4ab60cdb.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/Extent-7f29a1bb.js","assets/imageUtils-b17d5cb0.js","assets/BitmapTileContainer-dc5aa20c.js","assets/aaBoundingRect-45a7fe45.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-7ed1290a.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/Collection-e2259e32.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/TileStrategy-a62d1e84.js","assets/RefreshableLayerView-1be6c989.js","assets/drapedUtils-61dc5c2f.js","assets/unitUtils-43365914.js"])),mi=()=>Z().then(()=>w(()=>import("./FeatureLayerView2D-47d8df4d.js"),["assets/FeatureLayerView2D-47d8df4d.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/TimeExtent-84882adb.js","assets/Query-e996b56b.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-9ea00c01.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/visualVariablesUtils-b572c1c3.js","assets/createSymbolSchema-deb469a5.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-2abcd901.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/assets-4cb15247.js","assets/intl-afc91037.js","assets/messages-03a939ad.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),yo={"base-dynamic":()=>Z().then(()=>w(()=>import("./BaseDynamicLayerView2D-d3db030a.js"),["assets/BaseDynamicLayerView2D-d3db030a.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/BitmapContainer-2d0c98d2.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/mathUtils-daf59e84.js","assets/enums-8bf08d0c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-3c1b281e.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/Collection-e2259e32.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js","assets/ExportStrategy-b5737806.js","assets/aaBoundingRect-45a7fe45.js","assets/TileInfo-2e5a94dc.js","assets/unitUtils-43365914.js","assets/Bitmap-7ed1290a.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/RefreshableLayerView-1be6c989.js"])),"base-tile":pi,"bing-maps":pi,csv:mi,"geo-rss":()=>Z().then(()=>w(()=>import("./GeoRSSLayerView2D-9552ea72.js"),["assets/GeoRSSLayerView2D-9552ea72.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/Extent-7f29a1bb.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/reactiveUtils-3c1b281e.js","assets/jsonUtils-9c255ec7.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/jsonUtils-8bd548d9.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-9ea00c01.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/LayerView-8f28f320.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/HandleOwner-78d35324.js","assets/GraphicContainer-98f52808.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/VertexArrayObject-8a5c7580.js","assets/FeatureContainer-7a24e5ff.js","assets/mat3-45e3f2eb.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js"])),feature:mi,geojson:mi,graphics:()=>Z().then(()=>w(()=>import("./GraphicsLayerView2D-db7dc3a9.js"),["assets/GraphicsLayerView2D-db7dc3a9.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/LayerView-8f28f320.js","assets/reactiveUtils-3c1b281e.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-78d35324.js","assets/GraphicContainer-98f52808.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/unitUtils-43365914.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-f34afef9.js","assets/VertexArrayObject-8a5c7580.js","assets/FeatureContainer-7a24e5ff.js","assets/mat3-45e3f2eb.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/lengthUtils-5215af35.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-84c98663.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js"])),group:()=>Z().then(()=>w(()=>import("./GroupLayerView2D-fa498f9d.js"),["assets/GroupLayerView2D-fa498f9d.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/GroupContainer-7fa0a0f5.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/mathUtils-daf59e84.js","assets/enums-8bf08d0c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-3c1b281e.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/Collection-e2259e32.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js"])),imagery:()=>Z().then(()=>w(()=>import("./ImageryLayerView2D-2d035780.js"),["assets/ImageryLayerView2D-2d035780.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/GraphicsCollection-e2a7679b.js","assets/HandleOwner-78d35324.js","assets/RasterVFDisplayObject-7a90d21c.js","assets/VertexArrayObject-8a5c7580.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-0f7e9d2b.js","assets/pixelUtils-5f39bd45.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/unitUtils-43365914.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-f34afef9.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/lengthUtils-5215af35.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-84c98663.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-bbf13cab.js","assets/BitmapContainer-2d0c98d2.js","assets/Bitmap-7ed1290a.js","assets/ExportStrategy-b5737806.js","assets/TileInfo-2e5a94dc.js","assets/rasterProjectionHelper-0bcfa8ae.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),"imagery-tile":()=>Z().then(()=>w(()=>import("./ImageryTileLayerView2D-9791d958.js"),["assets/ImageryTileLayerView2D-9791d958.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/multidimensionalUtils-5ae835b1.js","assets/RasterVFDisplayObject-7a90d21c.js","assets/HandleOwner-78d35324.js","assets/VertexArrayObject-8a5c7580.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-0f7e9d2b.js","assets/pixelUtils-5f39bd45.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/aaBoundingRect-45a7fe45.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/TileInfo-2e5a94dc.js","assets/unitUtils-43365914.js","assets/RawBlockCache-204337b6.js","assets/rasterProjectionHelper-0bcfa8ae.js","assets/projection-33a6cba9.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/lengthUtils-5215af35.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js","assets/Basemap-8691c5d8.js","assets/deprecate-99da8bee.js","assets/loadAll-6dec1444.js","assets/asyncUtils-59234081.js","assets/PortalItem-07c1e88d.js","assets/messages-03a939ad.js","assets/writeUtils-7d75cb47.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-06ced1a6.js","assets/CollectionFlattener-c6dafa4a.js","assets/TablesMixin-c836f156.js","assets/Layer-8a472a77.js","assets/Cyclical-1a93cb12.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/intl-afc91037.js","assets/widget-8a5f4608.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-1890fc00.js","assets/normalizeUtils-d322ac85.js","assets/query-e9f3f48f.js","assets/pbfQueryUtils-21bc0894.js","assets/pbf-c27e6a55.js","assets/queryZScale-bb883c00.js","assets/FeatureSet-9ea00c01.js","assets/RelationshipQuery-c22f6308.js","assets/LegendOptions-54bbb61a.js","assets/utils-95450d21.js","assets/ItemCache-9a7b0057.js","assets/MemCache-5bd66e9c.js","assets/jsonUtils-9c255ec7.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/TopFeaturesQuery-da583ecc.js","assets/FeatureLayer-029b8c63.js","assets/MultiOriginJSONSupport-03b5d89b.js","assets/LayerFloorInfo-689deffc.js","assets/FeatureLayerBase-eb47a35c.js","assets/HeightModelInfo-15bb1adf.js","assets/arcgisLayerUrl-269cc7a9.js","assets/editsZScale-b69b4057.js","assets/APIKeyMixin-abc940e1.js","assets/ArcGISService-a76daa10.js","assets/BlendLayer-1b58b599.js","assets/CustomParametersMixin-35ce1754.js","assets/EditBusLayer-0384e3a7.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-f1fc272b.js","assets/PortalLayer-4d594091.js","assets/RefreshableLayer-b2e977af.js","assets/ScaleRangeLayer-d12362d4.js","assets/TemporalLayer-e6ec9fbe.js","assets/TimeInfo-cbe37d4e.js","assets/FeatureTemplate-a0acfd3d.js","assets/FeatureType-1ca0df1a.js","assets/fieldProperties-6efd2194.js","assets/FieldsIndex-394de0a1.js","assets/versionUtils-95cac3d6.js","assets/styleUtils-77b2285b.js","assets/popupUtils-aa41216c.js","assets/mat2d-80bd93af.js","assets/Scheduler-74975675.js","assets/GraphicsCollection-e2a7679b.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js"])),kml:()=>Z().then(()=>w(()=>import("./KMLLayerView2D-bbc45423.js"),["assets/KMLLayerView2D-bbc45423.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/reactiveUtils-3c1b281e.js","assets/Extent-7f29a1bb.js","assets/projection-33a6cba9.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-43365914.js","assets/jsonMap-a9c94baf.js","assets/mat4-62d5e6a4.js","assets/Polyline-c56eca9b.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/kmlUtils-7c5bcfd1.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/fieldUtils-021fea8a.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/aaBoundingBox-6fbd5972.js","assets/jsonUtils-9c255ec7.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/jsonUtils-8bd548d9.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-9ea00c01.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/normalizeUtils-d322ac85.js","assets/GraphicsCollection-e2a7679b.js","assets/HandleOwner-78d35324.js","assets/Bitmap-7ed1290a.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/BitmapContainer-2d0c98d2.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/GraphicContainer-98f52808.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/projectionSupport-1035a977.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js","assets/rasterProjectionHelper-0bcfa8ae.js","assets/RenderingContext-7629f78b.js","assets/programUtils-663da5ee.js","assets/OrderIndependentTransparency-602f26c2.js"])),"map-image":()=>Z().then(()=>w(()=>import("./MapImageLayerView2D-e25c2c69.js"),["assets/MapImageLayerView2D-e25c2c69.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/BitmapContainer-2d0c98d2.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/unitUtils-43365914.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-f34afef9.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/lengthUtils-5215af35.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-84c98663.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-bbf13cab.js","assets/ExportStrategy-b5737806.js","assets/TileInfo-2e5a94dc.js","assets/Bitmap-7ed1290a.js","assets/scaleUtils-fcc59f32.js","assets/ExportImageParameters-1559c026.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-8e32e231.js","assets/drapedUtils-61dc5c2f.js","assets/GraphicsCollection-e2a7679b.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),"map-notes":()=>Z().then(()=>w(()=>import("./MapNotesLayerView2D-1a14d247.js"),["assets/MapNotesLayerView2D-1a14d247.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/GroupContainer-7fa0a0f5.js","assets/WGLContainer-db0ff963.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/GraphicContainer-98f52808.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/unitUtils-43365914.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-f34afef9.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/lengthUtils-5215af35.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-84c98663.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js"])),media:()=>Z().then(()=>w(()=>import("./MediaLayerView2D-e0ac0b68.js"),["assets/MediaLayerView2D-e0ac0b68.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/reactiveUtils-3c1b281e.js","assets/aaBoundingRect-45a7fe45.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/projection-33a6cba9.js","assets/preload-helper-101896b7.js","assets/unitUtils-43365914.js","assets/mat4-62d5e6a4.js","assets/assets-4cb15247.js","assets/request-c2b0ab45.js","assets/zscale-a508c8e5.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/jsonUtils-8bd548d9.js","assets/normalizeUtils-d322ac85.js","assets/TileStrategy-a62d1e84.js","assets/vec2-f978aef8.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/mat3-45e3f2eb.js","assets/mat3f64-b33e332c.js","assets/vec2f64-e0301652.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/VertexArrayObject-8a5c7580.js","assets/vec2f32-461e65a9.js","assets/vec3f32-4322908d.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/collectionUtils-09289d8f.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js","assets/Basemap-8691c5d8.js","assets/deprecate-99da8bee.js","assets/Loadable-7c89bd10.js","assets/loadAll-6dec1444.js","assets/asyncUtils-59234081.js","assets/Portal-ac0dca24.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/PortalItem-07c1e88d.js","assets/messages-03a939ad.js","assets/writeUtils-7d75cb47.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-06ced1a6.js","assets/opacityUtils-94fd2faa.js","assets/CollectionFlattener-c6dafa4a.js","assets/TablesMixin-c836f156.js","assets/Layer-8a472a77.js","assets/Graphic-cf98a91a.js","assets/PopupTemplate-343851b8.js","assets/fieldUtils-021fea8a.js","assets/arcadeOnDemand-87969052.js","assets/number-53937715.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/aaBoundingBox-6fbd5972.js","assets/persistableUrlUtils-7e525def.js","assets/Cyclical-1a93cb12.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/intl-afc91037.js","assets/TileInfo-2e5a94dc.js","assets/widget-8a5f4608.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-1890fc00.js","assets/query-e9f3f48f.js","assets/pbfQueryUtils-21bc0894.js","assets/pbf-c27e6a55.js","assets/queryZScale-bb883c00.js","assets/FeatureSet-9ea00c01.js","assets/RelationshipQuery-c22f6308.js","assets/LegendOptions-54bbb61a.js","assets/utils-95450d21.js","assets/ItemCache-9a7b0057.js","assets/MemCache-5bd66e9c.js","assets/jsonUtils-9c255ec7.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-5215af35.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/TopFeaturesQuery-da583ecc.js","assets/FeatureLayer-029b8c63.js","assets/MultiOriginJSONSupport-03b5d89b.js","assets/LayerFloorInfo-689deffc.js","assets/FeatureLayerBase-eb47a35c.js","assets/HeightModelInfo-15bb1adf.js","assets/arcgisLayerUrl-269cc7a9.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/editsZScale-b69b4057.js","assets/APIKeyMixin-abc940e1.js","assets/ArcGISService-a76daa10.js","assets/BlendLayer-1b58b599.js","assets/CustomParametersMixin-35ce1754.js","assets/EditBusLayer-0384e3a7.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-f1fc272b.js","assets/PortalLayer-4d594091.js","assets/RefreshableLayer-b2e977af.js","assets/ScaleRangeLayer-d12362d4.js","assets/TemporalLayer-e6ec9fbe.js","assets/TimeInfo-cbe37d4e.js","assets/FeatureTemplate-a0acfd3d.js","assets/FeatureType-1ca0df1a.js","assets/fieldProperties-6efd2194.js","assets/FieldsIndex-394de0a1.js","assets/versionUtils-95cac3d6.js","assets/styleUtils-77b2285b.js","assets/popupUtils-aa41216c.js","assets/mat2d-80bd93af.js","assets/Scheduler-74975675.js","assets/GraphicsCollection-e2a7679b.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/capabilities-320386e9.js"])),"ogc-feature":()=>Z().then(()=>w(()=>import("./OGCFeatureLayerView2D-bbc388d7.js"),["assets/OGCFeatureLayerView2D-bbc388d7.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/FeatureLayerView2D-47d8df4d.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/TimeExtent-84882adb.js","assets/Query-e996b56b.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-9ea00c01.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/visualVariablesUtils-b572c1c3.js","assets/createSymbolSchema-deb469a5.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-2abcd901.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/assets-4cb15247.js","assets/intl-afc91037.js","assets/messages-03a939ad.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),"open-street-map":pi,"oriented-imagery":mi,route:()=>Z().then(()=>w(()=>import("./RouteLayerView2D-e66a7f1b.js"),["assets/RouteLayerView2D-e66a7f1b.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/CollectionFlattener-c6dafa4a.js","assets/reactiveUtils-3c1b281e.js","assets/Stop-38392925.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/LayerView-8f28f320.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-78d35324.js","assets/GraphicContainer-98f52808.js","assets/BaseGraphicContainer-996bdb9a.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/unitUtils-43365914.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-f34afef9.js","assets/VertexArrayObject-8a5c7580.js","assets/FeatureContainer-7a24e5ff.js","assets/mat3-45e3f2eb.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-e839cb6a.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/lengthUtils-5215af35.js","assets/capabilities-320386e9.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/Geometry-daada628.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-84c98663.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js"])),stream:()=>Z().then(()=>w(()=>import("./StreamLayerView2D-77f55d26.js"),["assets/StreamLayerView2D-77f55d26.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/FeatureSet-9ea00c01.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/Graphic-cf98a91a.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/FeatureLayerView2D-47d8df4d.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/TimeExtent-84882adb.js","assets/Query-e996b56b.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/visualVariablesUtils-b572c1c3.js","assets/createSymbolSchema-deb469a5.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-2abcd901.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/assets-4cb15247.js","assets/intl-afc91037.js","assets/messages-03a939ad.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),"subtype-group":()=>Z().then(()=>w(()=>import("./SubtypeGroupLayerView2D-8b5286f8.js"),["assets/SubtypeGroupLayerView2D-8b5286f8.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/TimeExtent-84882adb.js","assets/Query-e996b56b.js","assets/enumeration-e46f3fd4.js","assets/jsonUtils-8bd548d9.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/PopupTemplate-343851b8.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/mathUtils-daf59e84.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/LegendOptions-54bbb61a.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-cf98a91a.js","assets/compilerUtils-06ced1a6.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/deprecate-99da8bee.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureLayerView2D-47d8df4d.js","assets/utils-6c2afd8b.js","assets/mat3f32-d3d088e8.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/FeatureSet-9ea00c01.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/visualVariablesUtils-b572c1c3.js","assets/createSymbolSchema-deb469a5.js","assets/ExpandedCIM-f5d9de07.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-2abcd901.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/assets-4cb15247.js","assets/intl-afc91037.js","assets/messages-03a939ad.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js"])),tile:pi,"vector-tile":()=>Z().then(()=>w(()=>import("./VectorTileLayerView2D-6ecb8918.js"),["assets/VectorTileLayerView2D-6ecb8918.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/diffUtils-58fbd195.js","assets/aaBoundingRect-45a7fe45.js","assets/enums-bfc9e4e9.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/Queue-e839cb6a.js","assets/assets-4cb15247.js","assets/intl-afc91037.js","assets/messages-03a939ad.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/pbf-c27e6a55.js","assets/rasterizingUtils-18039619.js","assets/floatRGBA-305df8f3.js","assets/TileKey-ab325718.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/TileStore-4c0c3140.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/VertexArrayObject-8a5c7580.js","assets/config-1337d16e.js","assets/TileContainer-e69647a1.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/WGLContainer-db0ff963.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-2ce74af2.js","assets/colorUtils-0c057879.js","assets/unitBezier-881ac1eb.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView-8f28f320.js","assets/HandleOwner-78d35324.js","assets/TileInfo-2e5a94dc.js","assets/unitUtils-43365914.js","assets/TileStrategy-a62d1e84.js"])),wcs:()=>Z().then(()=>w(()=>import("./ImageryTileLayerView2D-9791d958.js"),["assets/ImageryTileLayerView2D-9791d958.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/Graphic-cf98a91a.js","assets/geometry-4b789d90.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/PopupTemplate-343851b8.js","assets/Clonable-f249bc0f.js","assets/Collection-e2259e32.js","assets/Evented-d8fc77f0.js","assets/SimpleObservable-7c382d01.js","assets/fieldUtils-021fea8a.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-87969052.js","assets/enumeration-e46f3fd4.js","assets/number-53937715.js","assets/locale-30120714.js","assets/Identifiable-e3a09883.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/Symbol-f45dc441.js","assets/Color-2245b966.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/request-c2b0ab45.js","assets/persistableUrlUtils-7e525def.js","assets/collectionUtils-09289d8f.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/jsonUtils-8bd548d9.js","assets/reactiveUtils-3c1b281e.js","assets/multidimensionalUtils-5ae835b1.js","assets/RasterVFDisplayObject-7a90d21c.js","assets/HandleOwner-78d35324.js","assets/VertexArrayObject-8a5c7580.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-0f7e9d2b.js","assets/pixelUtils-5f39bd45.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/aaBoundingRect-45a7fe45.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/TileInfo-2e5a94dc.js","assets/unitUtils-43365914.js","assets/RawBlockCache-204337b6.js","assets/rasterProjectionHelper-0bcfa8ae.js","assets/projection-33a6cba9.js","assets/assets-4cb15247.js","assets/zscale-a508c8e5.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/capabilities-320386e9.js","assets/util-7859c103.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/lengthUtils-5215af35.js","assets/popupUtils-5aeaeb48.js","assets/RefreshableLayerView-1be6c989.js","assets/Basemap-8691c5d8.js","assets/deprecate-99da8bee.js","assets/loadAll-6dec1444.js","assets/asyncUtils-59234081.js","assets/PortalItem-07c1e88d.js","assets/messages-03a939ad.js","assets/writeUtils-7d75cb47.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-06ced1a6.js","assets/CollectionFlattener-c6dafa4a.js","assets/TablesMixin-c836f156.js","assets/Layer-8a472a77.js","assets/Cyclical-1a93cb12.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/intl-afc91037.js","assets/widget-8a5f4608.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-1890fc00.js","assets/normalizeUtils-d322ac85.js","assets/query-e9f3f48f.js","assets/pbfQueryUtils-21bc0894.js","assets/pbf-c27e6a55.js","assets/queryZScale-bb883c00.js","assets/FeatureSet-9ea00c01.js","assets/RelationshipQuery-c22f6308.js","assets/LegendOptions-54bbb61a.js","assets/utils-95450d21.js","assets/ItemCache-9a7b0057.js","assets/MemCache-5bd66e9c.js","assets/jsonUtils-9c255ec7.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/diffUtils-58fbd195.js","assets/colorRamps-3439e132.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-f34afef9.js","assets/styleUtils-84c98663.js","assets/DictionaryLoader-d07ab55e.js","assets/LRUCache-36379339.js","assets/TopFeaturesQuery-da583ecc.js","assets/FeatureLayer-029b8c63.js","assets/MultiOriginJSONSupport-03b5d89b.js","assets/LayerFloorInfo-689deffc.js","assets/FeatureLayerBase-eb47a35c.js","assets/HeightModelInfo-15bb1adf.js","assets/arcgisLayerUrl-269cc7a9.js","assets/editsZScale-b69b4057.js","assets/APIKeyMixin-abc940e1.js","assets/ArcGISService-a76daa10.js","assets/BlendLayer-1b58b599.js","assets/CustomParametersMixin-35ce1754.js","assets/EditBusLayer-0384e3a7.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/labelingInfo-f1d3ed98.js","assets/labelUtils-4072dca9.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-f1fc272b.js","assets/PortalLayer-4d594091.js","assets/RefreshableLayer-b2e977af.js","assets/ScaleRangeLayer-d12362d4.js","assets/TemporalLayer-e6ec9fbe.js","assets/TimeInfo-cbe37d4e.js","assets/FeatureTemplate-a0acfd3d.js","assets/FeatureType-1ca0df1a.js","assets/fieldProperties-6efd2194.js","assets/FieldsIndex-394de0a1.js","assets/versionUtils-95cac3d6.js","assets/styleUtils-77b2285b.js","assets/popupUtils-aa41216c.js","assets/mat2d-80bd93af.js","assets/Scheduler-74975675.js","assets/GraphicsCollection-e2a7679b.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js"])),"web-tile":pi,wfs:mi,wms:()=>Z().then(()=>w(()=>import("./WMSLayerView2D-5209dc76.js"),["assets/WMSLayerView2D-5209dc76.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/Extent-7f29a1bb.js","assets/BitmapContainer-2d0c98d2.js","assets/WGLContainer-db0ff963.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/mathUtils-daf59e84.js","assets/enums-8bf08d0c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/Collection-e2259e32.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js","assets/ExportStrategy-b5737806.js","assets/aaBoundingRect-45a7fe45.js","assets/TileInfo-2e5a94dc.js","assets/unitUtils-43365914.js","assets/Bitmap-7ed1290a.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/RefreshableLayerView-1be6c989.js","assets/OperationalLayer-7b681a2a.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/persistableUrlUtils-7e525def.js","assets/ElevationInfo-4e7fad68.js","assets/fieldUtils-021fea8a.js","assets/arcadeOnDemand-87969052.js","assets/lengthUtils-5215af35.js","assets/opacityUtils-94fd2faa.js","assets/ExportWMSImageParameters-5fe8ce4c.js"])),wmts:()=>Z().then(()=>w(()=>import("./WMTSLayerView2D-f5980846.js"),["assets/WMTSLayerView2D-f5980846.js","assets/cast-daef7652.js","assets/typedArrayUtil-2bcf3cee.js","assets/string-3d0ebcd3.js","assets/Error-bd05b442.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/Extent-7f29a1bb.js","assets/imageUtils-b17d5cb0.js","assets/BitmapTileContainer-dc5aa20c.js","assets/aaBoundingRect-45a7fe45.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-7ed1290a.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/TileContainer-e69647a1.js","assets/TileKey-ab325718.js","assets/WGLContainer-db0ff963.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-8f28f320.js","assets/Collection-e2259e32.js","assets/SimpleObservable-7c382d01.js","assets/collectionUtils-09289d8f.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/HandleOwner-78d35324.js","assets/Identifiable-e3a09883.js","assets/Promise-088a0e17.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/TileStrategy-a62d1e84.js","assets/RefreshableLayerView-1be6c989.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Mp(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new x(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const vo={hasLayerViewModule:i=>M(yo[i.type]),importLayerView:i=>{const e=yo[i.type];if($(e))throw Mp(i);return e(i)}};function Ip(i,e){const{spatialReference:t}=e,s=[e.x,e.y];let n=Number.POSITIVE_INFINITY,r=0,o=0;const c=[0,0],d=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const h of d)for(let u=0;u<h.length-1;u++){Cc(c,s,h,u);const p=Gc(s,c);p<n&&(n=p,r=c[0],o=c[1])}return{coordinate:new K({x:r,y:o,spatialReference:t}),distance:n}}var bn;let St=bn=class extends Rn(S){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if($(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ri(this.geometry,this.spatialReference)}catch(i){return R.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if($(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?zo(this.normalizedGeometry,t):Ll(this.normalizedGeometry,t))return i;const{coordinate:s}=Ip(this.normalizedGeometry,t);return s&&(i.targetGeometry=s),i}clone(){var i,e;return new bn({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};a([l({constructOnly:!0})],St.prototype,"geometry",void 0),a([l({readOnly:!0})],St.prototype,"normalizedGeometry",null),a([l({constructOnly:!0})],St.prototype,"spatialReference",void 0),St=bn=a([I("esri.views.2d.constraints.GeometryConstraint")],St);var Mn;let Ci=Mn=class extends Rn(S){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new Mn({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([l()],Ci.prototype,"enabled",void 0),a([l()],Ci.prototype,"rotationEnabled",void 0),Ci=Mn=a([I("esri.views.2d.constraints.RotationConstraint")],Ci);const Za=Ci;var In;let he=In=class extends Rn(S){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:s,minZoom:n,maxZoom:r}=this,o=-1,c=-1,d=!1,h=!1;if(t!==0&&s!==0&&t<s&&([t,s]=[s,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",s);e=e.map(u=>u.clone()),e.sort((u,p)=>p.scale-u.scale),e.forEach((u,p)=>u.level=p);for(const u of e)!d&&t>0&&t>=u.scale&&(o=u.level,d=!0),!h&&s>0&&s>=u.scale&&(c=i?i.level:-1,h=!0),i=u;n===-1&&(n=t===0?0:o),r===-1&&(r=s===0?e.length-1:c),n=Math.max(n,0),n=Math.min(n,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),n>r&&([n,r]=[r,n]),t=e[n].scale,s=e[r].scale,e.splice(0,n),e.splice(r-n+1,e.length),e.forEach((u,p)=>{this._lodByScale[u.scale]=u,this._scales[p]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",s)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,s=this.effectiveMaxScale,n=i.targetGeometry,r=e&&e.targetGeometry,o=s!==0&&i.scale<s,c=t!==0&&i.scale>t;if(o||c){const d=c?t:s;if(e&&r){const h=(d-e.scale)/(i.scale-e.scale);n.x=r.x+(n.x-r.x)*h,n.y=r.y+(n.y-r.y)*h}i.scale=d}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),s=Math.round(i);return e[s]+(s-i)*(e[t]-e[s])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,s;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(t=e[n],s=e[n+1],s===i)return n+this.effectiveMinZoom+1;if(t>i&&s<i)return n+this.effectiveMinZoom+1-(i-s)/(t-s)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new In({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};a([l({readOnly:!0})],he.prototype,"effectiveLODs",void 0),a([l({readOnly:!0})],he.prototype,"effectiveMinZoom",void 0),a([l({readOnly:!0})],he.prototype,"effectiveMaxZoom",void 0),a([l({readOnly:!0})],he.prototype,"effectiveMinScale",void 0),a([l({readOnly:!0})],he.prototype,"effectiveMaxScale",void 0),a([l()],he.prototype,"lods",void 0),a([l()],he.prototype,"minZoom",void 0),a([l()],he.prototype,"maxZoom",void 0),a([l()],he.prototype,"minScale",void 0),a([l()],he.prototype,"maxScale",void 0),a([l()],he.prototype,"snapToZoom",void 0),he=In=a([I("esri.views.2d.constraints.ZoomConstraint")],he);const Ka=he,Cp={base:null,key:"type",typeMap:{extent:ai,polygon:Tc}};let j=class extends S{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,s;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(s=this._geometry)==null?void 0:s.uid}`}get _defaultLODs(){var s,n,r;const e=(n=(s=this.view)==null?void 0:s.defaultsFromMap)==null?void 0:n.tileInfo,t=(r=this.view)==null?void 0:r.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new St({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new Za({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,s=this.minZoom,n=this.maxZoom,r=this.minScale,o=this.maxScale,c=this.snapToZoom;return e&&e.lods===t&&e.minZoom===s&&e.maxZoom===n&&e.minScale===r&&e.maxScale===o&&e.snapToZoom===c?e:new Ka({lods:t,minZoom:s,maxZoom:n,minScale:r,maxScale:o,snapToZoom:c})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([l({readOnly:!0})],j.prototype,"effectiveLODs",null),a([l({readOnly:!0})],j.prototype,"effectiveMinScale",null),a([l({readOnly:!0})],j.prototype,"effectiveMaxScale",null),a([l({readOnly:!0})],j.prototype,"effectiveMinZoom",null),a([l({readOnly:!0})],j.prototype,"effectiveMaxZoom",null),a([l({types:Cp,value:null})],j.prototype,"geometry",null),a([l({type:[Xl]})],j.prototype,"lods",void 0),a([l()],j.prototype,"minScale",void 0),a([l()],j.prototype,"maxScale",void 0),a([l()],j.prototype,"minZoom",void 0),a([l()],j.prototype,"maxZoom",void 0),a([l()],j.prototype,"rotationEnabled",void 0),a([l()],j.prototype,"snapToZoom",void 0),a([l()],j.prototype,"view",void 0),a([l({readOnly:!0})],j.prototype,"version",null),a([l()],j.prototype,"_defaultLODs",null),a([l({type:St})],j.prototype,"_geometry",null),a([l({type:Za})],j.prototype,"_rotation",null),a([l({readOnly:!0,type:Ka})],j.prototype,"_zoom",null),j=a([I("esri.views.2d.MapViewConstraints")],j);const Ya=j;function Tp(i){return i instanceof Float32Array&&i.length>=2}function Ep(i){return Array.isArray(i)&&i.length>=2}function Zs(i){return Tp(i)||Ep(i)}var Cn;const qe=[0,0];let ht=Cn=class extends Fi{constructor(i){super(i),this._viewpoint2D={center:Q(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new ai,this.id=0,this.inverseTransform=vt(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=vt(),this.transformNoRotation=vt(),this.displayMat3=$s(),this.displayViewMat3=$s(),this.viewMat3=$s(),this.viewMat2d=Pc(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=ke(t,i.viewpoint),this._set("size",os(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Cn({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return Zs(e)?Ke(i,e,this.inverseTransform):(qe[0]=e,qe[1]=t,Ke(i,qe,this.inverseTransform))}toScreen(i,e,t){return Zs(e)?Ke(i,e,this.transform):(qe[0]=e,qe[1]=t,Ke(i,qe,this.transform))}toScreenNoRotation(i,e,t){return Zs(e)?Ke(i,e,this.transformNoRotation):(qe[0]=e,qe[1]=t,Ke(i,qe,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return Kn(i,t,n,e,0,s),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size"),o=new Ve({targetGeometry:new K(i[0],i[1],e),scale:t,rotation:s});if(this._set("viewpoint",o),!r||!e||!t)return;this.resolution=li(o),this.rotation=s,this.scale=t,this.spatialReference=e,os(this.center,i);const c=r[0]!==0?2/r[0]:0,d=r[1]!==0?-2/r[1]:0;jc(this.displayMat3,c,0,0,0,d,0,-1,1,1);const h=Zc(this.viewMat3),u=br(r[0]/2,r[1]/2),p=br(-r[0]/2,-r[1]/2),g=sa(s);wr(h,h,u),Kc(h,h,g),wr(h,h,p),Yc(this.displayViewMat3,this.displayMat3,h);const f=Jo(this.viewMat2d,u);return Sn(f,f,g),rs(f,f,p),np(this.extent,o,r),Yn(this.transform,o,r,n),ea(this.inverseTransform,this.transform),hp(this.transformNoRotation,o,r,n),this.worldScreenWidth=pp(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};a([l({readOnly:!0})],ht.prototype,"id",void 0),a([l({value:1,json:{write:!0}})],ht.prototype,"pixelRatio",null),a([l({json:{write:!0}})],ht.prototype,"size",null),a([l()],ht.prototype,"spatialReference",void 0),a([l({type:Ve,json:{write:!0}})],ht.prototype,"viewpoint",null),ht=Cn=a([I("esri.views.2d.ViewState")],ht);const wo=ht;var Tn,En;let Ye=Tn=class extends S{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Tn({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([l()],Ye.prototype,"left",void 0),a([l()],Ye.prototype,"top",void 0),a([l()],Ye.prototype,"right",void 0),a([l()],Ye.prototype,"bottom",void 0),Ye=Tn=a([I("esri.views.2d.PaddedViewState.Padding")],Ye);let Kt=En=class extends wo{constructor(...i){super(...i),this.paddedViewState=new wo,this._updateContent=(()=>{const e=Q();return()=>{const t=this._get("size"),s=this._get("padding");if(!t||!s)return;const n=this.paddedViewState;te(e,s.left+s.right,s.top+s.bottom),ln(e,t,e),os(n.size,e);const r=n.viewpoint;r&&(this.viewpoint=r)}})(),this.addHandles(v(()=>[this.size,this.padding],()=>this._updateContent(),ki)),this.padding=new Ye,this.size=[0,0]}set padding(i){this._set("padding",i||new Ye)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,gp(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,s=e.targetGeometry;t.center[0]=s.x,t.center[1]=s.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=s.spatialReference,this._update()}}clone(){return new En({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([l()],Kt.prototype,"paddedViewState",void 0),a([l({type:Ye})],Kt.prototype,"padding",null),a([l()],Kt.prototype,"viewpoint",null),Kt=En=a([I("esri.views.2d.PaddedViewState")],Kt);const xp=Kt;function Qn(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}let bo=class extends X{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,s=>this._handleDoubleClick(s,t))}_handleDoubleClick(e,t){Qn(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},kp=class extends X{constructor(e,t,s){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",s,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:s}=t;if(s!==this.pointerType)return;e.stopPropagation();const{action:n,delta:r}=t,{view:o}=this,{mapViewNavigation:c}=o;switch(n){case"begin":{const{scale:d}=o;this._startScale=d,this._currentScale=d,this._previousDelta=r,c.begin();break}case"update":{if(this._previousDelta.y===r.y)return;this._previousDelta=r;const d=1.015**r.y,h=this._startScale*d,u=h/this._currentScale;c.setViewpointImmediate(u),this._currentScale=h;break}case"end":{const{constraints:d}=o,{effectiveLODs:h,snapToZoom:u}=d;if(!u||!h)return void c.end();const p=d.snapScale(this._currentScale),g=(r.y>0?Math.max(p,d.snapToPreviousScale(this._startScale)):Math.min(p,d.snapToNextScale(this._startScale)))/this._currentScale;c.zoom(g);break}}}},Es=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,s=t.pointers.size;switch(t.action){case"start":this._currentCount=s,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,s;this._startEvent=e,(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Ap=class extends X{constructor(e,t,s){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",s,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Es({start:(t,s)=>{this.view.mapViewNavigation.pan.begin(this.view,s.data),s.stopPropagation()},update:(t,s)=>{this.view.mapViewNavigation.pan.update(this.view,s.data),s.stopPropagation()},end:(t,s)=>{this.view.mapViewNavigation.pan.end(this.view,s.data),s.stopPropagation()},condition:(t,s)=>t===1&&Qn(s.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Pp=class extends X{constructor(e,t,s){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Es({start:(r,o)=>{n.rotate.begin(this._view,o.data),o.stopPropagation()},update:(r,o)=>{n.rotate.update(this._view,o.data),o.stopPropagation()},end:(r,o)=>{n.rotate.end(),o.stopPropagation()},condition:(r,o)=>r===1&&Qn(o.data,this.pointerAction)}),this.registerIncoming("drag",s,r=>this._dragEventSeparator.handle(r))}};function Te(i){let e=i*i;return i<0&&(e*=-1),e}function $p(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function Fp(i,e,t){const s=t,n=i.state,r=i.device,o=e.tiltDirection==="forward-down"?1:-1,c=1;return r.deviceType==="standard"?(s.translation[0]=Te(n.axes[0]),s.translation[1]=Te(n.axes[1]),s.translation[2]=Te(n.buttons[7])-Te(n.buttons[6]),s.heading=Te(n.axes[2]),s.tilt=Te(n.axes[3])):r.deviceType==="spacemouse"&&(s.translation[0]=1.2*Te(n.axes[0]),s.translation[1]=1.2*Te(n.axes[1]),s.translation[2]=2*-Te(n.axes[2]),s.heading=1.2*Te(n.axes[5]),s.tilt=1.2*Te(n.axes[3])),s.tilt*=o,Kl(s.translation,s.translation,c),s}function Rp(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let Sp=class extends X{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Je,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([v(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=ni({update:s=>this._frameUpdate(s.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},O)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,$p(this._transformation)):(this._currentDevice=e.data.device,Fp(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(Rp(t))return;const s=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,r=Dp*n*e;Ts(s,s,[t.translation[0]*r,-t.translation[1]*r]);const o=1+t.translation[2]*Op*e,c=this._view.constraints.rotationEnabled?-t.heading*Lp*e:0,d=this._view.size,h=[d[0]/2,d[1]];Ga(s,s,o,c,h,d);const u=this._view.constraints.constrain(s,this._view.viewpoint);this._view.viewpoint=u}};const Lp=.06,Dp=.7,Op=6e-4;let Vp=class extends X{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=this._keyMap[e.data.key];if(this._pressed=s!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),s){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Np=class extends X{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=e.modifiers;if(s.size>0&&!s.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var ii;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(ii||(ii={}));let zp=class extends X{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),t.zoomIn.forEach(n=>this._keysToZoomAction[n]=ii.IN),t.zoomOut.forEach(n=>this._keysToZoomAction[n]=ii.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:s}=e.data;if(!(s in this._keysToZoomAction))return;const n=this._keysToZoomAction[s],{mapViewNavigation:r}=this.view;let o=null;switch(n){case ii.IN:o=r.zoomIn();break;case ii.OUT:o=r.zoomOut();break;default:return}r.begin(),o.then(()=>r.end()),e.stopPropagation()}};const Bp=.6;let qp=class extends X{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,s=>this._handleMouseWheel(s))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:s,y:n,deltaY:r}=e.data,o=1/Bp**(1/60*r),c=t.zoom(o,[s,n]);c&&(this._canZoom=!1,c.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},Up=class extends X{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new Es({start:(s,n)=>{t.pinch.begin(this.view,n.data),n.stopPropagation()},update:(s,n)=>{t.pinch.update(this.view,n.data),n.stopPropagation()},end:(s,n)=>{t.pinch.end(this.view),n.stopPropagation()},condition:s=>s>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Mo(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>Wp(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Hp(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Gp(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Wp(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let jp=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=r=>{this._connectGamepad(r.gamepad)},this._onDisconnectGamepad=r=>{const o=r.gamepad,c=o.index,d=this._inputDevices[c];d&&(this._emitGamepadEvent(o,Mo(d),!1),this._inputDevices.splice(c,1),this._latestUpdate.splice(c,1),this._input.gamepad.devices.remove(d),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const s="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=s&&n,this.supported&&(this._forEachGamepad(r=>this._connectGamepad(r)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Wn(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=ni({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),s=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(n=>{const r=this._inputDevices[n.index];if(!r)return;const o=this._latestUpdate[n.index],c=Mo(r),d=s||Gp(c);o&&(o.timestamp===n.timestamp||!o.active&&d||Hp(o.state,c))||this._emitGamepadEvent(n,c,!d)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const n=t[s];this._validate(n)&&e(n)}}_emitGamepadEvent(e,t,s){const n=this._latestUpdate[e.index],r=n&&n.active;if(!r&&!s)return;const o=!r&&s?"start":r&&s?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:o})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const Io=ve("trident"),Co=ve("edge"),Zp=ve("chrome"),Kp=ve("ff"),Yp=ve("safari"),Gt={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let Qa=class Xa{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new jp(e,this._input),this._gamepadSource.onEvent=s=>this._callback("gamepad",s)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=le(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const s=this._active[t];this._element.removeEventListener(Ks[t],s),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&Ks[t]){const s=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(Ks[t],s),this._active[t]=s}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Gt.touchNone:Gt.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Gt.touchPan:Gt.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Gt.touchNone),this._element.classList.remove(Gt.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const s=Ra(this._element,e);return Xa.test.disableSubpixelCoordinates&&(s.x=Math.round(s.x),s.y=Math.round(s.y)),t.x=s.x,t.y=s.y,t}_handleKey(e,t){const s=ou(t);s&&e==="key-up"&&this._keyDownState.delete(s);const n={native:t,key:s,repeat:s&&this._keyDownState.has(s)};s&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,s)}_handlePointerPreventDefault(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,s)}_handleMouseWheel(e,t){let s=t.deltaY;switch(t.deltaMode){case 0:(Io||Co)&&(s=s/document.documentElement.clientHeight*600);break;case 1:s*=30;break;case 2:s*=900}Io||Co?s*=.7:Zp||Yp?s*=.6:Kp&&(s*=1.375);const n=100,r=Math.abs(s);r>n&&(s=s/r*200/(1+Math.exp(-.02*(r-n))));const o=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:s});this._callback(e,o)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const s={native:t};t.preventDefault(),this._callback(e,s)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Qa.test={disableSubpixelCoordinates:!1};const Ks={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Qp=class extends X{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function Xn(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function Xp(i,e){const t=e.x-i.x,s=e.y-i.y;return Math.sqrt(t*t+s*s)}function Jp(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:ue()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[L,B]=i,[ee,W]=[B.x-L.x,B.y-L.y];return e.radius=Math.sqrt(ee*ee+W*W)/2,e.center.x=(L.x+B.x)/2,e.center.y=(L.y+B.y)/2,e}let t=0,s=0;for(let L=0;L<i.length;L++)t+=i[L].x,s+=i[L].y;t/=i.length,s/=i.length;const n=i.map(L=>L.x-t),r=i.map(L=>L.y-s);let o=0,c=0,d=0,h=0,u=0,p=0,g=0;for(let L=0;L<n.length;L++){const B=n[L],ee=r[L],W=B*B,me=ee*ee;o+=W,c+=me,d+=B*ee,h+=W*B,u+=me*ee,p+=B*me,g+=ee*W}const f=.5*(h+p),y=.5*(u+g),T=o*c-d*d,C=(f*c-y*d)/T,P=(o*y-d*f)/T,D=ue(C+t,P+s);return{radius:Math.sqrt(C*C+P*P+(o+c)/i.length),center:D}}function Vt(i){const{native:e}=i,{pointerId:t,button:s,pointerType:n}=e;return n==="mouse"?`${t}:${s}`:`${n}`}const Ie={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let em=class extends X{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,r=ps){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Mt(e.doubleClickTimer))}get hasPendingInputs(){return ms(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const s=this._pointerState.get(e);s&&(s.doubleClickTimer=Mt(s.doubleClickTimer),t&&this._click.emit(s.event.data,void 0,s.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:s,button:n}=e.native;return s==="mouse"?`${t}:${n}`:`${s}`}_handleImmediateClick(e){const t=e.data,{pointerType:s}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const r=this._pointerState.get(n),{data:o,modifiers:c}=r.event,d=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Xn(o,t)>d?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),r.pointerDownCount===2&&this._doubleClick.emit(o,void 0,c))}_handlePointerDown(e){const t=Vt(e.data),s=this._pointerState.get(t);s&&(s.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:s}}=t,n=Vt(t),r=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),r),c=1;this._pointerState.set(n,{event:e,doubleClickTimer:o,pointerDownCount:c}),this.refreshHasPendingInputs()}},tm=class extends X{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,r=ps){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=ue(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Es({start:(o,c)=>this._dragStart(o,c),update:(o,c)=>this._dragUpdate(c),end:(o,c)=>this._dragEnd(c)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Mt(e.doubleTapTimeout)})}get hasPendingInputs(){return ms(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Mt(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,s){const{button:n,buttons:r,pointer:o,pointers:c,pointerType:d,timestamp:h}=s;return{action:e,delta:t,button:n,buttons:r,pointer:o,pointers:c,pointerType:d,timestamp:h}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:s,modifiers:n}=t,{center:r}=s;this._dragStartCenter=r;const o=this._createDoubleTapDragData("begin",ue(0,0),s);this._doubleTapDrag.emit(o,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,r=ue(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("update",r,t);this._doubleTapDrag.emit(o,void 0,s),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,r=ue(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("end",r,t);this._doubleTapDrag.emit(o,void 0,s),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,s=Vt(t),n=this._pointerState.get(s),{pointerType:r}=t.native;if(n){const o=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(s),Xn(n.event.data,t)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:s}=t.native,n=Vt(t),r=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(n),r);this._pointerState.set(n,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}},im=class extends X{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,s,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:sm(this._activePointerMap),pointer:t,angle:s.angle,radius:s.radius,center:s.center}}_addPointer(e){const t=e.native.pointerId,s=zi(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const r=Qi(n,Ja(this._activePointerMap));n.initialAngle=r,n.lastAngle=r,this._updatePointerAngles(s)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,s=this._activePointerMap.get(t);s?s.event=e:this._addPointer(e)}_removePointer(e){const t=zi(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=zi(this._activePointerMap);this._activePointerMap.forEach(s=>{s.initialAngle=Qi(s,t)-e,s.lastAngle=Qi(s,t)-e})}_emitEvent(e,t,s){const n=zi(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,s),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,s=xs(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,s),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,xs(e.timestamp))))}_handlePointerDrag(e){const t=e.data,s=t.currentEvent,n=xs(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(s.native.pointerId)?(this._updatePointer(s),!this._isCurrentDragSuppressed&&this._emitEvent("update",s,n)):(this._addPointer(s),this._emitEvent("added",s,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(s),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",s,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Ja(i){const e=[];return i.forEach(t=>{e.push(ue(t.event.x,t.event.y))}),Jp(e)}function zi(i){const e=Ja(i);let t=0;return i.forEach(s=>{let n=Qi(s,e),r=n-s.lastAngle;for(;r>Math.PI;)r-=2*Math.PI;for(;r<-Math.PI;)r+=2*Math.PI;n=s.lastAngle+r,s.lastAngle=n;const o=n-s.initialAngle;t+=o}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function sm(i){const e=new Map;return i.forEach((t,s)=>e.set(s,t.event)),e}function Qi(i,e){const t=i.event,s=t.x-e.center.x,n=t.y-e.center.y;return Math.atan2(n,s)}var To;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(To||(To={}));let nm=class extends X{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,r=ps){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=Vt(t);if(!this._pointerState.has(s)){const n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(s,n),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,s=Vt(t),n=this._pointerState.get(s);if(n&&n.downButton===t.native.button){const r=n.immediateDoubleClick;if(r){r.timeoutHandle.remove();const o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Xn(r,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,r.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const s=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),s)}}_removeState(e){const t=Vt(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const gi={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let rm=class extends X{constructor(e=gi.maximumClickDelay,t=gi.movementUntilMouseDrag,s=gi.movementUntilPenDrag,n=gi.movementUntilTouchDrag,r=gi.holdDelay,o=ps){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=s,this._movementUntilTouchDrag=n,this._holdDelay=r,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",c=>{this._handlePointerLoss(c,"pointer-up")}),this.registerIncoming("pointer-capture-lost",c=>{this._handlePointerLoss(c,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",c=>{this._handlePointerLoss(c,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Mt(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=t.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const o=this._pointerState.get(s);if(o){if(!o.isDragging){const c=o.previousEvent;this._pointerHold.emit(c,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const r={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(s,r),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,s){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:s}}_handlePointerMove(e){const t=e.data,s=t.native.pointerId,n=this._pointerState.get(s);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):Xp(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,s=t.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,s===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,t)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const s=e.data,n=s.native.pointerId,r=this._pointerState.get(n);r&&(r.holdTimeout!=null&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",r,t==="pointer-up"?s:r.previousEvent),void 0,r.modifiers):t==="pointer-up"&&r.downButton===s.native.button&&e.timestamp-r.startTimestamp<=this._maximumClickDelay&&!r.holdEmitted&&this._immediateClick.emit(s),this._pointerState.delete(n),this.stopCapturingPointer(s.native),this._pointerState.size===0&&this._moveHandle.pause())}};const Bi={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let At=class extends S{constructor(){super(...arguments),this._handles=new Je}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([Xe(()=>!e(),()=>this._disconnect()),Xe(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=le(this._inputManager)}_connect(){const e=this.view.surface,t=new Qa(e,this.view.input),s=[new nm,new rm,new em,new im(this.view.navigation),new tm],n=new Fe({eventSource:t,recognizers:s});n.installHandlers("prevent-context-menu",[new Qp],yt.INTERNAL),n.installHandlers("navigation",[new Up(this.view),new Sp(this.view),new qp(this.view),new bo(this.view),new bo(this.view,[Bi.counter]),new Ap(this.view,"primary"),new Vp(this.view,Bi.pan),new zp(this.view,Bi.zoom),new Np(this.view,Bi.rotate),new Pp(this.view,"secondary"),new kp(this.view,"touch")],yt.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,v(()=>{var r,o;return(o=(r=this.view)==null?void 0:r.navigation)==null?void 0:o.browserTouchPanEnabled},r=>{this._source&&(this._source.browserTouchPanningEnabled=!r)},O)}get test(){return{inputManager:this._inputManager}}};a([l()],At.prototype,"view",void 0),a([l()],At.prototype,"latestPointerType",null),a([l()],At.prototype,"latestPointerLocation",null),a([l()],At.prototype,"multiTouchActive",null),At=a([I("esri.views.2d.input.MapViewInputManager")],At);const om=At;let am=0,ut=class extends S{constructor(){super(...arguments),this.color=new wt([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return am++}};a([l({readOnly:!0})],ut.prototype,"version",null),a([l({type:wt})],ut.prototype,"color",void 0),a([l({type:wt})],ut.prototype,"haloColor",void 0),a([l()],ut.prototype,"haloOpacity",void 0),a([l()],ut.prototype,"fillOpacity",void 0),ut=a([I("esri.views.2d.support.HighlightOptions")],ut);const el=ut,lm=i=>i.includes("Brush");let tl=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),lm(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function cm(i,e,t,s,n,r,o,c){let d;i.ignorePadding&&(s={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?d=[i.width,i.height]:i.width==null&&i.height!=null?d=[i.height,i.height]:i.width!=null&&i.height==null?d=[i.width,i.width]:i.width==null&&i.height==null&&(d=null);const h=t[0]-(s.left+s.right),u=t[1]-(s.top+s.bottom);let p,g,f=i.area||{x:0,y:0,width:h,height:u};if(d){const y=h/u,T=d[0]/d[1];if(T>y){const C=f.width/T;f={x:f.x,y:Math.round(f.y+(f.height-C)/2),width:f.width,height:Math.round(C)}}else{const C=f.height*T;f={x:Math.round(f.x+(f.width-C)/2),y:f.y,width:Math.round(C),height:f.height}}}else d=[f.width,f.height];return d[0]>f.width?(p=Math.min(d[0]/f.width,e),g=d[0]/f.width/p):(p=1,g=d[0]/f.width),{resolutionScale:p,cropArea:{x:Math.round((f.x+s.left)*p),y:Math.round((f.y+s.top)*p),width:Math.round(f.width*p),height:Math.round(f.height*p)},outputScale:g,format:n,quality:r,children:o,rotation:c}}function dm(i,e,t){const{ctx:s,canvas:n}=il(i,t),r=s.getImageData(0,0,i.width,i.height),o=pm(n,e);return sl(n),{dataUrl:o,data:r}}function hm(i,e){const{ctx:t,canvas:s}=il(i,e),n=t.getImageData(0,0,i.width,i.height);return sl(s),n}function il(i,e){const t=um();e.premultipliedAlpha&&ym(i),t.width=i.width,t.height=i.height;const s=t.getContext("2d");return s.putImageData(i,0,0),e.flipY&&_m(s),{ctx:s,canvas:t}}function sl(i){i.width=0,i.height=0}function um(){return $(Ys)&&(Ys=document.createElement("canvas")),Ys}let Ys=null;function pm(i,e){const t=vm[e.format],s=e.quality/100;return i.toDataURL(t,s)}function mm(i,e){const t=fm(i),s=bm[t];return{format:t,quality:oi(e??s,0,100)}}function gm(i,e){return e/Math.max(i[0],i[1])}function av(i,e,t,s=0,n=0,r=i.width-s,o=i.height-n,c=!1){const{data:d}=i,{width:h,height:u,data:p}=e,g=r/h,f=o/u,y=Math.ceil(g/2),T=Math.ceil(f/2),C=i.width;for(let P=0;P<u;P++)for(let D=0;D<h;D++){const L=4*(D+(c?u-P-1:P)*h);let B=0,ee=0,W=0,me=0,It=0,Ct=0;const zt=(P+.5)*f;for(let Ce=Math.floor(P*f);Ce<(P+1)*f;Ce++){const Jn=Math.abs(zt-(Ce+.5))/T,fl=(D+.5)*g,_l=Jn*Jn;for(let Di=Math.floor(D*g);Di<(D+1)*g;Di++){const er=Math.abs(fl-(Di+.5))/y,Bt=Math.sqrt(_l+er*er);if(Bt>=1)continue;let et=2*Bt*Bt*Bt-3*Bt*Bt+1;const qt=4*(s+Di+(n+Ce)*C);Ct+=et*d[qt+3],ee+=et,!t&&d[qt+3]<255&&(et=et*d[qt+3]/255),W+=et*d[qt],me+=et*d[qt+1],It+=et*d[qt+2],B+=et}}p[L]=W/B,p[L+1]=me/B,p[L+2]=It/B,p[L+3]=Ct/ee}return e}function fm(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return wm}}function _m(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function ym(i){const e=i.data,t=e.length;for(let s=0;s<t;s+=4){const n=e[s+3];if(n!==255&&n>0){const r=255/n;e[s+0]=e[s+0]*r,e[s+1]=e[s+1]*r,e[s+2]=e[s+2]*r}}}const vm={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},Eo=98,wm="png",bm={png:100,jpg:Eo,jpeg:Eo};function Mm(i){const e=Jc(i);if(!e.available)return new x("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new x("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new x("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new x("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===ed.WEBGL1){if(!e.supportsElementIndexUint)return new x("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new x("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new x("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function Im(i){return i&&"nodeType"in i}function Cm(i){return i&&typeof i.render=="function"}const xo={component:"esri-component"};let Pt=class extends S{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(xo.component),t&&t.classList.remove(xo.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||Im(e)?(this._set("widget",null),Uo(e)):(Cm(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([l({dependsOn:[]})],Pt.prototype,"id",null),a([l()],Pt.prototype,"node",null),a([pe("node")],Pt.prototype,"castNode",null),a([l({readOnly:!0})],Pt.prototype,"widget",void 0),Pt=a([I("esri.views.ui.Component")],Pt);const Xi=Pt,Tm={left:0,top:0,bottom:0,right:0},nl={bottom:30,top:15,right:15,left:15},Qs="manual",re={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function Em(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function Xs(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function Js(i,{top:e,bottom:t,left:s,right:n}){i.style.top=e,i.style.bottom=t,i.style.left=s,i.style.right=n}let je=class extends fs.EventedAccessor{constructor(i){super(i),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new Je,this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&Js(e,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&Js(e,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([v(()=>{var i;return[(i=this.view)==null?void 0:i.padding,this.container]},this._applyViewPadding,O),v(()=>this.padding,this._applyUIPadding,O)])}destroy(){this.container=null;for(const i of this._components)i.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(i){const e=this._get("container");i!==e&&(i&&(i.classList.add(re.ui),ih(i),this._attachContainers(i)),e&&(e.classList.remove(re.ui),Js(e,{top:"",bottom:"",left:"",right:""}),Ho(e)),this._set("container",i))}get height(){const i=this.get("view.height")||0;if(i===0)return i;const e=this._getViewPadding(),t=e.top+e.bottom;return Math.max(i-t,0)}get padding(){return this._get("padding")}set padding(i){this._overrideIfSome("padding",i)}castPadding(i){return typeof i=="number"?{bottom:i,top:i,right:i,left:i}:{...nl,...i}}get width(){const i=this.get("view.width")||0;if(i===0)return i;const e=this._getViewPadding(),t=e.left+e.right;return Math.max(i-t,0)}add(i,e){let t,s;if(Array.isArray(i))return void i.forEach(r=>this.add(r,e));const n=Xs(i);n&&({index:t,position:e,component:i,key:s}=n),e&&typeof e=="object"&&({index:t,key:s,position:e}=e),!i||e&&!this._isValidPosition(e)||this._add(i,e,t,s)}remove(i,e){if(!i)return;if(Array.isArray(i))return i.map(s=>this.remove(s,e));const t=this._find(i);if(t){const s=this._componentToKey;if(s.has(i)&&s.get(i)!==e)return;const n=this._components.indexOf(t);return t.node.parentNode&&t.node.parentNode.removeChild(t.node),this._componentToKey.delete(i),this._components.splice(n,1)[0]}}empty(i){return Array.isArray(i)?i.map(e=>this.empty(e)).reduce((e,t)=>e.concat(t)):(i=i||Qs)===Qs?Array.prototype.slice.call(this._manualContainer.children).filter(e=>!e.classList.contains(re.corner)).map(e=>this.remove(e)):this._isValidPosition(i)?Array.prototype.slice.call(this._cornerNameToContainerLookup[i].children).map(this.remove,this):null}move(i,e){if(Array.isArray(i)&&i.forEach(r=>this.move(r,e)),!i)return;let t;const s=Xs(i)||Xs(e);if(s&&(t=s.index,e=s.position,i=s.component||i),e&&!this._isValidPosition(e))return;const n=this.remove(i);n&&this.add(n,{position:e,index:t})}find(i){if(!i)return null;const e=this._findById(i);return e&&(e.widget||e.node)}getPosition(i){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(i))return e;return null}_add(i,e,t,s){i instanceof Xi||(i=new Xi({node:i})),this._place({component:i,position:e,index:t}),this._components.push(i),s&&this._componentToKey.set(i,s)}_find(i){return i?i instanceof Xi?this._findByComponent(i):typeof i=="string"?this._findById(i):this._findByNode(i.domNode||i):null}_getViewPadding(){return this.get("view.padding")||Tm}_attachContainers(i){i.appendChild(this._innerContainer),i.appendChild(this._manualContainer)}_initContainers(){const i=document.createElement("div");i.classList.add(re.innerContainer),i.classList.add(re.cornerContainer);const e=document.createElement("div");e.classList.add(re.innerContainer),e.classList.add(re.manualContainer);const t=document.createElement("div");t.classList.add(re.topLeft),t.classList.add(re.corner),i.appendChild(t);const s=document.createElement("div");s.classList.add(re.topRight),s.classList.add(re.corner),i.appendChild(s);const n=document.createElement("div");n.classList.add(re.bottomLeft),n.classList.add(re.corner),i.appendChild(n);const r=document.createElement("div");r.classList.add(re.bottomRight),r.classList.add(re.corner),i.appendChild(r),this._innerContainer=i,this._manualContainer=e;const o=Oe();this._cornerNameToContainerLookup={"top-left":t,"top-right":s,"bottom-left":n,"bottom-right":r,"top-leading":o?s:t,"top-trailing":o?t:s,"bottom-leading":o?r:n,"bottom-trailing":o?n:r},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(i){return!!this._positionNameToContainerLookup[i]}_place(i){const e=i.component,t=i.position||Qs,s=i.index,n=this._positionNameToContainerLookup[t],r=s>-1;if(Em(e.widget)&&e.widget.startup(),!r)return void n.appendChild(e.node);const o=Array.prototype.slice.call(n.children);if(s===0)return void(n.firstChild?hr(e.node,n.firstChild):n.appendChild(e.node));s>=o.length?n.appendChild(e.node):hr(e.node,o[s])}_toPxPosition(i){return{top:this._toPxUnit(i.top),left:this._toPxUnit(i.left),right:this._toPxUnit(i.right),bottom:this._toPxUnit(i.bottom)}}_toPxUnit(i){return i===0?"0":i+"px"}_findByComponent(i){let e,t=null;return this._components.some(s=>(e=s===i,e&&(t=s),e)),t}_findById(i){let e,t=null;return this._components.some(s=>(e=s.id===i,e&&(t=s),e)),t}_findByNode(i){let e,t=null;return this._components.some(s=>(e=s.node===i,e&&(t=s),e)),t}};a([l()],je.prototype,"container",null),a([l()],je.prototype,"height",null),a([l({value:nl})],je.prototype,"padding",null),a([pe("padding")],je.prototype,"castPadding",null),a([l()],je.prototype,"view",void 0),a([l()],je.prototype,"width",null),je=a([I("esri.views.ui.UI")],je);const xm=je;function ko(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function km(i,e){return i.length!==e.length||i.some((t,s)=>t.text!==e[s].text)}function qi(i,e,t){!t||!e||i.find(s=>s.layerView===e&&s.text===t)||i.push({text:t,layerView:e})}function Am(i){return i.type==="bing-maps"}const it=[];let Yt=class extends Wo{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new H,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const s=this.get("view.allLayerViews");s&&this.handles.add(s.map(n=>v(()=>{var r;return[n.suspended,(r=n.layer)==null?void 0:r.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([xe(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Xe(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");it.length=0,e?(e.forEach(t=>{var r;if(t.suspended||!((r=t.layer)!=null&&r.attributionVisible))return;const s=t.layer;if(ko(s,"user"))return void qi(it,t,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(t)){const o=this._fetchedAttributionData.get(t);return void(o?qi(it,t,this._getDynamicAttribution(o,this.view,s)):ko(s)&&qi(it,t,s.copyright))}return void this._fetchAttributionData(t)}const n=s.get("portalItem.accessInformation");qi(it,t,n||s.copyright)}),km(this.items,it)&&(this.items.removeAll(),this.items.addMany(it)),it.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await Lc(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const s=t.ok?this._createContributionIndex(t.value,Am(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,s)}this._updateAttributionItems()}_createContributionIndex(e,t){const s=e.contributors,n={};if(!s)return n;for(let r=0;r<s.length;r++){const o=s[r],c=o.coverageAreas;if(!c)return;for(const d of c){const h=d.bbox,u=d.zoomMin-(t&&d.zoomMin?1:0),p=d.zoomMax-(t&&d.zoomMax?1:0),g={xmin:h[1],ymin:h[0],xmax:h[3],ymax:h[2],spatialReference:Pn.WGS84},f={extent:Vo(g),attribution:o.attribution||"",score:d.score!=null?d.score:100,id:r};for(let y=u;y<=p;y++)n[y]=n[y]||[],n[y].push(f)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,s){const{extent:n,scale:r}=t;let o=s.tileInfo.scaleToZoom(r);if(o=Math.min(e.maxKey,Math.round(o)),!n||o==null||o<=-1)return"";const c=e[o],d=Dl(n.center.clone().normalize(),t.spatialReference),h={};return c?c.filter(u=>{const p=!h[u.id]&&d&&zo(u.extent,d);return p&&(h[u.id]=!0),p}).sort((u,p)=>p.score-u.score||u.objectId-p.objectId).map(u=>u.attribution).join(", "):""}};a([l({readOnly:!0,type:H})],Yt.prototype,"items",void 0),a([l({readOnly:!0})],Yt.prototype,"state",null),a([l()],Yt.prototype,"view",void 0),Yt=a([I("esri.widgets.Attribution.AttributionViewModel")],Yt);const rl=Yt,st={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let ae=class extends ne{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(s=>s.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=st.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new rl}initialize(){this.addHandles(xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[st.open]:this._isOpen};return m("div",{bind:this,class:this.classes(st.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return m("div",{class:st.poweredBy},"Powered by"," ",m("a",{class:st.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,s=t?"0":"",{attributionText:n}=this,r={[st.sourcesOpen]:e,[st.interactive]:t};return m("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(st.sources,r),innerHTML:n,tabindex:s})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:s,clientWidth:n,scrollWidth:r}=e,o=r>n,c=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,c&&(t=!0),this._isOpen){const d=s<this._prevSourceNodeHeight;this._prevSourceNodeHeight=s,d&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([l()],ae.prototype,"_isOpen",void 0),a([l()],ae.prototype,"_isInteractive",null),a([l()],ae.prototype,"_attributionTextOverflowed",void 0),a([l()],ae.prototype,"_prevSourceNodeHeight",void 0),a([l({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ae.prototype,"attributionText",null),a([l()],ae.prototype,"iconClass",void 0),a([l()],ae.prototype,"itemDelimiter",void 0),a([l()],ae.prototype,"label",null),a([l(),se("esri/widgets/Attribution/t9n/Attribution")],ae.prototype,"messages",void 0),a([l()],ae.prototype,"view",null),a([l({type:rl})],ae.prototype,"viewModel",void 0),a([Me()],ae.prototype,"_toggleState",null),ae=a([I("esri.widgets.Attribution")],ae);const Pm=ae,$m="esri.widgets.CompassViewModel";let $t=class extends xa(S){constructor(i){super(i),this._handles=new Je,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(v(()=>this.view,this._updateRotationWatcher,O))}destroy(){this._handles=Mt(this._handles),this.view=null}get canShowNorth(){const i=this.get("view.spatialReference");return!(!i||!i.isWebMercator&&!i.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const i={};this.view.type==="2d"?i.rotation=0:i.heading=0,this.callGoTo({target:i})}_updateForRotation(i){i!=null&&(this.orientation={z:i})}_updateForCamera(i){if(!i)return;const e=-i.heading;this.orientation={x:0,y:0,z:e}}_updateRotationWatcher(i){this._handles.removeAll(),i&&this._handles.add(i.type==="2d"?v(()=>i==null?void 0:i.rotation,this._updateForRotation,O):v(()=>i==null?void 0:i.camera,this._updateForCamera,O))}};a([l({readOnly:!0})],$t.prototype,"canShowNorth",null),a([l()],$t.prototype,"orientation",void 0),a([l({readOnly:!0})],$t.prototype,"state",null),a([l()],$t.prototype,"view",void 0),$t=a([I($m)],$t);const ol=$t,nt={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let Se=class extends ne{constructor(e,t){super(e,t),this.iconClass=nt.widgetIcon,this.messages=null,this.viewModel=new ol}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,s=t==="disabled",n=(t==="rotation"?"rotation":"compass")=="compass",r=s?-1:0,o={[nt.disabled]:s,[nt.interactive]:!s},c={[nt.northIcon]:n,[nt.rotationIcon]:!n},{messages:d}=this;return m("div",{bind:this,class:this.classes(nt.base,o),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":d.reset,title:d.reset},m("span",{"aria-hidden":"true",class:this.classes(nt.icon,c),styles:this._toRotationTransform(e)}),m("span",{class:nt.text},d.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};a([l()],Se.prototype,"goToOverride",null),a([l()],Se.prototype,"iconClass",void 0),a([l()],Se.prototype,"label",null),a([l(),se("esri/widgets/Compass/t9n/Compass")],Se.prototype,"messages",void 0),a([l()],Se.prototype,"view",null),a([l({type:ol})],Se.prototype,"viewModel",void 0),a([Me()],Se.prototype,"_reset",null),Se=a([I("esri.widgets.Compass")],Se);const Fm=Se;let Qt=class extends S{constructor(i){super(i),this.navigationMode="pan",this.view=null}initialize(){this.own(Xe(()=>{var i;return(i=this.view)==null?void 0:i.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};a([l({readOnly:!0})],Qt.prototype,"state",null),a([l()],Qt.prototype,"navigationMode",void 0),a([l()],Qt.prototype,"view",void 0),Qt=a([I("esri.widgets.NavigationToggleViewModel")],Qt);const al=Qt,we={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let Le=class extends ne{constructor(i,e){super(i,e),this.iconClass=we.widgetIcon,this.messages=null,this.viewModel=new al}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}set layout(i){i!=="horizontal"&&(i="vertical"),this._set("layout",i)}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}toggle(){return this.viewModel.toggle()}render(){const i=this.get("viewModel.state")==="disabled",e=this.get("viewModel.navigationMode")==="pan",t={[we.disabled]:i,[we.isLayoutHorizontal]:this.layout==="horizontal"},s={[we.activeButton]:e},n={[we.activeButton]:!e},r=i?-1:0,o=this.messages.toggle;return m("div",{bind:this,class:this.classes(we.base,t),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":o,title:o},m("div",{class:this.classes(we.button,we.panButton,s)},m("span",{class:we.panIcon})),m("div",{class:this.classes(we.button,we.rotateButton,n)},m("span",{class:we.rotationIcon})))}_toggle(){this.toggle()}};a([l()],Le.prototype,"iconClass",void 0),a([l()],Le.prototype,"label",null),a([l({value:"vertical"})],Le.prototype,"layout",null),a([l(),se("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Le.prototype,"messages",void 0),a([l()],Le.prototype,"view",null),a([l({type:al})],Le.prototype,"viewModel",void 0),a([Me()],Le.prototype,"_toggle",null),Le=a([I("esri.widgets.NavigationToggle")],Le);const Rm=Le,fi={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let pt=class extends ne{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const i=this.enabled?0:-1,e={[fi.disabled]:!this.enabled,[fi.interactive]:this.enabled},t={[this.iconClass]:!!this.iconClass};return m("div",{bind:this,class:this.classes(fi.button,e),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:i,title:this.title},m("span",{"aria-hidden":"true",role:"presentation",class:this.classes(fi.icon,t)}),m("span",{class:fi.iconText},this.title))}_triggerAction(){this.action.call(this)}};a([l()],pt.prototype,"action",void 0),a([l()],pt.prototype,"enabled",void 0),a([l()],pt.prototype,"iconClass",void 0),a([l()],pt.prototype,"title",void 0),a([Me()],pt.prototype,"_triggerAction",null),pt=a([I("esri.widgets.IconButton")],pt);const Ao=pt;let Xt=class extends S{get canZoomIn(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return e===0||i>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return e===0||i<e}};a([l({readOnly:!0})],Xt.prototype,"canZoomIn",null),a([l({readOnly:!0})],Xt.prototype,"canZoomOut",null),a([l()],Xt.prototype,"view",void 0),Xt=a([I("esri.widgets.Zoom.ZoomConditions2D")],Xt);const Sm=Xt;let Jt=class extends S{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([l({readOnly:!0})],Jt.prototype,"canZoomIn",null),a([l({readOnly:!0})],Jt.prototype,"canZoomOut",null),a([l()],Jt.prototype,"view",void 0),Jt=a([I("esri.widgets.Zoom.ZoomConditions3D")],Jt);const Lm=Jt;let mt=class extends S{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return M(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return M(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Sm({view:e}):e.type==="3d"&&(this._zoomConditions=new Lm({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Ti(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Ti(e.goTo({zoomFactor:.5}))}};a([l()],mt.prototype,"_zoomConditions",void 0),a([l()],mt.prototype,"canZoomIn",null),a([l()],mt.prototype,"canZoomOut",null),a([l({readOnly:!0})],mt.prototype,"state",null),a([l()],mt.prototype,"view",null),mt=a([I("esri.widgets.Zoom.ZoomViewModel")],mt);const ll=mt,_i={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Ze=class extends ne{constructor(e,t){super(e,t),this.iconClass=_i.widgetIcon,this.messages=null,this.viewModel=new ll}initialize(){this._zoomInButton=new Ao({action:this.zoomIn.bind(this),iconClass:_i.zoomInIcon}),this._zoomOutButton=new Ao({action:this.zoomOut.bind(this),iconClass:_i.zoomOutIcon})}destroy(){this._zoomInButton=le(this._zoomInButton),this._zoomOutButton=le(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[_i.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:s,canZoomOut:n}=e;this._zoomInButton.enabled=s,this._zoomOutButton.enabled=n;const{zoomIn:r,zoomOut:o}=this.messages;return this._zoomInButton.title=r,this._zoomOutButton.title=o,m("div",{class:this.classes(_i.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};a([l()],Ze.prototype,"iconClass",void 0),a([l()],Ze.prototype,"label",null),a([l({value:"vertical"})],Ze.prototype,"layout",null),a([l(),se("esri/widgets/Zoom/t9n/Zoom")],Ze.prototype,"messages",void 0),a([l()],Ze.prototype,"view",null),a([l({type:ll})],Ze.prototype,"viewModel",void 0),Ze=a([I("esri.widgets.Zoom")],Ze);const Dm=Ze;function Om(i){return i&&i.view!==void 0}let Ji=class extends xm{constructor(i){super(i),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([v(()=>this.components,this._componentsWatcher.bind(this),O),v(()=>this.view,this._updateViewAwareWidgets.bind(this),O)])}_add(i,e,t,s){if(typeof i=="string"&&this._defaultPositionLookup[i]){if(this._find(i))return;i=this._createComponent(i)}super._add(i,e,t,s)}_removeComponents(i){i.forEach(e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())})}_updateViewAwareWidgets(i){this.components.forEach(e=>{const t=this._find(e),s=t&&t.widget;Om(s)&&(s.view=i)})}_componentsWatcher(i,e){this._removeComponents(e),this._addComponents(i),this._adjustPadding(i)}_adjustPadding(i){if(!i.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(i){this.constructed&&i.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(i){const e=this._createWidget(i);if(e)return new Xi({id:i,node:e})}_createWidget(i){return i==="attribution"?this._createAttribution():i==="compass"?this._createCompass():i==="navigation-toggle"?this._createNavigationToggle():i==="zoom"?this._createZoom():void 0}_createAttribution(){return new Pm({view:this.view})}_createCompass(){return new Fm({view:this.view})}_createNavigationToggle(){return new Rm({view:this.view})}_createZoom(){return new Dm({view:this.view})}};a([l()],Ji.prototype,"components",void 0),Ji=a([I("esri.views.ui.DefaultUI")],Ji);const Vm=Ji;let es=class extends Vm{constructor(i){super(i),this.components=["attribution","zoom"]}};a([l()],es.prototype,"components",void 0),es=a([I("esri.views.ui.2d.DefaultUI2D")],es);const cl=es;var xn;let ts=xn=class extends Fi{constructor(i){super(i),this.color=new wt([0,0,0,1])}clone(){return new xn(tn({color:this.color}))}};a([l({type:wt,json:{write:!0}})],ts.prototype,"color",void 0),ts=xn=a([I("esri.webmap.background.ColorBackground")],ts);const Nm=ts;let dl,hl,ul,pl,ml,gl;async function zm(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:s,MagnifierView2D:n,Stage:r}]=await Promise.all([w(()=>import("./webglDeps-a4f110e1.js"),["assets/webglDeps-a4f110e1.js","assets/VertexArrayObject-8a5c7580.js","assets/Error-bd05b442.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/Texture-6f3336a0.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-cb6895d7.js","assets/enums-64ab819c.js","assets/ProgramTemplate-66c62c24.js","assets/programUtils-663da5ee.js"]),w(()=>import("./mapViewDeps-3a10fa17.js"),["assets/mapViewDeps-3a10fa17.js","assets/Error-bd05b442.js","assets/string-3d0ebcd3.js","assets/typedArrayUtil-2bcf3cee.js","assets/promiseUtils-29120e0a.js","assets/reactiveUtils-3c1b281e.js","assets/cast-daef7652.js","assets/ensureType-fa162cfc.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-c2b0ab45.js","assets/preload-helper-101896b7.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-f64c5776.js","assets/utils-6c2afd8b.js","assets/parser-e6166e34.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-d8fc77f0.js","assets/enums-4ca4641f.js","assets/MaterialKey-b4e71fc3.js","assets/Utils-c2939f8d.js","assets/mathUtils-daf59e84.js","assets/enums-8bf08d0c.js","assets/enums-64ab819c.js","assets/Texture-6f3336a0.js","assets/context-util-cb6895d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-2245b966.js","assets/BufferPool-c496e3db.js","assets/WGLContainer-db0ff963.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-5f39bd45.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-8a5c7580.js","assets/ProgramTemplate-66c62c24.js","assets/StyleDefinition-3c6a4c69.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-7c9ea581.js","assets/jsonUtils-8bd548d9.js","assets/Extent-7f29a1bb.js","assets/Polyline-c56eca9b.js","assets/OptimizedFeature-9345d11b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-663da5ee.js","assets/RenderingContext-7629f78b.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-f5d9de07.js","assets/arcadeOnDemand-87969052.js","assets/geometry-4b789d90.js","assets/typeUtils-d7b057b5.js","assets/jsonMap-a9c94baf.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-45a7fe45.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-72167b00.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-c27e6a55.js","assets/Matcher-41d9c6c0.js","assets/TileStrategy-a62d1e84.js","assets/TileStore-4c0c3140.js","assets/Queue-e839cb6a.js","assets/TileKey-ab325718.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-e996b56b.js","assets/TimeExtent-84882adb.js","assets/enumeration-e46f3fd4.js","assets/Field-0ac3c9d2.js","assets/fieldType-4ec45634.js","assets/Clonable-f249bc0f.js","assets/visualVariablesUtils-7af1d739.js","assets/visualVariablesUtils-b572c1c3.js","assets/tileUtils-d9c533ae.js","assets/TileClipper-eed3813b.js","assets/assets-4cb15247.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-36379339.js","assets/MemCache-5bd66e9c.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-ac0dca24.js","assets/Loadable-7c89bd10.js","assets/Promise-088a0e17.js","assets/locale-30120714.js","assets/PortalGroup-f3dee6d8.js","assets/PortalUser-cdb4116b.js","assets/persistableUrlUtils-7e525def.js","assets/styleUtils-84c98663.js","assets/CircularArray-d560a86f.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-78d35324.js","assets/FeatureSetReader-22887d5b.js","assets/centroid-de776b3b.js","assets/lengthUtils-5215af35.js","assets/unitUtils-43365914.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-996bdb9a.js","assets/normalizeUtilsSync-ae16ab2d.js","assets/normalizeUtils-d322ac85.js","assets/projectionSupport-1035a977.js","assets/projection-33a6cba9.js","assets/SimpleObservable-7c382d01.js","assets/zscale-a508c8e5.js","assets/json-48e3ea08.js","assets/labelingInfo-f1d3ed98.js","assets/symbols-fce921a6.js","assets/CIMSymbol-d0e12b74.js","assets/fieldUtils-021fea8a.js","assets/Symbol-f45dc441.js","assets/opacityUtils-94fd2faa.js","assets/aaBoundingBox-6fbd5972.js","assets/Collection-e2259e32.js","assets/collectionUtils-09289d8f.js","assets/labelUtils-4072dca9.js","assets/jsonUtils-f34afef9.js","assets/FeatureContainer-7a24e5ff.js","assets/TileContainer-e69647a1.js","assets/capabilities-320386e9.js","assets/schemaUtils-24d4fed0.js","assets/LayerFloorInfo-689deffc.js","assets/diffUtils-58fbd195.js","assets/createSymbolSchema-deb469a5.js","assets/rendererUtils-2abcd901.js","assets/FeatureReductionLayer-d7ad3b5e.js","assets/BlendLayer-1b58b599.js","assets/PopupTemplate-343851b8.js","assets/number-53937715.js","assets/Identifiable-e3a09883.js","assets/UniqueValueRenderer-83bbe8b7.js","assets/LegendOptions-54bbb61a.js","assets/colorRamps-3439e132.js","assets/Graphic-cf98a91a.js","assets/compilerUtils-06ced1a6.js","assets/jsonUtils-9c255ec7.js","assets/DictionaryLoader-d07ab55e.js","assets/deprecate-99da8bee.js","assets/OperationalLayer-7b681a2a.js","assets/ElevationInfo-4e7fad68.js","assets/util-7859c103.js","assets/ComputedAttributeStorage-1f3c802c.js","assets/FieldsIndex-394de0a1.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-98f52808.js","assets/asyncUtils-59234081.js","assets/requestImageUtils-39957a4b.js","assets/Basemap-8691c5d8.js","assets/loadAll-6dec1444.js","assets/PortalItem-07c1e88d.js","assets/messages-03a939ad.js","assets/writeUtils-7d75cb47.js","assets/layerUtils-6996b9ea.js","assets/CollectionFlattener-c6dafa4a.js","assets/TablesMixin-c836f156.js","assets/Layer-8a472a77.js","assets/Cyclical-1a93cb12.js","assets/workers-125ce03d.js","assets/Connection-98b56925.js","assets/intl-afc91037.js","assets/TileInfo-2e5a94dc.js","assets/widget-8a5f4608.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-1890fc00.js","assets/query-e9f3f48f.js","assets/pbfQueryUtils-21bc0894.js","assets/queryZScale-bb883c00.js","assets/FeatureSet-9ea00c01.js","assets/RelationshipQuery-c22f6308.js","assets/utils-95450d21.js","assets/ItemCache-9a7b0057.js","assets/TopFeaturesQuery-da583ecc.js","assets/FeatureLayer-029b8c63.js","assets/MultiOriginJSONSupport-03b5d89b.js","assets/FeatureLayerBase-eb47a35c.js","assets/HeightModelInfo-15bb1adf.js","assets/arcgisLayerUrl-269cc7a9.js","assets/editsZScale-b69b4057.js","assets/APIKeyMixin-abc940e1.js","assets/ArcGISService-a76daa10.js","assets/CustomParametersMixin-35ce1754.js","assets/EditBusLayer-0384e3a7.js","assets/OrderedLayer-f1fc272b.js","assets/PortalLayer-4d594091.js","assets/RefreshableLayer-b2e977af.js","assets/ScaleRangeLayer-d12362d4.js","assets/TemporalLayer-e6ec9fbe.js","assets/TimeInfo-cbe37d4e.js","assets/FeatureTemplate-a0acfd3d.js","assets/FeatureType-1ca0df1a.js","assets/fieldProperties-6efd2194.js","assets/versionUtils-95cac3d6.js","assets/styleUtils-77b2285b.js","assets/popupUtils-aa41216c.js","assets/Scheduler-74975675.js","assets/GraphicsCollection-e2a7679b.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js"])]);hl=i,ul=e,pl=t,ml=s,gl=n,dl=r}const Po=160;function Bm(i){return i&&i.declaredClass==="esri.Viewpoint"}let A=class extends dd(Pu($u(Yu))){constructor(i){super(i),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new is({getCollections:()=>{var e,t;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,this.layerViews,(t=this.basemapView)==null?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new bp(this),this._pePromise=null,this.floors=new H,this.highlightOptions=new el,this.inputManager=new om({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new tl,this.type="2d",this.ui=new cl,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new Ya,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([v(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(Po)},ki),this.on("resize",e=>this._resizeHandler(e)),v(()=>{var e;return(e=this.animationManager)==null?void 0:e.animation},e=>{this.animation=e})]),Ql()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Qc(this.featuresTilingScheme)}get initialExtentRequired(){var o;const{scale:i,constraints:e,center:t,viewpoint:s,extent:n}=this;let r=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!n&&(e!=null&&e.effectiveLODs||(r=-1),(!t||i===0&&r===-1)&&(!s||!M(s.targetGeometry)||s.targetGeometry.type!=="extent"&&!s.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!Ai()||(this._pePromise||(this._pePromise=ys().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const i=this._getDefaultViewpoint();if(!i)return!1;const e=this.spatialReference,t=ye(i.targetGeometry);return!!_s(t.spatialReference,e)||this._projectionEngineLoaded}set animation(i){const e=this._get("animation");if(i===e)return;if(e&&e.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i),this.frameTask.animationInProgress=!0;const t=()=>{var s;i===this._get("animation")&&(this._set("animation",null),(s=this.frameTask)==null||s.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};i.when(t,t)}get background(){return Um(this.map)?this.map.initialViewProperties.background:null}set background(i){this._override("background",i)}get center(){if(!this.ready)return this._get("center");const{center:i,spatialReference:e}=this.state.paddedViewState;return new K({x:i[0],y:i[1],spatialReference:e})}set center(i){if(i==null)return;if(!this.ready)return this._set("center",i),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void R.getLogger(this.declaredClass).error(new x("mapview:invalid-center","could not project the value in the view's spatial reference",{input:i,error:s}))}const t=this.viewpoint;wn(t,t,e),this.viewpoint=t}set constraints(i){const e=this._get("constraints");e&&(this.handles.remove("map-view-constraints"),e.destroy()),this._set("constraints",i),i&&(i.view=this,this.ready&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint)),this.handles.add(v(()=>i.version,()=>{this.ready&&this.state&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint))},ki),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(i){if(i==null)return;if(!i.width||!i.height)return void R.getLogger(this.declaredClass).error(new x("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",i),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void R.getLogger(this.declaredClass).error(new x("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const t=this.viewpoint;rp(t,t,e,this.size,{constraints:this.constraints}),this.viewpoint=t}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(i){this.ready?(this.state.padding=i,this._set("padding",this.state.padding)):this._set("padding",i)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(i){if(isNaN(i))return;if(!this.ready)return void this._set("rotation",i);const e=this.viewpoint;_p(e,e,i),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(i){if(!i||isNaN(i))return;if(!this.ready){this._set("scale",i),this._set("zoom",-1);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;_o(e,e,i),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var e,t,s;const i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(ve("esri-2d-log-updating")){const n=this.allLayerViews.reduce((r,o)=>({...r,[o.layer.id]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(e=this.layerViewManager)==null?void 0:e.updating}
-> labelManager.updating: ${(t=this.labelManager)==null?void 0:t.updating}
-> graphicsView.updating: ${(s=this.graphicsView)==null?void 0:s.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return i}get viewpoint(){if(!this.ready)return this._get("viewpoint");const i=this.state.paddedViewState;return i&&i.viewpoint.clone()}set viewpoint(i){if(i==null)return;if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let e,t;try{e=this._project(i,this.spatialReference),!i.scale||isNaN(i.scale)?t=new x("mapview:invalid-viewpoint",`invalid scale value of ${i.scale}`):$(i.targetGeometry)&&(t=new x("mapview:invalid-viewpoint","geometry not defined"))}catch(n){t=new x("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(t)return void R.getLogger(this.declaredClass).error(t);this._scaleBeforeChangingSpatialReference=null;const s=new Ve({targetGeometry:new K,scale:0,rotation:0});ke(s,e),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(i){if(i==null)return;if(!this.ready){this._set("zoom",i),this._set("scale",0);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const e=this.viewpoint;_o(e,e,this.constraints.zoomToScale(i)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(i,e){if(i)return this.animation&&(this.animation=null),this._createAnimation(),$n(()=>this.ready,e).then(()=>{const t={animate:!0,...e},s=ip(i,this);return this.animation.update(s),this._gotoTask={},t.animate?this._gotoAnimated(s,t):this._gotoImmediate(s,t)});R.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(i,e){const t=uo(i)?ho(this,i):i;if(!this.ready||isNaN(t.x)||isNaN(t.y))return{screenPoint:t,results:[]};let s=new Set,n=!1,r=null,o=null;e!=null&&e.include?Fo(e.include,$o(this,u=>s.add(u),u=>{r||(r=new Set),r.add(u)},u=>s.add(u),()=>n=!0)):(n=!0,s=new Set(this.allLayerViews)),e!=null&&e.exclude&&Fo(e.exclude,$o(this,u=>s.delete(u),u=>{o||(o=new Set),o.add(u)}));const c=this.allLayerViews.filter(u=>!u.suspended&&s.has(u)).reverse(),d=this.toMap(t);let h=[...n?this.graphicsView.hitTest(d).map(u=>({type:"graphic",graphic:u,layer:null,mapPoint:d})):[],...await Promise.all(c.map(u=>u.hitTest(d,t)).toArray())].filter(M).flat().filter(M);return r&&(h=h.filter(u=>!("graphic"in u)||!u.graphic||r.has(kn(u.graphic)))),o&&(h=h.filter(u=>!("graphic"in u)||!u.graphic||o.has(kn(u.graphic)))),{screenPoint:t,results:h}}async takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return dm(t,{format:e.format,quality:e.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return hm(t,this._pixelFormat)}_createScreenshotPlan(i){i=i||{};const e=this.supersampleScreenshotsEnabled?Math.min(4,gm(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let t;i.layers?(t=[],i.layers.forEach(r=>{const o=this.allLayerViews.find(c=>c.layer.id===r.id);o&&"container"in o&&o.container&&t.push(o.container)})):t=this._stage.children;const{format:s,quality:n}=mm(i.format,i.quality);return cm(i,e,this.size,this.padding,s,n,t,i.rotation)}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}toMap(i){if(!this.ready)return null;const e=uo(i)?ho(this,i):i,t=[0,0],[s,n]=this.state.toMap(t,[e.x,e.y]),r=this.spatialReference;return new K({x:s,y:n,spatialReference:r})}toScreen(i){if(!this.ready)return null;const e=this._project(i,this.spatialReference),t=[e.x,e.y];return this.state.toScreen(t,t),ue(t[0],t[1])}on(i,e,t,s){return this.inputManager&&this.viewEvents.on(i,e,t,s)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}whenLayerView(i){return super.whenLayerView(i)}graphicChanged(i){this.graphicsView&&this.graphicsView.graphicUpdateHandler(i)}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||null}hasLayerViewModule(i){return vo.hasLayerViewModule(i)}importLayerView(i){return vo.importLayerView(i)}pixelSizeAt(){return this.ready?this.state.resolution:(R.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(i){return this.hitTest(i).then(e=>({...e,mapPoint:this.toMap(i)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let i=Mm(this.type);return ve("safari")&&ve("safari")<9&&(i=new x("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ve("safari")})),M(i)?(R.getLogger(this.declaredClass).warn("#validate()",i.message),Promise.reject(i)):zm()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new vn),this.animation}_cancellableGoTo(i,e,t){const s=()=>i===this._gotoTask,n=t.then(()=>{s()&&(this.animation=null)}).catch(o=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),o}),r=new Promise(o=>o(n));return e.when().catch(()=>{s()&&r.cancel&&r.cancel()}),r}_gotoImmediate(i,e){const t=this._gotoTask,s=this.animation,n=i.then(r=>{if(_t(e),t!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=r,s.finish()});return this._cancellableGoTo(t,s,n)}_flipStationary(i){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<Po&&(this._stationaryTimer=this._flipStationary(e))},i)),this._stationaryTimer}_getDefaultViewpoint(){var C,P,D,L;const{constraints:i,initialExtent:e,map:t,padding:s,size:n}=this;if(!i)return null;const r=t&&"initialViewProperties"in t&&t.initialViewProperties,o={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};i.effectiveLODs?o.zoom!==-1&&(o.scale=i.zoomToScale(o.zoom)):o.zoom=-1;let c=null,d=null,h=0;const u=o.viewpoint&&o.viewpoint.rotation,p=o.viewpoint&&o.viewpoint.targetGeometry;M(p)&&(p.type==="extent"?c=p:p.type==="point"&&(d=p,h=o.viewpoint.scale));const g=o.extent||c||((P=ye((C=r==null?void 0:r.viewpoint)==null?void 0:C.targetGeometry))==null?void 0:P.extent)||e,f=o.center||d||(g==null?void 0:g.center),y=o.scale||h||((D=r==null?void 0:r.viewpoint)==null?void 0:D.scale)||g&&xi(g,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),T=o.rotation||u||((L=r==null?void 0:r.viewpoint)==null?void 0:L.rotation)||0;return f&&y?new Ve({targetGeometry:f,scale:y,rotation:T}):null}_gotoAnimated(i,e){const t=this._gotoTask,s=this.animation,n=i.then(r=>{if(_t(e),t!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");return s.update(r),this.animationManager.animate(s,this.viewpoint,e),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(t,s,n)}_project(i,e){var n;const t=i&&i.targetGeometry||i;if(!e)return i;if(!t)return null;if(e.imageCoordinateSystem||(n=t.spatialReference)!=null&&n.imageCoordinateSystem||gs(e,t.spatialReference))return i;const s=Ri(t,e);if(!s)throw new x("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:t,spatialReference:e});return Bm(i)?(i.targetGeometry=s,i):s}_resizeHandler(i){if(!this.ready)return;const e=this.state;let t=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[i.width,i.height],fp(t,t,s,this.state.paddedViewState.size,this.resizeAlign),t=this.constraints.constrain(t,null),this.state.viewpoint=t}_startup(){var c,d;this.timeline.begin("MapView Startup");const i=this._getDefaultViewpoint(),e=i.targetGeometry;try{this._project(i,this.spatialReference)}catch(h){R.getLogger(this.declaredClass).warn(new ir("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:e.toJSON(),spatialReference:this.spatialReference,error:h})),i.targetGeometry=((c=this.defaultsFromMap.extent)==null?void 0:c.center)||new K({x:0,y:0,spatialReference:this.spatialReference})}(d=this.constraints)==null||d.fit(i),this._set("state",new xp({padding:this._get("padding"),size:this.size,viewpoint:i})),this.graphics.owner=this;const t=new dl(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=t,this._magnifierView=new gl,this._magnifierView.magnifier=this.magnifier;const s=new pl({view:this});this._set("labelManager",s);const n=new wp({view:this});this._set("animationManager",n);const r=new ml({view:this,animationManager:n});this._set("mapViewNavigation",r),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("post-render",()=>this._set("rendering",t.renderRequested)),t.on("will-render",()=>this._set("rendering",t.renderRequested)),t.on("webgl-error",h=>this.fatalError=h.error),v(()=>this.stationary,h=>t.stationary=h,Tt),v(()=>this.background,h=>{t.background=h,this._magnifierView.background=h},Tt),v(()=>this.magnifier,h=>this._magnifierView.magnifier=h,Tt),v(()=>this.renderingOptions,h=>t.renderingOptions=h,Tt),v(()=>this.highlightOptions,h=>t.highlightOptions=h,Tt),v(()=>this.state.id,()=>t.state=this.state,Tt)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(h=>h(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[i,e],spatialReference:t,rotation:s,scale:n}=this.state.paddedViewState,r=new K({x:i,y:e,spatialReference:t});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",t),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this._stage.addChild(e.container)});const i=this.graphicsView;this._stage.addChild(i.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const i=new Xc(Jl.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",i);const e=new hl({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new ul(i)});this.frameTask.graphicsView=e,this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const i=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,i.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(i){if(!this.ready)return;this.frameTask.stop();for(const c of this.allLayerViews)c.processDetach();this._destroySpatialReferenceDependentProperties();const e=this.state.paddedViewState.clone();if($(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=e.scale;else{const c=e.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=c}const t=e.clone(),[s,n]=e.center;let r=null;try{r=this._project(new K({x:s,y:n,spatialReference:e.spatialReference}),i)}catch(c){Ai()||R.getLogger(this.declaredClass).warn(new ir("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:r.toJSON(),spatialReference:i,error:c}))}r||(r=new K({x:0,y:0,spatialReference:i}));const o=wn(new Ve({targetGeometry:new K,scale:0,rotation:0}),e.viewpoint,r);t.viewpoint=o;try{const d=[e.size[0]/2,e.size[1]/2],h=[d[0]+20,d[1]],u=e.toMap([0,0],h),{x:p,y:g}=this._project(new K({x:u[0],y:u[1],spatialReference:e.spatialReference}),i);u[0]=p,u[1]=g,t.toScreen(u,u);const f=mp(d,u,h),y=Math.hypot(u[0]-d[0],u[1]-d[1])/20;!Number.isFinite(y)||Math.abs(y)>4?(o.rotation=0,o.targetGeometry=new K({x:0,y:0,spatialReference:i})):(o.scale*=y,o.scale>ve("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(f)?f:0)}catch{}this._get("constraints").constrain(o,null),this._get("state").viewpoint=o,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const c of this.allLayerViews)c.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};A.type="2d",a([l({readOnly:!0})],A.prototype,"animationManager",void 0),a([l({constructOnly:!0})],A.prototype,"deactivatedWebGLExtensions",void 0),a([l({constructOnly:!0})],A.prototype,"debugWebGLExtensions",void 0),a([l({readOnly:!0})],A.prototype,"featuresTilingScheme",void 0),a([l({readOnly:!0})],A.prototype,"fullOpacity",void 0),a([l({readOnly:!0})],A.prototype,"graphicsTileStore",null),a([l()],A.prototype,"graphicsView",void 0),a([l({readOnly:!0})],A.prototype,"state",void 0),a([l()],A.prototype,"initialExtentRequired",null),a([l()],A.prototype,"labelManager",void 0),a([l({readOnly:!0})],A.prototype,"resourceManager",null),a([l({readOnly:!0})],A.prototype,"textureManager",null),a([l({readOnly:!0})],A.prototype,"mapViewNavigation",void 0),a([l({constructOnly:!0})],A.prototype,"renderCanvas",void 0),a([l()],A.prototype,"renderingOptions",void 0),a([l({readOnly:!0})],A.prototype,"rendering",void 0),a([l({constructOnly:!0})],A.prototype,"supersampleScreenshotsEnabled",void 0),a([l({readOnly:!0})],A.prototype,"supportsGround",void 0),a([l()],A.prototype,"_stationaryTimer",void 0),a([l()],A.prototype,"_defaultsFromMapSettings",null),a([l()],A.prototype,"_pePromise",void 0),a([l({readOnly:!0})],A.prototype,"typeSpecificPreconditionsReady",null),a([l()],A.prototype,"animation",null),a([l({type:Nm})],A.prototype,"background",null),a([l({value:null,type:K,dependsOn:["state.id","ready"]})],A.prototype,"center",null),a([l({type:Ya})],A.prototype,"constraints",null),a([l({value:null,type:ai,dependsOn:["state.id","ready"]})],A.prototype,"extent",null),a([l()],A.prototype,"floors",void 0),a([l({type:el})],A.prototype,"highlightOptions",void 0),a([l({readOnly:!0})],A.prototype,"inputManager",void 0),a([l()],A.prototype,"map",void 0),a([l({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],A.prototype,"padding",null),a([l()],A.prototype,"resizeAlign",void 0),a([l({readOnly:!0,dependsOn:["state.id"]})],A.prototype,"resolution",null),a([l({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"rotation",null),a([l({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"scale",null),a([l({constructOnly:!0})],A.prototype,"spatialReferenceLocked",void 0),a([l()],A.prototype,"stationary",null),a([l({type:tl,readOnly:!0})],A.prototype,"timeline",void 0),a([l({readOnly:!0})],A.prototype,"type",void 0),a([l({readOnly:!0})],A.prototype,"updating",null),a([l({value:null,type:Ve,dependsOn:["state.id","ready"]})],A.prototype,"viewpoint",null),a([l({value:-1,dependsOn:["state.id","ready"]})],A.prototype,"zoom",null),a([l({readOnly:!0})],A.prototype,"navigating",null),a([l({type:cl})],A.prototype,"ui",void 0),A=a([I("esri.views.MapView")],A);const qm=A;function kn(i){var t,s;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((s=i.sourceLayer)==null?void 0:s.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function $o(i,e,t,s,n){return r=>{if(r instanceof Nt){if(r.layer===i)n==null||n();else{const o=i.allLayerViews.find(c=>c.layer===r.layer);o&&(s==null||s(o))}t(kn(r))}else{const o=i.allLayerViews.find(c=>c.layer===r);o&&e(o)}}}function Fo(i,e){if(i)if(sr(i))for(const t of i)if(sr(t))for(const s of t)e(s);else e(t);else e(i)}function Um(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}const Hm=new ra({basemap:"streets-vector"});new qm({container:"viewDiv",map:Hm,zoom:8,center:[.1276,51.5]});export{sp as $,Ga as G,yt as P,Ly as R,Ts as S,si as a,Sy as b,up as c,tl as e,av as m,Ha as n,mp as p,Ve as u};
