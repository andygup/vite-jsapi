import{e,y as r,m as g,n as m,l as f}from"./cast-daef7652.js";import{a as d}from"./Error-bd05b442.js";import{r as v,f as y}from"./typedArrayUtil-2bcf3cee.js";import{b as x}from"./ensureType-fa162cfc.js";import{s as O}from"./jsonMap-a9c94baf.js";import{y as S}from"./string-3d0ebcd3.js";import{M as q,k as b,a as w}from"./Extent-7f29a1bb.js";var c;const $=new O({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let u=c=class extends g{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new c({categories:this.categories?S(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,i){let o,n;if(this.categories&&(o=this.categories.map(p=>Array.isArray(p)?JSON.stringify(p):p)),this.extent){const p=q(this.extent,b.WGS84);v(p)&&(n=`${p.xmin},${p.ymin},${p.xmax},${p.ymax}`)}let a=this.query;!this.disableExtraQuery&&t.extraQuery&&(a="("+a+")"+t.extraQuery);const l={categories:o,bbox:n,q:a,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(l.sortField=this.sortField.split(",").map(p=>$.toJSON(p.trim())).join(","),l.sortOrder=this.sortOrder),{query:{...i,...l}}}};e([r()],u.prototype,"categories",void 0),e([r()],u.prototype,"disableExtraQuery",void 0),e([r({type:w})],u.prototype,"extent",void 0),e([r()],u.prototype,"filter",void 0),e([r()],u.prototype,"num",void 0),e([r()],u.prototype,"query",void 0),e([r()],u.prototype,"sortField",void 0),e([r()],u.prototype,"sortOrder",null),e([r()],u.prototype,"start",void 0),u=c=e([m("esri.portal.PortalQueryParams")],u);const h=u;let s=class extends f{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){var o;const t=this.url,i=this.thumbnail;return t&&i&&this.portal?(o=this.portal)==null?void 0:o._normalizeUrl(`${t}/info/${i}?f=json`):null}get url(){const t=this.get("portal.restUrl");return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return y(this.portal)._request(this.url+"/categorySchema",t).then(i=>{const o=i.categorySchema||[];return o.some(n=>n.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):o})}fetchMembers(t){return y(this.portal)._request(this.url+"/users",t)}getThumbnailUrl(t){let i=this.thumbnailUrl;return i&&t&&(i+=`&w=${t}`),i}toJSON(){throw new d("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(t,i){let o=x(h,t);const n=y(this.portal);return parseFloat(n.currentVersion)>5?(o=o||new h,n._queryPortal(`/content/groups/${this.id}/search`,o,"PortalItem",i)):(o=o?o.clone():new h,o.query="group:"+this.id+(o.query?" "+o.query:""),n.queryItems(o,i))}_fetchCategorySchemaSet(t,i){const o=y(this.portal);return o._fetchSelf(o.authMode,!0,i).then(n=>{const a=n.contentCategorySetsGroupQuery;if(a){const l=new h;return l.disableExtraQuery=!0,l.num=1,l.query=a,o.queryGroups(l,i)}throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(n=>{if(n.total){const a=n.results[0],l=new h;return l.num=1,l.query=`typekeywords:"${t}"`,a.queryItems(l,i)}throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(n=>n.total?n.results[0].fetchData("json",i).then(a=>{const l=a&&a.categorySchema;return l&&l.length?l:[]}):[])}};e([r()],s.prototype,"access",void 0),e([r({type:Date})],s.prototype,"created",void 0),e([r()],s.prototype,"description",void 0),e([r()],s.prototype,"id",void 0),e([r()],s.prototype,"isInvitationOnly",void 0),e([r({type:Date})],s.prototype,"modified",void 0),e([r()],s.prototype,"owner",void 0),e([r()],s.prototype,"portal",void 0),e([r()],s.prototype,"snippet",void 0),e([r()],s.prototype,"sortField",void 0),e([r()],s.prototype,"sortOrder",void 0),e([r()],s.prototype,"tags",void 0),e([r()],s.prototype,"thumbnail",void 0),e([r({readOnly:!0})],s.prototype,"thumbnailUrl",null),e([r()],s.prototype,"title",void 0),e([r({readOnly:!0})],s.prototype,"url",null),s=e([m("esri.portal.PortalGroup")],s);const Q=s,U=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{U as P,h as d,Q as p};
