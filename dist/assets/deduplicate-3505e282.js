import{gx as k}from"./index-b4b3ae7d.js";import{n as S,c as L}from"./Indices-a579d3c9.js";function G(o,t,i){const c=Array.isArray(o),e=c?o.length/t:o.byteLength/(4*t),g=c?o:new Uint32Array(o,0,e*t),y=(i==null?void 0:i.minReduction)??0,s=(i==null?void 0:i.originalIndices)||null,O=s?s.length:0,a=(i==null?void 0:i.componentOffsets)||null;let x=0;if(a)for(let n=0;n<a.length-1;n++){const l=a[n+1]-a[n];l>x&&(x=l)}else x=e;const A=Math.floor(x*1.1)+1;(h==null||h.length<2*A)&&(h=new Uint32Array(k(2*A)));for(let n=0;n<A*2;n++)h[n]=0;let f=0;const I=!!a&&!!s,m=I?O:e;let u=S(e);const C=new Uint32Array(O),w=1.96;let T=y!==0?Math.ceil(4*w*w/(y*y)*y*(1-y)):m,U=1,q=a?a[1]:m;for(let n=0;n<m;n++){if(n===T){const r=1-f/n;if(r+w*Math.sqrt(r*(1-r)/n)<y)return null;T*=2}if(n===q){for(let r=0;r<A*2;r++)h[r]=0;if(s)for(let r=a[U-1];r<a[U];r++)C[r]=u[s[r]];q=a[++U]}const l=I?s[n]:n,z=l*t,H=B(g,z,t);let d=H%A,M=f;for(;h[d*2+1]!==0;){if(h[d*2]===H){const R=h[d*2+1]-1,b=R*t;if(j(g,z,b,t)){M=u[R];break}}d++,d>=A&&(d-=A)}M===f&&(h[d*2]=H,h[d*2+1]=l+1,f++),u[l]=M}if(y!==0&&1-f/e<y)return null;if(I){for(let n=a[U-1];n<C.length;n++)C[n]=u[s[n]];u=L(C)}const p=c?new Array(f):new Uint32Array(f*t);f=0;for(let n=0;n<m;n++)if(u[n]===f){const l=(I?s[n]:n)*t;v(g,l,p,f*t,t),f++}if(s&&!I){const n=new Uint32Array(O);for(let l=0;l<n.length;l++)n[l]=u[s[l]];u=L(n)}return{buffer:Array.isArray(p)?p:p.buffer,indices:u,uniqueCount:f}}function j(o,t,i,c){for(let e=0;e<c;e++)if(o[t+e]!==o[i+e])return!1;return!0}function v(o,t,i,c,e){for(let g=0;g<e;g++)i[c+g]=o[t+g]}function B(o,t,i){let c=0;for(let e=0;e<i;e++)c=o[t+e]+c|0,c=c+(c<<11)+(c>>>2)|0;return c>>>0}let h=null;export{G as d};
