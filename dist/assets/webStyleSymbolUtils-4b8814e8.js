import{E as D,cP as $,dt as O,du as y,dv as g,e4 as U,e6 as j,g1 as h,g2 as p}from"./index-37fc1c1b.js";import{i as E,a as d}from"./devEnvironmentUtils-e2e22b53.js";import{f as w}from"./jsonUtils-08626db6.js";import{f as C,s as F,r as N,m as v,S as I}from"./styleUtils-1f72c3eb.js";import"./featureFlags-ec64a754.js";function B(t,e,l,r){const a=t.name;return a==null?Promise.reject(new D("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?k(a,e,r):C(t,e,r).then(i=>M($(i),a,e,l,r))}function M(t,e,l,r,a){var S;const i=t.data,s=l&&l.portal!=null?l.portal:O.getDefault(),b={portal:s,url:y(t.baseUrl),origin:"portal-item"},o=i.items.find(m=>m.name===e);if(!o){const m=`The symbol name '${e}' could not be found`;return Promise.reject(new D("symbolstyleutils:symbol-name-not-found",m,{symbolName:e}))}let u=g(F(o,r),b),f=((S=o.thumbnail)==null?void 0:S.href)??null;const c=o.thumbnail&&o.thumbnail.imageData;E()&&(u=d(u)??"",f=d(f));const J={portal:s,url:y(U(u)),origin:"portal-item"};return N(u,a).then(m=>{const P=r==="cimRef"?v(m.data):m.data,n=w(P,J);if(n&&j(n)){if(f){const T=g(f,b);n.thumbnail=new h({url:T})}else c&&(n.thumbnail=new h({url:`data:image/png;base64,${c}`}));t.styleUrl?n.styleOrigin=new p({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(n.styleOrigin=new p({portal:l.portal,styleName:t.styleName,name:e}))}return n})}function k(t,e,l){const r=I.replace(/\{SymbolName\}/gi,t),a=e.portal!=null?e.portal:O.getDefault();return N(r,l).then(i=>{const s=v(i.data);return w(s,{portal:a,url:y(U(r)),origin:"portal-item"})})}export{M as fetchSymbolFromStyle,B as resolveWebStyleSymbol};
