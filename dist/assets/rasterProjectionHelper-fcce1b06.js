import{fq as Q,bs as En,bf as q,V as L,Q as z,aB as bn,cc as hn,K as N,fr as kn,E as Gn,fs as C,ft as _,fu as tn,fv as Nn,fw as jn,bt as _n,fx as en}from"./index-b51e75d5.js";var U;(function(n){n[n.None=0]="None",n[n.North=1]="North",n[n.South=2]="South",n[n.Both=3]="Both"})(U||(U={}));function xn(n,t,o){return!kn(n,t,o)}function O(n,t,o){const c=xn(n,t,o);if(c&&!Q())throw new Gn("rasterprojectionhelper-project","projection engine is not loaded");return c}const on=(n,t,o,c=0)=>{if(o[0]===1)return[0,0];let s=1,e=-1,i=1,r=-1;for(let x=0;x<n.length;x+=2)isNaN(n[x])||(s=s>n[x]?n[x]:s,e=e>n[x]?e:n[x],i=i>n[x+1]?n[x+1]:i,r=r>n[x+1]?r:n[x+1]);const{cols:u,rows:a}=t,l=(e-s)/u/o[0],y=(r-i)/a/o[1],g=c*2;let f=0,p=!1,d=[0,0];for(let x=0;x<u-3;x++){for(let P=0;P<a-3;P++){const m=x*a*2+P*2,h=(n[m]+n[m+4]+n[m+a*4]+n[m+a*4+4])/4,w=(n[m+1]+n[m+5]+n[m+a*4+1]+n[m+a*4+5])/4,M=Math.abs((h-n[m+a*2+2])/l),E=Math.abs((w-n[m+a*2+3])/y);if(M+E>f&&(f=M+E,d=[M,E]),g&&f>g){p=!0;break}}if(p)break}return d},Cn={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},F=32,B=4,$=B,J=new Map,H=new Map,X=500;async function An(){Q()||await En()}function Fn(n,t,o){return O(n.spatialReference,t),o?en(t,n.spatialReference,n):en(n.spatialReference,t,n)}function sn(n,t,o,c=null){const s=n.spatialReference;if(s.equals(t))return n;O(s,t,c);const e=o.center,i=new q({xmin:e.x-n.x/2,xmax:e.x+n.x/2,ymin:e.y-n.y/2,ymax:e.y+n.y/2,spatialReference:s}),r=L(i,t,c),u=W(t),a=r==null||u!=null&&r.width>=u;let l;if(a){const y=z(s)/z(t);l={x:n.x*y,y:n.y*y}}else l={x:r.width,y:r.height};return l}function j(n,t=.01){return z(n)?t/z(n):0}function cn(n,t,o=null,c=!0){const s=n.spatialReference;if(s.equals(t))return n;O(s,t,o);const e=L(n,t,o);return!c||!e||dn([n],[e],s,t),e}function dn(n,t,o,c){const s=Y(o,!0),e=Y(c,!0),i=j(o,X),r=j(c,X);if(i&&s!=null&&e!=null)for(let u=0;u<n.length;u++){const a=t[u];if(!a)continue;const{x:l}=n[u],{x:y}=a;y>=e[1]-r&&Math.abs(l-s[0])<i?a.x-=e[1]-e[0]:y<=e[0]+r&&Math.abs(l-s[1])<i&&(a.x+=e[1]-e[0])}}function Wn(n){const{inSR:t,outSR:o,datumTransformation:c,preferPE:s}=n;if(t.equals(o)){const{points:i}=V(n,null);return i}return t.isWebMercator&&o.isWGS84||t.isWGS84&&o.isWebMercator?vn(n):O(t,o,c)&&s&&(t.isGeographic||T(t)!=null)?rn(n):Sn(n)}function Sn(n){const{points:t}=V(n,null),{inSR:o,outSR:c,datumTransformation:s}=n,e=t.map(r=>new N(r[0],r[1],o)),i=L(e,c,s);return s&&dn(e,i,o,c),i.map(r=>r?[r.x,r.y]:[NaN,NaN])}function rn(n){const{inSR:t,outSR:o,datumTransformation:c}=n,s=T(t),{points:e,mask:i}=V(n,s);if(!t.isGeographic){const u=t.wkid?C.coordsys(t.wkid):C.fromString(t.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,t.wkt);tn.projToGeog(u,e.length,e)}if(c!=null&&c.steps.length){let u;if(o.isGeographic&&(u=e.map(([l])=>l>179.9955?1:l<-179.9955?-1:0)),c.steps.forEach(l=>{const y=l.wkid?C.geogtran(l.wkid):C.fromString(_.PE_TYPE_GEOGTRAN,l.wkt);Nn.geogToGeog(y,e.length,e,null,l.isInverse?_.PE_TRANSFORM_2_TO_1:_.PE_TRANSFORM_1_TO_2)}),u)for(let l=0;l<e.length;l++){const y=u[l],g=e[l][0],f=g>179.9955?1:g<-179.9955?-1:0;y&&f&&y!==f&&(e[l][0]=y>0?g+360:g-360)}}if(!o.isGeographic){const u=T(o,!0),a=u!=null&&u.isEnvelope?[u.bbox[1],u.bbox[3]]:[-90,90];Rn(e,a);const l=o.wkid?C.coordsys(o.wkid):C.fromString(o.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,o.wkt);tn.geogToProj(l,e.length,e)}let r=e;if(i&&e.length!==i.length){r=[];for(let u=0,a=0;u<i.length;u++)i[u]?r.push(e[a++]):r.push([NaN,NaN])}return r}function vn(n){const{cols:t,rows:o,xres:c,yres:s,usePixelCenter:e,inSR:i,outSR:r}=n;let{xmin:u,ymax:a}=n;e&&(u+=c/2,a-=s/2);const l=[],y=[],g=Math.max(t,o);for(let p=0;p<g;p++){const d=u+c*Math.min(t,p),x=a-s*Math.min(o,p),P=L(new N({x:d,y:x,spatialReference:i}),r);p<=t&&l.push(P.x),p<=o&&y.push(P.y)}const f=[];for(let p=0;p<t;p++)for(let d=0;d<o;d++)f.push([l[p],y[d]]);return f}function T(n,t=!1){let o=n.wkid||n.wkt;if(!o||n.isGeographic)return null;if(o=String(o),J.has(o)){const r=J.get(o);return t?r==null?void 0:r.gcs:r==null?void 0:r.pcs}const c=n.wkid?C.coordsys(n.wkid):C.fromString(n.isGeographic?_.PE_TYPE_GEOGCS:_.PE_TYPE_PROJCS,n.wkt),s=j(n,1e-4),e=ln(c,s),i=ln(c,0,!0);return J.set(o,{pcs:e,gcs:i}),t?i:e}function ln(n,t=0,o=!1){const c=jn.generate(n),s=o?n.horizonGcsGenerate():n.horizonPcsGenerate();if(!c||!(s!=null&&s.length))return null;let e=!1,i=s.find(x=>x.getInclusive()===1&&x.getKind()===1);if(!i){if(i=s.find(x=>x.getInclusive()===1&&x.getKind()===0),!i)return null;e=!0}const r=o?0:(c.getNorthPoleLocation()===2?1:0)|(c.getSouthPoleLocation()===2?2:0),u=c.isPannableRectangle(),a=i.getCoord();if(e)return{isEnvelope:e,isPannable:u,vertices:a,coef:null,bbox:[a[0][0]-t,a[0][1]-t,a[1][0]+t,a[1][1]+t],poleLocation:r};let l=0;const y=[];let[g,f]=a[0],[p,d]=a[0];for(let x=0,P=a.length;x<P;x++){l++,l===P&&(l=0);const[m,h]=a[x],[w,M]=a[l];if(M===h)y.push([m,w,h,M,2]);else{const E=(w-m)/(M-h||1e-4),G=m-E*h;h<M?y.push([E,G,h,M,0]):y.push([E,G,M,h,1])}g=g<m?g:m,f=f<h?f:h,p=p>m?p:m,d=d>h?d:h}return{isEnvelope:!1,isPannable:u,vertices:a,coef:y,bbox:[g,f,p,d],poleLocation:r}}function V(n,t){const o=[],{cols:c,rows:s,xres:e,yres:i,usePixelCenter:r}=n;let{xmin:u,ymax:a}=n;if(r&&(u+=e/2,a-=i/2),t==null){for(let f=0;f<c;f++)for(let p=0;p<s;p++)o.push([u+e*f,a-i*p]);return{points:o}}const l=new Uint8Array(c*s);if(t.isEnvelope){const{bbox:[f,p,d,x]}=t;for(let P=0,m=0;P<c;P++){const h=u+e*P,w=t.isPannable||h>=f&&h<=d;for(let M=0;M<s;M++,m++){const E=a-i*M;w&&E>=p&&E<=x&&(o.push([h,E]),l[m]=1)}}return{points:o,mask:l}}const y=t.coef,g=[];for(let f=0;f<s;f++){const p=a-i*f,d=[],x=[];for(let m=0;m<y.length;m++){const[h,w,M,E,G]=y[m];if(p===M&&M===E)d.push(h),d.push(w),x.push(2),x.push(2);else if(p>=M&&p<=E){const k=h*p+w;d.push(k),x.push(G)}}let P=d;if(d.length>2){let m=x[0]===2?0:x[0],h=d[0];P=[];for(let w=1;w<x.length;w++)x[w]===2&&w!==x.length-1||(x[w]!==m&&(P.push(m===0?Math.min(h,d[w-1]):Math.max(h,d[w-1])),m=x[w],h=d[w]),w===x.length-1&&P.push(x[w]===0?Math.min(h,d[w]):Math.max(h,d[w])));P.sort((w,M)=>w-M)}else d[0]>d[1]&&(P=[d[1],d[0]]);g.push(P)}for(let f=0,p=0;f<c;f++){const d=u+e*f;for(let x=0;x<s;x++,p++){const P=a-i*x,m=g[x];if(m.length===2)d>=m[0]&&d<=m[1]&&(o.push([d,P]),l[p]=1);else if(m.length>2){let h=!1;for(let w=0;w<m.length;w+=2)if(d>=m[w]&&d<=m[w+1]){h=!0;break}h&&(o.push([d,P]),l[p]=1)}}}return{points:o,mask:l}}function Rn(n,t){const[o,c]=t;for(let s=0;s<n.length;s++){const e=n[s][1];(e<o||e>c)&&(n[s]=[NaN,NaN])}}function mn(n){const t=W(n[0].spatialReference);if(n.length<2||t==null)return n[0];const o=j(n[0].spatialReference);if(n=n.filter(r=>r.width>o),n.length===1)return n[0];let{xmin:c,xmax:s,ymin:e,ymax:i}=n[0];for(let r=1;r<n.length;r++){const u=n[r];s=u.xmax+t*r,e=Math.min(e,u.ymin),i=Math.max(i,u.ymax)}return new q({xmin:c,xmax:s,ymin:e,ymax:i,spatialReference:n[0].spatialReference})}function pn(n,t,o=null,c=!0){const s=n.spatialReference;if(s.equals(t))return n;const e=Ln(n),i=W(s,!0),r=W(t);if(e===0||i==null||r==null){const l=an(n,t,o,c);if(i==null&&r!=null&&Math.abs(l.width-r)<j(t)&&Q()){const y=T(s);if(y!=null&&y.poleLocation===U.None&&n.width<(y.bbox[2]-y.bbox[0])/2)return Tn(n,t)||l}return l}const u=n.clone().normalize();if(u.length===1&&n.xmax<i&&n.xmax-i/2>j(s)){const{xmin:l,xmax:y}=n;for(let g=0;g<=e;g++){const f=g===0?l:-i/2,p=g===e?y-i*g:i/2;u[g]=new q({xmin:f,xmax:p,ymin:n.ymin,ymax:n.ymax,spatialReference:s})}}const a=u.map(l=>an(l,t,o,c));return mn(a.filter(bn))}function Bn(n,t,o){if(n.type==="extent"){const{xmin:s,ymin:e,xmax:i,ymax:r,spatialReference:u}=n,a=[[[s,r],[i,r],[i,e],[s,e],[s,r]]];n=new hn({rings:a,spatialReference:u})}return n.spatialReference.equals(t)?n:(O(n.spatialReference,t,o),L(n,t,o))}function Tn(n,t){const o=W(t);if(o==null)return null;let{xmin:c,ymin:s,xmax:e,ymax:i}=n;const r=n.spatialReference,u=new hn({spatialReference:r,rings:[[[c,s],[e,s],[e,i],[c,i],[c,s]]]}),a=L(u,t);if(a.rings.length!==2||!a.rings[0].length||!a.rings[1].length)return null;const{rings:l}=a,y=j(r),g=new q({spatialReference:t});for(let f=0;f<2;f++){c=e=l[f][0][0],s=i=l[f][0][1];for(let p=0;p<l[f].length;p++)c=c>l[f][p][0]?l[f][p][0]:c,e=e<l[f][p][0]?l[f][p][0]:e,s=s>l[f][p][1]?l[f][p][1]:s,i=i<l[f][p][1]?l[f][p][1]:i;if(f===0)g.ymin=s,g.ymax=i,g.xmin=c,g.xmax=e;else if(g.ymin=Math.min(g.ymin,s),g.ymax=Math.max(g.ymax,i),Math.abs(e-o/2)<y)g.xmin=c,g.xmax=g.xmax+o;else if(Math.abs(c+o/2)<y)g.xmax=e+o;else return null}return g}function an(n,t,o=null,c=!0,s=!0){const e=n.spatialReference;if(e.equals(t)||!t)return n;O(e,t,o);const i=L(n,t,o);if(s&&t.isWebMercator&&i&&(i.ymax=Math.min(20037508342787e-6,i.ymax),i.ymin=Math.max(-20037508342787e-6,i.ymin),i.ymin>=i.ymax))return null;if(!c||!i)return i;const r=Y(e,!0),u=Y(t,!0);if(r==null||u==null)return i;const a=j(e,.001),l=j(e,X),y=j(t,.001);if(Math.abs(i.xmin-u[0])<y&&Math.abs(i.xmax-u[1])<y){const f=Math.abs(n.xmin-r[0]),p=Math.abs(r[1]-n.xmax);if(f<a&&p>l){i.xmin=u[0];const P=[];P.push(new N(n.xmax,n.ymin,e)),P.push(new N(n.xmax,(n.ymin+n.ymax)/2,e)),P.push(new N(n.xmax,n.ymax,e));const m=P.map(h=>cn(h,t,o)).filter(h=>!isNaN(h==null?void 0:h.x)).map(h=>h.x);i.xmax=Math.max.apply(null,m)}if(p<a&&f>l){i.xmax=u[1];const P=[];P.push(new N(n.xmin,n.ymin,e)),P.push(new N(n.xmin,(n.ymin+n.ymax)/2,e)),P.push(new N(n.xmin,n.ymax,e));const m=P.map(h=>cn(h,t,o)).filter(h=>!isNaN(h==null?void 0:h.x)).map(h=>h.x);i.xmin=Math.min.apply(null,m)}}else{const f=j(t,.001);Math.abs(i.xmin-u[0])<f&&(i.xmin=u[0]),Math.abs(i.xmax-u[1])<f&&(i.xmax=u[1])}return i}function W(n,t=!1){if(!n)return null;const o=t?20037508342787e-6:20037508342788905e-9;return n.isWebMercator?o*2:n.wkid&&n.isGeographic?360:Cn[n.wkid]*2||null}function Y(n,t=!1){if(n.isGeographic)return[-180,180];const o=W(n,t);return o!=null?[-o/2,o/2]:null}function un(n,t,o,c){let s=(n-t)/o;return s-Math.floor(s)!==0?s=Math.floor(s):c&&(s-=1),s}function Ln(n,t=!1){const o=W(n.spatialReference);if(o==null)return 0;const c=o/2,s=t?0:-c,e=j(n.spatialReference),i=!t&&Math.abs(n.xmax-o/2)<e?o/2:n.xmax,r=!t&&Math.abs(n.xmin+o/2)<e?-o/2:n.xmin,u=un(i,s,o,!0),a=un(r,s,o,!1);return u-a}function Xn(n){const t=n.storageInfo.origin.x,o=W(n.spatialReference,!0);if(o==null)return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const c=o/2,{nativePixelSize:s,storageInfo:e,extent:i}=n,{maximumPyramidLevel:r,blockWidth:u,pyramidScalingFactor:a}=e;let l=s.x;const y=[],g=n.transform!=null&&n.transform.type==="gcs-shift",f=t+(g?0:c),p=g?o-t:c-t;for(let d=0;d<=r;d++){const x=(i.xmax-t)/l/u,P=x-Math.floor(x)===0?x:Math.ceil(x),m=p/l/u,h=m-Math.floor(m)===0?m:Math.ceil(m),w=Math.floor(f/l/u),M=Math.round(f/l)%u,E=Math.round(p/l)%u,G=(u-E)%u;y.push({resolutionX:l,blockWidth:u,datsetColumnCount:P,worldColumnCountFromOrigin:h,leftMargin:M,rightPadding:G,originColumnOffset:w}),l*=a}return{originX:t,halfWorldWidth:c,pyramidsInfo:y,hasGCSSShiftTransform:g}}function On(n){if(!n||n.isGeographic)return n;const t=String(n.wkid||n.wkt);let o;return H.has(t)?o=H.get(t):(o=(n.wkid?C.coordsys(n.wkid):C.fromString(_.PE_TYPE_PROJCS,n.wkt)).getGeogcs().getCode(),H.set(t,o)),new _n({wkid:o})}function Yn(n){const t=n.isAdaptive&&n.spacing==null;let o=n.spacing||[F,F],c=K(n),s={cols:c.size[0]+1,rows:c.size[1]+1};const e=c.outofBoundPointCount>0&&c.outofBoundPointCount<c.offsets.length/2;let r=c.outofBoundPointCount===c.offsets.length/2||t&&e?[0,0]:on(c.offsets,s,o,$);const u=(r[0]+r[1])/2,a=n.projectedExtent.spatialReference,l=n.srcBufferExtent.spatialReference;if(t&&(e||u>$)&&(xn(a,l,n.datumTransformation)&&(a.isGeographic||T(a)!=null),o=[B,B],c=K({...n,spacing:o}),s={cols:c.size[0]+1,rows:c.size[1]+1},r=on(c.offsets,s,o,$)),c.error=r,o[0]>1&&(c.coefficients=fn(c.offsets,s,e)),n.includeGCSGrid&&!a.isGeographic&&!a.isWebMercator)if(l.isGeographic)c.gcsGrid={offsets:c.offsets,coefficients:c.coefficients,spacing:o};else{const y=T(a);if(y!=null&&!y.isEnvelope){const g=On(a),f=pn(n.projectedExtent,g),{offsets:p}=K({...n,srcBufferExtent:f,spacing:o}),d=fn(p,s,e);c.gcsGrid={offsets:p,coefficients:d,spacing:o}}}return c}function K(n){const{projectedExtent:t,srcBufferExtent:o,pixelSize:c,datumTransformation:s,rasterTransform:e}=n,i=t.spatialReference,r=o.spatialReference,u=O(i,r),{xmin:a,ymin:l,xmax:y,ymax:g}=t,f=W(r),p=f!=null&&(n.hasWrapAround||(e==null?void 0:e.type)==="gcs-shift"),d=n.spacing||[F,F],x=d[0]*c.x,P=d[1]*c.y,m=d[0]===1,h=Math.ceil((y-a)/x-.1/d[0])+(m?0:1),w=Math.ceil((g-l)/P-.1/d[1])+(m?0:1),M=Wn({cols:h,rows:w,xmin:a,ymax:g,xres:x,yres:P,inSR:i,outSR:r,datumTransformation:s,preferPE:d[0]<=B,usePixelCenter:m}),E=[];let G,k=0;const S=m?-1:NaN,{xmin:R,xmax:D,ymax:gn,width:yn,height:wn}=o,Pn=j(r,X),Mn=f!=null&&R>0&&D>f/2;let Z=!1;if(u){const v=T(i);Z=v!=null&&v.poleLocation>0}for(let v=0;v<h;v++){const I=[];for(let A=0;A<w;A++){let b=M[v*w+A];if(p&&b[0]>D&&b[0]>f/2-Pn?b[0]-=f:p&&v===0&&b[0]<0&&Mn&&!e&&(b[0]+=f),!b||isNaN(b[0])||isNaN(b[1])){E.push(S),E.push(S),I.push(null),k++;continue}if(e){const nn=e.inverseTransform(new N({x:b[0],y:b[1],spatialReference:r}));b=[nn.x,nn.y]}I.push(b),v>0&&p&&G[A]&&b[0]<G[A][0]&&(b[0]+=f,Z&&b[0]>D&&b[0]>f&&(b[0]-=f)),E.push((b[0]-R)/yn),E.push((gn-b[1])/wn)}G=I}return{offsets:E,error:null,coefficients:null,outofBoundPointCount:k,spacing:d,size:m?[h,w]:[h-1,w-1]}}function fn(n,t,o){const{cols:c,rows:s}=t,e=new Float32Array((c-1)*(s-1)*2*6),i=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),r=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let u=0;u<c-1;u++){for(let a=0;a<s-1;a++){let l=u*s*2+a*2;const y=n[l],g=n[l+1],f=n[l+2],p=n[l+3];l+=s*2;const d=n[l],x=n[l+1],P=n[l+2],m=n[l+3];let h=0,w=(a*(c-1)+u)*12;for(let M=0;M<3;M++)e[w++]=i[h++]*y+i[h++]*f+i[h++]*P;h=0;for(let M=0;M<3;M++)e[w++]=i[h++]*g+i[h++]*p+i[h++]*m;h=0;for(let M=0;M<3;M++)e[w++]=r[h++]*y+r[h++]*d+r[h++]*P;h=0;for(let M=0;M<3;M++)e[w++]=r[h++]*g+r[h++]*x+r[h++]*m}if(o)for(let a=0;a<e.length;a++)isNaN(e[a])&&(e[a]=-1)}return e}function qn(n){const t=n.clone().normalize();return t.length===1?t[0]:mn(t)}function Dn(n,t,o){const{storageInfo:c,pixelSize:s}=t;let e=0,i=!1;const{pyramidResolutions:r}=c;if(r!=null&&r.length){const f=(n.x+n.y)/2,p=r[r.length-1],d=(p.x+p.y)/2,x=(s.x+s.y)/2;if(f<=x)e=0;else if(f>=d)e=r.length,i=f/d>8;else{let m=x,h;for(let w=1;w<=r.length;w++){if(h=(r[w-1].x+r[w-1].y)/2,f<=h){f===h?e=w:o==="down"?(e=w-1,i=f/m>8):o==="up"||f-m>h-f||f/m>2?e=w:e=w-1;break}m=h}}const P=e===0?s:r[e-1];if(i){const m=Math.min(P.x,P.y),h=z(t.spatialReference);m*h>19567&&(i=!1)}return{pyramidLevel:e,pyramidResolution:new N({x:P.x,y:P.y,spatialReference:t.spatialReference}),excessiveReading:i}}const u=Math.log(n.x/s.x)/Math.LN2,a=Math.log(n.y/s.y)/Math.LN2,l=t.storageInfo.maximumPyramidLevel||0;e=o==="down"?Math.floor(Math.min(u,a)):o==="up"?Math.ceil(Math.max(u,a)):Math.round((u+a)/2),e<0?e=0:e>l&&(i=e>l+3,e=l);const y=2**e,g=new N({x:y*t.nativePixelSize.x,y:y*t.nativePixelSize.y,spatialReference:t.spatialReference});return{pyramidLevel:e,pyramidResolution:g,excessiveReading:i}}function In(n,t,o=512,c=!0){var G;const{extent:s,spatialReference:e,pixelSize:i}=n,r=sn(new N({x:i.x,y:i.y,spatialReference:e}),t,s);if(r==null)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const u=(r.x+r.y)/2,a=z(t),l=u*a*96*39.37,y=t.isGeographic?2958287637958547e-7*(256/o):591657527591555e-6*(256/o);let g=n.dataType==="vector-magdir"||n.dataType==="vector-uv";const f=pn(s,t),p=Math.min(Math.ceil(Math.log(Math.min(n.width,n.height)/32)/Math.LN2),Math.ceil(Math.log(y/2/l)/Math.LN2));if(!g&&c&&(t.isGeographic||t.isWebMercator)&&(g=f.xmin*f.xmax<0,!g&&p<3)){const k=W(t);if(k!=null){const S=2**p*u*o,R=Math.ceil(k/S);g=R===1||R===2&&k/2-f.xmax<S}}let d=l,x;const P=1.001,m=Math.min(2,Math.max(1.414,((G=n.storageInfo)==null?void 0:G.pyramidScalingFactor)||2));if(g){d=y;const k=t.isGeographic?1341104507446289e-21:.29858214164761665,S=k*(a*96*39.37),R=t.isGeographic?4326:3857;x=sn(new N({x:k,y:k,spatialReference:{wkid:R}}),e,f),x.x*=d/S,x.y*=d/S}else{x={x:i.x,y:i.y};let k=0;for(;d<y*(P/2)&&k<p;)k++,d*=m,x.x*=m,x.y*=m;Math.max(d,y)/Math.min(d,y)<=P&&(d=y)}const h=[d],w=[{x:x.x,y:x.y}],E=Math.min(70.5310735,l)/P;for(;d>=E;)d/=m,x.x/=m,x.y/=m,h.push(d),w.push({x:x.x,y:x.y});return{projectedPixelSize:r,scales:h,srcResolutions:w,isCustomTilingScheme:!g}}export{Fn as a,sn as b,In as c,Yn as d,cn as e,qn as f,W as g,Ln as h,Xn as i,Bn as j,An as l,pn as p,xn as r,Dn as s};
