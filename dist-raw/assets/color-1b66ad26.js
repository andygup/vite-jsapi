import{L as w,E as C}from"./index-0cbe37a0.js";import{C as d,J as N}from"./enums-eb6e4255.js";import{U as g,e as S,D as o}from"./enums-08489827.js";import{V as v}from"./VertexElementDescriptor-24e04d97.js";var c;(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"})(c||(c={}));var M;(function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(M||(M={}));var f;(function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"})(f||(f={}));var U;(function(t){t[t.NONE=0]="NONE",t[t.OPACITY=1]="OPACITY",t[t.COLOR=2]="COLOR",t[t.ROTATION=4]="ROTATION",t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(U||(U={}));var m;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(m||(m={}));var p;(function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"})(p||(p={}));var T;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"})(T||(T={}));const A=w.getLogger("esri.views.2d.engine.webgl.Utils"),E="geometry",x=[{name:E,strideInBytes:36}],Y=[{name:E,strideInBytes:12}],z=[{name:E,strideInBytes:36}],y=[{name:E,strideInBytes:24}],Z=[{name:E,strideInBytes:12}],k=[{name:E,strideInBytes:40}],$=[{name:E,strideInBytes:36}],b=[{name:E,strideInBytes:36}];function _(t){const n={};for(const e of t)n[e.name]=e.strideInBytes;return n}const K=_(x),J=_(Y),q=_(z),Q=_(y),j=_(Z),V=_(k),G=_($),W=_(b);function dt(t,n){switch(t){case c.MARKER:switch(n){case T.HEATMAP:return J;default:return K}case c.FILL:switch(n){case T.DOT_DENSITY:return j;case T.SIMPLE:case T.OUTLINE_FILL_SIMPLE:return Q;default:return q}case c.LINE:return V;case c.TEXT:return G;case c.LABEL:return W}}const tt=[E],nt=[E],et=[E],at=[E],it=[E];function st(t){switch(t){case c.MARKER:return tt;case c.FILL:return nt;case c.LINE:return et;case c.TEXT:return at;case c.LABEL:return it}}function rt(t){switch(t%4){case 0:case 2:return 4;case 1:case 3:return 1}}function Nt(t,n){switch(n%4){case 0:case 2:return new Uint32Array(Math.floor(t*n/4));case 1:case 3:return new Uint8Array(t*n)}}function Ct(t,n){switch(n%4){case 0:case 2:return new Uint32Array(t);case 1:case 3:return new Uint8Array(t)}}function Lt(t){return t!=null}function Rt(t){return typeof t=="number"}function Ot(t){switch(t){case"butt":return d.BUTT;case"round":return d.ROUND;case"square":return d.SQUARE;default:return A.error(new C("mapview-invalid-type",`Cap type ${t} is not a valid option. Defaulting to round`)),d.ROUND}}function Dt(t){switch(t){case"miter":return N.MITER;case"bevel":return N.BEVEL;case"round":return N.ROUND;default:return A.error(new C("mapview-invalid-type",`Join type ${t} is not a valid option. Defaulting to round`)),N.ROUND}}function Mt(t){switch(t){case"opacity":return f.OPACITY;case"color":return f.COLOR;case"rotation":return f.ROTATION;case"size":return f.SIZE;default:return A.error(`Cannot interpret unknown vv: ${t}`),null}}function Ut(t,n,e,a,i,r,s){for(const I in r){const u=r[I].stride,L=rt(u),O=r[I].data,D=e[I].data;if(O==null||D==null)continue;const h=u*i.vertexCount/L,H=u*t/L,X=u*i.vertexFrom/L;for(let l=0;l<h;++l)D[l+H]=O[l+X]}if(s!=null&&a!=null){const I=i.indexCount;for(let u=0;u<I;++u)a[u+n]=s[u+i.indexFrom]-i.vertexFrom+t}}const mt={[E]:g.STATIC_DRAW};function pt(t,n){const e=[];for(let a=0;a<5;++a){const i=st(a),r={};for(const s of i)r[s]={data:n(a,s)};e.push({data:t(a),buffers:r})}return e}function ct(t){switch(t){case o.BYTE:case o.UNSIGNED_BYTE:return 1;case o.SHORT:case o.UNSIGNED_SHORT:return 2;case o.FLOAT:case o.INT:case o.UNSIGNED_INT:return 4}}function Bt(t){switch(t){case S.UNSIGNED_BYTE:return 1;case S.UNSIGNED_SHORT_4_4_4_4:return 2;case S.FLOAT:return 4;default:A.error(new C("webgl-utils",`Unable to handle type ${t}`));return}}function Pt(t){switch(t){case S.UNSIGNED_BYTE:return Uint8Array;case S.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case S.FLOAT:return Float32Array;default:A.error(new C("webgl-utils",`Unable to handle type ${t}`));return}}function Et(t){var e;const n={};for(const a in t){const i=t[a];let r=0;n[a]=i.map(s=>{const I=new v(s.name,s.count,s.type,r,0,s.normalized||!1);return r+=s.count*ct(s.type),I}),(e=n[a])==null||e.forEach(s=>s.stride=r)}return n}const ut=t=>{const n=new Map;for(const e in t)for(const a of t[e])n.set(a.name,a.location);return n},It=t=>{const n={};for(const e in t){const a=t[e];n[e]=a!=null&&a.length?a[0].stride:0}return n},R=new Map,Ft=(t,n)=>{if(!R.has(t)){const e=Et(n),a=It(e),i=ut(n),r={strides:a,bufferLayouts:e,attributes:i};R.set(t,r)}return R.get(t)};function ht(t){t(c.FILL),t(c.LINE),t(c.MARKER),t(c.TEXT),t(c.LABEL)}const Ht=t=>"path"in t&&_t(t.path),Xt=t=>"url"in t&&t.url||"imageData"in t&&t.imageData,wt=t=>"imageData"in t&&t.imageData&&"contentType"in t&&t.contentType?`data:${t.contentType};base64,${t.imageData}`:"url"in t?t.url:null,B=t=>t!=null&&t.startsWith("data:image/gif"),gt=t=>"url"in t&&t.url&&(t.url.includes(".gif")||B(t.url))||"contentType"in t&&t.contentType==="image/gif"||"imageData"in t&&B(t.imageData),P=t=>t!=null&&t.startsWith("data:image/png"),vt=t=>"url"in t&&t.url&&(t.url.includes(".png")||P(t.url))||"contentType"in t&&t.contentType==="image/png"||"imageData"in t&&P(t.imageData),xt=t=>t.type&&t.type.toLowerCase().includes("3d");function Yt(t){switch(t.type){case"line":{const n=t;return n.cim.type==="CIMSolidStroke"&&!n.dashTemplate}case"fill":return t.cim.type==="CIMSolidFill";case"esriSFS":return t.style==="esriSFSSolid"||t.style==="esriSFSNull";case"esriSLS":return t.style==="esriSLSSolid"||t.style==="esriSLSNull";default:return!1}}const zt=t=>t.includes("data:image/svg+xml");function yt(t){switch("cim"in t?t.cim.type:t.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return ot(t);default:return!0}}function Zt(t){const n="maxVVSize"in t&&t.maxVVSize,e="width"in t&&t.width||"size"in t&&t.size||0;return n||e}function kt(t){const n=[];for(let e=0;e<t.length;e++)n.push(t.charCodeAt(e));return n}const _t=t=>t?(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4)):!1,ot=t=>{var n,e;return t.type==="fill"&&((e=(n=t==null?void 0:t.cim)==null?void 0:n.markerPlacement)==null?void 0:e.type)==="CIMMarkerPlacementInsidePolygon"},ft=new Float32Array(1);new Uint32Array(ft.buffer);function $t(t){return[t&255,(t&65280)>>>8,(t&16711680)>>>16,(t&4278190080)>>>24]}function bt(t,n){return 65535&t|n<<16}function F(t,n,e,a){return t&255|(n&255)<<8|(e&255)<<16|a<<24}function Kt(t,n=0,e=!1){const a=t[n+3];return t[n]*=a,t[n+1]*=a,t[n+2]*=a,e||(t[n+3]*=255),t}function Jt(t){if(!t)return 0;const{r:n,g:e,b:a,a:i}=t,r=n*i,s=e*i,I=a*i,u=i*255;return F(r,s,I,u)}function qt(t){if(!t)return 0;const[n,e,a,i]=t,r=n*(i/255),s=e*(i/255),I=a*(i/255);return F(r,s,I,i)}function Qt(t,n,e=0){if(n==null){t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=0;return}const{r:a,g:i,b:r,a:s}=n;t[e]=a*s/255,t[e+1]=i*s/255,t[e+2]=r*s/255,t[e+3]=s}export{F as A,qt as B,mt as C,Jt as D,Ot as E,Dt as F,Pt as G,$t as H,Bt as I,Kt as J,m as K,Lt as L,p as M,Rt as N,M as W,c as a,T as b,Ft as c,kt as d,Yt as e,Ht as f,Xt as g,ot as h,xt as i,wt as j,Zt as k,gt as l,vt as m,zt as n,Nt as o,rt as p,Ut as q,pt as r,yt as s,Ct as t,dt as u,ht as v,U as w,Mt as x,Qt as y,bt as z};
