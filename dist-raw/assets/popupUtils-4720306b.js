import{bb as d,aw as F,ac as g,ab as o,aJ as f,fh as p,fi as w}from"./index-30d9bb6f.js";const y=["oid","global-id"],$=["oid","global-id","guid"];function P({displayField:e,editFieldsInfo:t,fields:a,objectIdField:n,title:r},i){if(!a)return null;const s=I({editFieldsInfo:t,fields:a,objectIdField:n},i);if(!s.length)return null;const u=h({titleBase:r,fields:a,displayField:e}),m=T();return new d({title:u,content:m,fieldInfos:s})}const L=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],b=(e,{editFieldsInfo:t,objectIdField:a,visibleFieldNames:n})=>n?n.has(e.name):c(e.name,t)||a&&e.name===a||y.includes(e.type)?!1:!L.some(r=>r.test(e.name));function _(e,t){const a=e;return t&&(e=e.filter(n=>!t.includes(n.type))),e===a&&(e=e.slice()),e.sort(C),e}function C(e,t){return e.type==="oid"?-1:t.type==="oid"?1:l(e)?-1:l(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function c(e,t){if(!e||!t)return!1;const{creationDateField:a,creatorField:n,editDateField:r,editorField:i}=t;return[a&&a.toLowerCase(),n&&n.toLowerCase(),r&&r.toLowerCase(),i&&i.toLowerCase()].includes(e.toLowerCase())}function E(e,t){return e.editable&&!$.includes(e.type)&&!c(e.name,t)}function I({editFieldsInfo:e,fields:t,objectIdField:a},n){return _(t??[],(n==null?void 0:n.ignoreFieldTypes)||D).map(r=>new F({fieldName:r.name,isEditable:E(r,e),label:r.alias,format:N(r),visible:b(r,{editFieldsInfo:e,objectIdField:a,visibleFieldNames:n==null?void 0:n.visibleFieldNames})}))}function N(e){switch(e.type){case"small-integer":case"integer":case"single":return new o({digitSeparator:!0,places:0});case"double":return new o({digitSeparator:!0,places:2});case"date":return new o({dateFormat:"long-month-day-year"});default:return e.type==="string"&&g(e.name)?new o({digitSeparator:!0,places:0}):null}}function T(){return[new f,new p]}function h(e){const t=w(e),{titleBase:a}=e;return t?`${a}: {${t.trim()}}`:a??""}function l(e){return(e.name&&e.name.toLowerCase())==="name"||(e.alias&&e.alias.toLowerCase())==="name"}const D=["geometry","blob","raster","guid","xml"];export{P as c};
